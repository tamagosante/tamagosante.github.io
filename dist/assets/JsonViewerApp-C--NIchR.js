import{r as f,j as r}from"./react-vendor-BOZDwKwV.js";const N=(e,t,s)=>{if(!t||t.length===0)return s;const n=t[0],l=t.slice(1);typeof n=="number"&&Array.isArray(e)&&n>=e.length;const a=Array.isArray(e)?[...e]:{...e};return l.length===0?a[n]=s:a[n]=N(e[n],l,s),a},P=(e,t,s)=>{if(!t||t.length===0)return Array.isArray(e)?[...e,s]:(console.error("Cannot add value: target is not an array or path is invalid."),e);const n=t[0],l=t.slice(1),a=Array.isArray(e)?[...e]:{...e};return l.length===0?Array.isArray(a[n])?a[n]=[...a[n],s]:console.error("Cannot add value: target at path is not an array.",t,n):a[n]=P(e[n],l,s),a},S=(e,t,s,n)=>{if(!t||t.length===0)return typeof e=="object"&&e!==null&&!Array.isArray(e)?{...e,[s]:n}:(console.error("Cannot add property: target is not an object or path is invalid."),e);const l=t[0]??"",a=t.slice(1),i=Array.isArray(e)?[...e]:{...e};return a.length===0?typeof i[l]=="object"&&i[l]!==null&&!Array.isArray(i[l])?i[l]={...i[l],[s]:n}:console.error("Cannot add property: target at path is not an object.",t,l):i[l]=S(e[l],a,s,n),i},w=(e,t)=>{let s=e;for(const n of t){if(s===null||typeof s!="object")return;s=s[n]}return s},L=(e,t,s,n)=>{if(s===n)return e;if(!t||t.length===0){if(typeof e=="object"&&e!==null&&!Array.isArray(e)&&Object.prototype.hasOwnProperty.call(e,s)){if(Object.prototype.hasOwnProperty.call(e,n))return console.warn(`New key "${n}" already exists. Rename aborted.`),e;const{[s]:o,...h}=e;return{...h,[n]:o}}return console.error("Cannot rename property: target is not the root object or old key not found."),e}const l=t[0],a=t.slice(1),i=Array.isArray(e)?[...e]:{...e};if(a.length===0){const o=i[l];if(typeof o=="object"&&o!==null&&!Array.isArray(o)&&Object.prototype.hasOwnProperty.call(o,s)){if(Object.prototype.hasOwnProperty.call(o,n))return console.warn(`New key "${n}" already exists in object. Rename aborted.`),e;const{[s]:h,...m}=o;i[l]={...m,[n]:h}}else console.error("Cannot rename property: target at path is not an object or old key not found.",t,l,s)}else i[l]=L(e[l],a,s,n);return i},O=({data:e,path:t=[],onValueChange:s,onAddItem:n,onAddProperty:l,onRenameProperty:a,currentlyEditingKeyPath:i,nodeKey:o})=>{const h=typeof e,[m,p]=f.useState(!1),[d,c]=f.useState(typeof o=="string"?o:""),[x,y]=f.useState(!1);f.useEffect(()=>{const u=!!(i&&t.length===i.length&&t.every((g,j)=>g===i[j]));y(u),u&&typeof o=="string"&&c(o)},[i,t,o]);const b=()=>{n(t,null)},k=()=>{l(t)},A=u=>{let g;switch(u.target.type){case"checkbox":g=u.target.checked;break;case"number":g=parseFloat(u.target.value);break;default:g=u.target.value}s(t,g)},R=u=>{const g=u.target.value;let j;switch(g){case"string":j="";break;case"number":j=0;break;case"boolean":j=!1;break;case"array":j=[];break;case"object":j={};break;default:p(!1);return}s(t,j),p(!1)},E=u=>{c(u.target.value)},v=()=>{typeof o=="string"&&d&&d!==o||y(!1)},F=u=>{u.key==="Enter"?v():u.key==="Escape"&&(y(!1),c(typeof o=="string"?o:""))},V=()=>{if(e===null)return m?r.jsxs("select",{onChange:R,onBlur:()=>p(!1),style:{marginLeft:"5px"},defaultValue:"",children:[r.jsx("option",{value:"",disabled:!0,children:"Select Type"}),r.jsx("option",{value:"string",children:"String"}),r.jsx("option",{value:"number",children:"Number"}),r.jsx("option",{value:"boolean",children:"Boolean"}),r.jsx("option",{value:"array",children:"Array"}),r.jsx("option",{value:"object",children:"Object"})]}):r.jsx("span",{style:{color:"grey",cursor:"pointer",textDecoration:"underline"},onClick:()=>p(!0),children:"null"});switch(h){case"string":return r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"text",value:e,onChange:A,style:{marginLeft:"5px",border:"1px solid #ccc"}}),","]});case"number":return r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"number",value:e,onChange:A,style:{marginLeft:"5px",border:"1px solid #ccc"}}),","]});case"boolean":return r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"checkbox",checked:e,onChange:A,style:{marginLeft:"5px"}}),","]});case"object":return Array.isArray(e)?r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"["}),e.length===0&&r.jsx("button",{style:{marginLeft:"5px",cursor:"pointer",border:"1px solid green",color:"green",background:"lightgreen",borderRadius:"3px",padding:"0 3px"},onClick:b,children:"+"}),e.length===0&&r.jsx("span",{children:"],"}),r.jsx("div",{style:{marginLeft:"20px"},children:e.map((u,g)=>r.jsx("div",{style:{display:"flex",alignItems:"baseline"},children:r.jsx(O,{data:u,path:[...t,g],onValueChange:s,onAddItem:n,onAddProperty:l,onRenameProperty:a,currentlyEditingKeyPath:i})},g))}),e.length>0&&r.jsxs("span",{children:["]",r.jsx("button",{style:{marginLeft:"5px",cursor:"pointer",border:"1px solid green",color:"green",background:"lightgreen",borderRadius:"3px",padding:"0 3px"},onClick:b,children:"+"}),r.jsx("span",{children:","})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"{"}),Object.keys(e).length===0&&r.jsx("button",{style:{marginLeft:"5px",cursor:"pointer",border:"1px solid blue",color:"blue",background:"lightblue",borderRadius:"3px",padding:"0 3px"},onClick:k,children:"+"}),Object.keys(e).length===0&&r.jsx("span",{children:"},"}),r.jsx("div",{style:{marginLeft:"20px"},children:Object.entries(e).map(([u,g])=>r.jsx("div",{className:"flex",children:r.jsx(O,{nodeKey:u,data:g,path:[...t,u],onValueChange:s,onAddItem:n,onAddProperty:l,onRenameProperty:a,currentlyEditingKeyPath:i})},u))}),Object.keys(e).length>0&&r.jsxs("span",{children:["}",r.jsx("button",{style:{marginLeft:"5px",cursor:"pointer",border:"1px solid blue",color:"blue",background:"lightblue",borderRadius:"3px",padding:"0 3px"},onClick:k,children:"+"}),","]})]});default:return r.jsxs("span",{style:{color:"red"},children:["Unsupported type: ",h]})}},C={color:"purple",marginRight:"5px"},J=()=>o!==void 0&&typeof o=="string"?x?r.jsx("input",{type:"text",value:d,onChange:E,onBlur:v,onKeyDown:F,style:{...C,border:"1px solid blue",outline:"none"}}):r.jsxs("span",{style:C,children:['"',o,'":']}):null;return r.jsxs("div",{id:"row",style:{display:"flex",fontSize:16,marginBottom:0},children:[J(),r.jsx("div",{style:{marginLeft:o!==void 0&&typeof o=="string"?"5px":"0"},children:V()})]})},I=e=>{const{data:t}=e;console.log(">>>> _ >>>> ~ JsonViewerApp.tsx:44 ~ data:",t);const[s,n]=f.useState(t??[]);console.log(">>>> _ >>>> ~ JsonViewerApp.tsx:47 ~ jsonData:",s);const[l,a]=f.useState(null);f.useEffect(()=>{t&&n(t)},[t]);const i=f.useCallback((p,d)=>{n(c=>N(c,p,d))},[]),o=f.useCallback((p,d)=>{n(c=>P(c,p,d))},[]),h=f.useCallback(p=>{let d="newKey";n(c=>{let x=0;const y=w(c,p);if(y&&typeof y=="object"&&!Array.isArray(y))for(;Object.prototype.hasOwnProperty.call(y,d);)x++,d=`newKey_${x}`;else if(p.length===0&&typeof c=="object"&&!Array.isArray(c))for(;Object.prototype.hasOwnProperty.call(c,d);)x++,d=`newKey_${x}`;else return console.error("Target for adding property is not an object at path:",p),c;const b=S(c,p,d,null);return a([...p,d]),b})},[]),m=f.useCallback((p,d,c)=>{if(!c||d===c)return a(null),!1;let x=!1;return n(y=>{const b=w(y,p);if(b&&typeof b=="object"&&Object.prototype.hasOwnProperty.call(b,c))return console.warn(`New key "${c}" already exists. Rename aborted.`),x=!1,y;const k=L(y,p,d,c);return x=k!==y,k}),a(null),x},[]);return r.jsxs("div",{className:"flex w-[75%] justify-between",style:{fontFamily:"monospace",padding:"10px"},children:[r.jsxs("section",{children:[r.jsx("h4",{children:"Current State Preview:"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all",padding:"10px",border:"1px solid #ccc"},children:JSON.stringify(s,null,2)})]}),r.jsx("hr",{style:{margin:"20px 0"}}),r.jsxs("section",{children:[r.jsx("h4",{children:"Editable JSON Viewer"}),r.jsx(O,{data:s,onValueChange:i,onAddItem:o,onAddProperty:h,onRenameProperty:m,currentlyEditingKeyPath:l})]})]})};export{I as JsonViewerApp};
