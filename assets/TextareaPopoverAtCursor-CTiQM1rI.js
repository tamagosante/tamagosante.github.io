import{r as h,j as m}from"./react-vendor-BOZDwKwV.js";function P(e){const n=e.getBoundingClientRect(),d=window.getComputedStyle(e),c=parseInt(d.lineHeight||d.fontSize);if(e.tagName==="TEXTAREA"){const u=e,x=u.selectionEnd,r=document.createElement("div");["boxSizing","width","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontFamily","fontSize","fontWeight","lineHeight","letterSpacing"].forEach(v=>{r.style[v]=d[v]}),r.style.position="absolute",r.style.top=n.top+"px",r.style.left=n.left+"px",r.style.visibility="hidden",r.style.whiteSpace="pre-wrap",r.style.wordWrap="break-word",r.style.overflow="hidden";const b=u.value.substring(0,x);r.textContent=b;const g=document.createElement("span");g.textContent="|",r.appendChild(g),document.body.appendChild(r);const f=g.getBoundingClientRect();r.getBoundingClientRect(),document.body.removeChild(r);const E=f.top-n.top,C=f.left-n.left,L=E+c+4-u.scrollTop,w=C-u.scrollLeft;return{top:L,left:w}}const l=e,i=l.selectionEnd||0,a=l.value.substring(0,i),o=document.createElement("span"),t=window.getComputedStyle(l);o.style.font=t.font,o.style.visibility="hidden",o.style.position="absolute",o.style.whiteSpace="pre",o.textContent=a,document.body.appendChild(o);const s=o.getBoundingClientRect().width;document.body.removeChild(o);const p=parseInt(t.paddingLeft),y=Math.min(p+s,n.width-50);return{top:c+4,left:y}}function $({inputRef:e,show:n,children:d,updateOn:c,className:l="",offset:i={top:0,left:0}}){const[a,o]=h.useState(null);return h.useEffect(()=>{if(!n||!e.current){o(null);return}const t=()=>{if(!e.current)return;const p=P(e.current);p&&o({top:p.top+(i.top??0),left:p.left+(i.left??0)})};t();const s=e.current;return s.addEventListener("scroll",t),s.addEventListener("select",t),s.addEventListener("mouseup",t),s.addEventListener("keyup",t),document.addEventListener("selectionchange",t),()=>{s.removeEventListener("scroll",t),s.removeEventListener("select",t),s.removeEventListener("mouseup",t),s.removeEventListener("keyup",t),document.removeEventListener("selectionchange",t)}},[n,e,c,i.top,i.left]),!n||!a?null:m.jsx("div",{className:`popover-at-cursor absolute z-50 ${l}`,style:{top:`${a.top}px`,left:`${a.left}px`},"data-test":"textarea-popover-at-cursor",children:d})}function j({items:e,selectedIndex:n=-1,gridColumns:d=7,onItemClick:c,itemClassName:l="",selectedItemClassName:i="bg-primary text-primary-foreground",unselectedItemClassName:a="bg-muted"}){return m.jsx("div",{className:"popover-grid grid gap-1",style:{gridTemplateColumns:`repeat(${d}, minmax(0, 1fr))`},"data-test":"popover-grid",children:e.map((o,t)=>m.jsx("button",{onClick:()=>c(o,t),className:`grid-item w-8 h-8 flex items-center justify-center rounded hover:bg-accent hover:text-accent-foreground transition-colors text-lg font-medium ${t===n?i:a} ${l}`,"data-test":`popover-grid-item-${t}`,children:o},t))})}function W({children:e,className:n=""}){return m.jsx("div",{className:`keyboard-hints text-xs text-muted-foreground mt-2 text-center ${n}`,"data-test":"popover-keyboard-hints",children:e})}export{j as P,$ as T,W as a};
