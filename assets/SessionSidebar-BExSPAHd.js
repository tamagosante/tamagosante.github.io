import{r as F,j as e,d as re}from"./react-vendor-Byz07MLO.js";import{aY as oe,b1 as Q,y as _,V as G,I as k,a as D,aA as de,aB as ce,aC as me,ab as he,m as xe,n as ue,o as Y,p as Z,L as x,aj as W,l as ee,S as H,h as K,i as U,j as X,k as P,z as pe,g as fe,C as ge,b as ve,c as je,b2 as Ne,b3 as be,b4 as q,e as ye,aw as we,b5 as Ce}from"./index-eHP58yiE.js";import{Q as Se,x as Me,X as ke,bb as Fe,ad as Te,G as De,bc as Ae,o as ze,r as Le,q as Be}from"./icons-vtiX7BHn.js";function Ee({sessions:c,onSessionSelect:v,selectedSessionId:j,formatDate:w,formatCwd:z,pathPrefix:C="",segmentsToStrip:o=0}){const{treeData:b,expandedIds:S}=F.useMemo(()=>{const r={sessions:[],children:new Map},y=C.trim()?C.trim().replace(/\/$/,""):"";c.forEach(u=>{if(!u.cwd)return;let N=u.cwd;y&&u.cwd.startsWith(y)&&(N=u.cwd.substring(y.length));let g=N.split("/").filter(Boolean);if(o>0&&g.length>o&&(g=g.slice(o)),g.length===0){r.sessions.push(u);return}let n=r;g.forEach((p,l)=>{n.children.has(p)||n.children.set(p,{path:g.slice(0,l+1).join("/"),sessions:[],children:new Map}),n=n.children.get(p)}),n.sessions.push(u)});const h=(u,N="")=>{const g=[];return Array.from(u.children.entries()).sort(([n],[p])=>n.localeCompare(p)).forEach(([n,p])=>{const l=N?`${N}/${n}`:n,E=h(p,l),O={id:`dir-${l}`,label:n,icon:e.jsx(Se,{className:"h-4 w-4 text-blue-500"}),children:E};g.push(O)}),u.sessions.sort((n,p)=>new Date(p.lastModified).getTime()-new Date(n.lastModified).getTime()).forEach(n=>{g.push({id:n.id,label:n.name,data:n})}),g},M=h(r),B=new Set;if(j){const u=c.find(N=>N.id===j);if(u!=null&&u.cwd){let N=u.cwd;const g=C.trim()?C.trim().replace(/\/$/,""):"";g&&u.cwd.startsWith(g)&&(N=u.cwd.substring(g.length));let n=N.split("/").filter(Boolean);o>0&&n.length>o&&(n=n.slice(o));for(let p=0;p<n.length;p++){const l=n.slice(0,p+1).join("/");B.add(`dir-${l}`)}}}return{treeData:M,expandedIds:B}},[c,C,o,j]),m=(r,y,h)=>{const M=r.data;return M?e.jsx(Q,{session:M,isSelected:y,onClick:h,formatDate:w,formatCwd:z}):null},T=r=>{r.id.startsWith("dir-")||v(r.id)};return e.jsx("div",{className:"directory-tree-container space-y-2","data-test":"directory-tree-container",children:e.jsx(oe,{data:b,onItemClick:T,className:"directory-tree",defaultExpandedIds:S,selectedId:j,renderLeaf:m,"data-test":"directory-tree"})})}function Oe({sessions:c,onSessionSelect:v,selectedSessionId:j,focusedIndex:w=-1,formatDate:z,formatCwd:C,segmentsToStrip:o=3,onNameUpdated:b,drafts:S={}}){return e.jsx("div",{"data-test":"session-list-view",className:"session-items space-y-2",children:c.map((m,T)=>e.jsx(Q,{session:m,isSelected:j===m.id,isFocused:w===T,onClick:()=>v(m.id),formatDate:z,formatCwd:C,segmentsToStrip:o,onNameUpdated:b,hasDraft:!!S[m.id]},m.id))})}const Ie=[{value:"id",label:"Session ID"},{value:"name",label:"Session Name"},{value:"cwd",label:"Working Directory"},{value:"firstMessage",label:"First Message"}],J=[{value:"user",label:"User Messages",description:"Pure user messages (no tool content)"},{value:"assistant",label:"Assistant Responses",description:"Pure assistant responses (no thinking/tool blocks)"},{value:"thinking",label:"Thinking Blocks",description:"Messages containing thinking blocks"},{value:"tools",label:"Tool Calls/Results",description:"Messages containing tool_use or tool_result blocks"}],Pe=[{value:"lastModified",label:"Last Modified"},{value:"name",label:"Name"},{value:"messageCount",label:"Message Count"}],Re={fields:["name"],sortBy:"lastModified",sortOrder:"desc",pageSize:11},$e={messageType:[],sortOrder:"desc",pageSize:50},se=F.forwardRef(({searchQuery:c,onSearchChange:v,onAdvancedSearch:j,onMessageSearch:w,className:z},C)=>{var I,$,V;const o=(V=($=(I=_.getState().app)==null?void 0:I.claude)==null?void 0:$.ui)==null?void 0:V.advancedSearch,[b,S]=F.useState(!1),[m,T]=F.useState((o==null?void 0:o.activeTab)??"sessions"),[r,y]=F.useState({...Re,...o==null?void 0:o.sessionFilters}),[h,M]=F.useState({...$e,...o==null?void 0:o.messageFilters});F.useEffect(()=>{var t,a,i;const s=_.getState();_.updateState({app:{...s.app,claude:{...(t=s.app)==null?void 0:t.claude,ui:{...(i=(a=s.app)==null?void 0:a.claude)==null?void 0:i.ui,advancedSearch:{activeTab:m,sessionFilters:r,messageFilters:h}}}}})},[m,r,h]);const B=F.useMemo(()=>{const{fields:s,messageTypes:t,sortBy:a,sortOrder:i,pageSize:d,...f}=r,L=s&&(s.length!==1||s[0]!=="name"),A=t&&t.length>0,ae=Object.values(f).some(le=>le!==void 0),te=L||A||ae||(a!=="lastModified"||i!=="desc"),ie=h.messageType&&h.messageType.length>0,ne=h.after||h.before;return te||(ie||ne)},[r,h]),u=(s,t)=>{y(a=>{const i=a.fields||[],d=t?[...i,s]:i.filter(f=>f!==s);return{...a,fields:d.length>0?d:void 0}})},N=(s,t)=>{M(a=>{const i=a.messageType||[],d=t?[...i,s]:i.filter(f=>f!==s);return{...a,messageType:d.length>0?d:void 0}})},g=(s,t)=>{y(a=>{const i=a.messageTypes||[],d=t?[...i,s]:i.filter(f=>f!==s);return{...a,messageTypes:d.length>0?d:void 0}})},n=(s,t)=>{y(a=>({...a,[s]:t}))},p=(s,t)=>{M(a=>({...a,[s]:t}))},l=()=>{m==="sessions"&&j?j(c,r):m==="messages"&&w&&w(c,h),S(!1)},E=()=>{m==="sessions"?y({fields:["name"],sortBy:"lastModified",sortOrder:"desc",pageSize:11}):M({messageType:[],sortOrder:"desc",pageSize:50})},O=s=>{s.key==="Enter"&&(m==="sessions"&&j?j(c,r):m==="messages"&&w&&w(c,h))},R=()=>{v("")};return e.jsx("div",{ref:C,className:G("sessions-search-container relative",z),"data-test":"sessions-search-container",children:e.jsxs("div",{className:"search-input-wrapper relative flex items-center gap-1","data-test":"sessions-search-input-wrapper",children:[e.jsx(Me,{className:"search-icon absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none z-10","data-test":"sessions-search-icon"}),e.jsx(k,{type:"text",placeholder:m==="sessions"?"Search sessions...":"Search messages...",value:c,onChange:s=>v(s.target.value),onKeyDown:O,className:G("search-input pl-9",c?"pr-16":"pr-10"),"data-test":"sessions-search-input"}),c&&e.jsx(D,{variant:"ghost",size:"icon",onClick:R,className:"clear-button absolute right-9 top-1/2 -translate-y-1/2 h-7 w-7 shrink-0 hover:bg-muted","aria-label":"Clear search","data-test":"sessions-search-clear-button",children:e.jsx(ke,{className:"h-4 w-4"})}),B&&e.jsx("div",{className:G("filter-indicator absolute top-1/2 -translate-y-1/2 h-2 w-2 rounded-full bg-primary pointer-events-none z-10",c?"right-17":"right-11"),"data-test":"sessions-search-filter-indicator"}),e.jsxs(de,{open:b,onOpenChange:S,children:[e.jsx(ce,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"icon",className:"expand-button absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 shrink-0","aria-label":b?"Collapse advanced search":"Expand advanced search","data-test":"sessions-search-expand-button",children:e.jsx(Fe,{className:"h-4 w-4"})})}),e.jsxs(me,{align:"start",side:"bottom",avoidCollisions:!0,className:"advanced-search-panel w-96 max-h-[70vh] overflow-y-auto",style:{zIndex:he.draggablePopoverDropdown},"data-test":"sessions-advanced-search-panel",children:[e.jsx("div",{className:"panel-header space-y-2 pb-3 border-b","data-test":"sessions-panel-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Advanced Search"}),e.jsx(D,{variant:"ghost",size:"sm",onClick:E,className:"h-7 text-xs","data-test":"sessions-clear-filters-button",children:"Clear All"})]})}),e.jsxs(xe,{value:m,onValueChange:s=>T(s),className:"mt-3",children:[e.jsxs(ue,{className:"grid w-full grid-cols-2","data-test":"sessions-search-tabs",children:[e.jsx(Y,{value:"sessions","data-test":"sessions-tab-sessions",children:"Sessions"}),e.jsx(Y,{value:"messages","data-test":"sessions-tab-messages",children:"Messages"})]}),e.jsxs(Z,{value:"sessions",className:"space-y-4 mt-4","data-test":"sessions-tab-content-sessions",children:[e.jsxs("div",{className:"field-selection space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Search Fields"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Select fields to search (OR logic across fields)"}),e.jsx("div",{className:"fields-grid space-y-2",children:Ie.map(s=>{var t;return e.jsxs("div",{className:"field-item flex items-center space-x-2",children:[e.jsx(W,{id:`field-${s.value}`,checked:(t=r.fields)==null?void 0:t.includes(s.value),onCheckedChange:a=>u(s.value,a===!0)}),e.jsx("label",{htmlFor:`field-${s.value}`,className:"text-sm cursor-pointer",children:s.label})]},s.value)})})]}),e.jsxs("div",{className:"message-types-selection space-y-2","data-test":"sessions-tab-message-types-section",children:[e.jsx(x,{className:"text-sm font-medium",children:"Message Types"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Filter by message type when searching in message content"}),e.jsx("div",{className:"message-types-grid space-y-2",children:J.map(s=>{var t;return e.jsxs("div",{className:"message-type-item flex items-center space-x-2",children:[e.jsx(W,{id:`session-msgtype-${s.value}`,checked:(t=r.messageTypes)==null?void 0:t.includes(s.value),onCheckedChange:a=>g(s.value,a===!0),"data-test":"sessions-tab-message-type-checkbox"}),e.jsxs("label",{htmlFor:`session-msgtype-${s.value}`,className:"text-sm cursor-pointer flex-1",children:[e.jsx("span",{children:s.label}),e.jsx("span",{className:"text-xs text-muted-foreground block",children:s.description})]})]},s.value)})})]}),e.jsxs("div",{className:"active-filter space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Status"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Active Sessions Only"}),e.jsx(ee,{checked:r.isActive??!1,onCheckedChange:s=>n("isActive",s?!0:void 0)})]})]}),e.jsxs("div",{className:"message-count-filter space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Message Count"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{type:"number",placeholder:"Min",min:"0",value:r.minMessages??"",onChange:s=>n("minMessages",s.target.value?parseInt(s.target.value):void 0),className:"h-8"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"to"}),e.jsx(k,{type:"number",placeholder:"Max",min:"0",value:r.maxMessages??"",onChange:s=>n("maxMessages",s.target.value?parseInt(s.target.value):void 0),className:"h-8"})]})]}),e.jsxs("div",{className:"date-range-filter space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Modified Date Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"date-input-wrapper",children:[e.jsx(x,{htmlFor:"session-date-after",className:"text-xs text-muted-foreground",children:"After"}),e.jsx(k,{id:"session-date-after",type:"datetime-local",value:r.modifiedAfter??"",onChange:s=>n("modifiedAfter",s.target.value||void 0),className:"h-8"})]}),e.jsxs("div",{className:"date-input-wrapper",children:[e.jsx(x,{htmlFor:"session-date-before",className:"text-xs text-muted-foreground",children:"Before"}),e.jsx(k,{id:"session-date-before",type:"datetime-local",value:r.modifiedBefore??"",onChange:s=>n("modifiedBefore",s.target.value||void 0),className:"h-8"})]})]})]}),e.jsxs("div",{className:"sorting-section space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Sort By"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{value:r.sortBy,onValueChange:s=>n("sortBy",s),children:[e.jsx(K,{className:"h-8 flex-1",children:e.jsx(U,{})}),e.jsx(X,{children:Pe.map(s=>e.jsx(P,{value:s.value,children:s.label},s.value))})]}),e.jsxs(H,{value:r.sortOrder,onValueChange:s=>n("sortOrder",s),children:[e.jsx(K,{className:"h-8 w-32",children:e.jsx(U,{})}),e.jsxs(X,{children:[e.jsx(P,{value:"desc",children:"Descending"}),e.jsx(P,{value:"asc",children:"Ascending"})]})]})]})]}),e.jsxs("div",{className:"pagination-section space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Results Per Page"}),e.jsx(k,{type:"number",min:"1",max:"100",value:r.pageSize??11,onChange:s=>n("pageSize",s.target.value?parseInt(s.target.value):11),className:"h-8"})]})]}),e.jsxs(Z,{value:"messages",className:"space-y-4 mt-4","data-test":"sessions-tab-content-messages",children:[e.jsxs("div",{className:"message-types-selection space-y-2","data-test":"sessions-message-types-section",children:[e.jsx(x,{className:"text-sm font-medium",children:"Message Types"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Filter by message type (searches across all sessions)"}),e.jsx("div",{className:"message-types-grid space-y-2",children:J.map(s=>{var t;return e.jsxs("div",{className:"message-type-item flex items-center space-x-2",children:[e.jsx(W,{id:`msgtype-${s.value}`,checked:(t=h.messageType)==null?void 0:t.includes(s.value),onCheckedChange:a=>N(s.value,a===!0),"data-test":"sessions-message-type-checkbox"}),e.jsxs("label",{htmlFor:`msgtype-${s.value}`,className:"text-sm cursor-pointer flex-1",children:[e.jsx("span",{children:s.label}),e.jsx("span",{className:"text-xs text-muted-foreground block",children:s.description})]})]},s.value)})})]}),e.jsxs("div",{className:"date-range-filter space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Message Date Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"date-input-wrapper",children:[e.jsx(x,{htmlFor:"msg-date-after",className:"text-xs text-muted-foreground",children:"After"}),e.jsx(k,{id:"msg-date-after",type:"datetime-local",value:h.after??"",onChange:s=>p("after",s.target.value||void 0),className:"h-8"})]}),e.jsxs("div",{className:"date-input-wrapper",children:[e.jsx(x,{htmlFor:"msg-date-before",className:"text-xs text-muted-foreground",children:"Before"}),e.jsx(k,{id:"msg-date-before",type:"datetime-local",value:h.before??"",onChange:s=>p("before",s.target.value||void 0),className:"h-8"})]})]})]}),e.jsxs("div",{className:"sorting-section space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Sort Order"}),e.jsxs(H,{value:h.sortOrder,onValueChange:s=>p("sortOrder",s),children:[e.jsx(K,{className:"h-8",children:e.jsx(U,{})}),e.jsxs(X,{children:[e.jsx(P,{value:"desc",children:"Newest First"}),e.jsx(P,{value:"asc",children:"Oldest First"})]})]})]}),e.jsxs("div",{className:"pagination-section space-y-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Results Per Page"}),e.jsx(k,{type:"number",min:"1",max:"100",value:h.pageSize??50,onChange:s=>p("pageSize",s.target.value?parseInt(s.target.value):50),className:"h-8"})]})]})]}),e.jsxs("div",{className:"panel-footer flex items-center gap-2 pt-3 mt-4 border-t","data-test":"sessions-panel-footer",children:[e.jsx(D,{onClick:l,className:"flex-1",size:"sm","data-test":"sessions-apply-search-button",children:m==="sessions"?"Search Sessions":"Search Messages"}),e.jsx(D,{onClick:()=>S(!1),variant:"outline",size:"sm","data-test":"sessions-cancel-button",children:"Cancel"})]})]})]})]})})});se.displayName="SessionsSearch";function Ke({sessions:c,loading:v,error:j,onSessionSelect:w,selectedSessionId:z,onRefresh:C,pagination:o,currentPage:b=1,onPageChange:S,onLoadMore:m,onSearch:T,onMessageSearch:r,onNameUpdated:y,excludeAgents:h=!0,onToggleExcludeAgents:M,focusedIndex:B=-1,sidebarRef:u,onSidebarClick:N}){const g=re(),[n,p]=F.useState(""),[l,E]=F.useState(null),O=pe(t=>{var a,i,d;return((d=(i=(a=t.app)==null?void 0:a.claude)==null?void 0:i.ui)==null?void 0:d.messageDrafts)??{}}),R=t=>{const a=new Date(t);return a.toLocaleDateString()+" "+a.toLocaleTimeString()},I=t=>t?t.replace(/^\/home\/[^/]+\//,"~/"):"",$=(t,a)=>{console.log("Advanced search triggered:",{query:t,filters:a}),E(a),T&&T(t,a)},V=(t,a)=>{console.log("Message search triggered:",{query:t,filters:a}),r&&r(t,a)},s=F.useMemo(()=>{if(T||!n.trim())return c;const t=n.toLowerCase();let a=c;if(l!=null&&l.fields&&l.fields.length>0?a=c.filter(i=>l.fields.some(d=>{var f,L;switch(d){case"id":return i.id.toLowerCase().includes(t);case"name":return i.name.toLowerCase().includes(t);case"cwd":return(f=i.cwd)==null?void 0:f.toLowerCase().includes(t);case"firstMessage":return(L=i.firstMessage)==null?void 0:L.toLowerCase().includes(t);default:return!1}})):a=c.filter(i=>i.name.toLowerCase().includes(t)||i.id.toLowerCase().includes(t)),l){if(l.isActive!==void 0&&(a=a.filter(i=>i.isActive===l.isActive)),l.minMessages!==void 0&&(a=a.filter(i=>i.messageCount>=l.minMessages)),l.maxMessages!==void 0&&(a=a.filter(i=>i.messageCount<=l.maxMessages)),l.modifiedAfter!==void 0){const i=new Date(l.modifiedAfter);a=a.filter(d=>new Date(d.lastModified)>=i)}if(l.modifiedBefore!==void 0){const i=new Date(l.modifiedBefore);a=a.filter(d=>new Date(d.lastModified)<=i)}l.sortBy&&(a=[...a].sort((i,d)=>{let f=0;switch(l.sortBy){case"name":f=i.name.localeCompare(d.name);break;case"messageCount":f=i.messageCount-d.messageCount;break;case"lastModified":default:f=new Date(i.lastModified).getTime()-new Date(d.lastModified).getTime();break}return l.sortOrder==="asc"?f:-f}))}return a},[c,n,l,T]);return e.jsx(fe,{storageKey:"session-sidebar-config",initialConfig:{viewMode:"list",pathPrefix:"",segmentsToStrip:3},children:(t,a,i)=>{const{viewMode:d,pathPrefix:f,segmentsToStrip:L}=t;return e.jsxs(ge,{ref:u,tabIndex:0,onClick:N,className:"session-list-card h-full flex flex-col overflow-hidden rounded-none border-0 md:rounded-lg md:border outline-none focus:ring-2 focus:ring-primary/50","data-test":"session-sidebar-card",children:[e.jsxs(ve,{className:"session-list-header flex flex-col space-y-3 pb-4 pt-2 px-2 md:pt-6 md:px-6 flex-shrink-0","data-test":"session-sidebar-header",children:[e.jsxs("div",{className:"header-top flex flex-row items-center justify-between","data-test":"session-sidebar-header-top",children:[e.jsx(je,{className:"text-xl",children:"Claude Sessions"}),e.jsxs("div",{className:"header-actions flex items-center gap-1","data-test":"session-sidebar-header-actions",children:[e.jsx(D,{variant:"ghost",size:"icon",onClick:C,disabled:v,className:"refresh-button","data-test":"session-sidebar-refresh-button",children:e.jsx(Te,{className:`h-4 w-4 ${v?"animate-spin":""}`})}),e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>g("/claude/forks"),disabled:v,title:"View Forks","data-test":"session-sidebar-forks-button",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(Ne,{disabled:v}),e.jsx(i,{icon:e.jsx(Ae,{className:"h-4 w-4"}),title:"View Options",variant:"ghost",size:"icon",contentClassName:"w-64",children:e.jsxs("div",{className:"view-options-content space-y-4",children:[M&&e.jsxs("div",{className:"exclude-agents-filter flex items-center justify-between","data-test":"session-sidebar-exclude-agents",children:[e.jsx(x,{htmlFor:"exclude-agents",className:"text-sm font-medium cursor-pointer",children:"Hide agent sessions"}),e.jsx(ee,{id:"exclude-agents",checked:h,onCheckedChange:M,"data-test":"session-sidebar-exclude-agents-switch"})]}),e.jsxs("div",{className:"view-mode-selector space-y-3",children:[e.jsx(x,{className:"text-sm font-medium",children:"Display Mode"}),e.jsxs(be,{value:d,onValueChange:A=>a({...t,viewMode:A}),children:[e.jsxs("div",{className:"view-option flex items-center space-x-2",children:[e.jsx(q,{value:"list",id:"view-list"}),e.jsx(x,{htmlFor:"view-list",className:"cursor-pointer",children:"List"})]}),e.jsxs("div",{className:"view-option flex items-center space-x-2",children:[e.jsx(q,{value:"tree",id:"view-tree"}),e.jsx(x,{htmlFor:"view-tree",className:"cursor-pointer",children:"Tree"})]})]})]}),e.jsxs("div",{className:"segments-to-strip-filter space-y-2",children:[e.jsx(x,{htmlFor:"segments-to-strip",className:"text-sm font-medium",children:"Segments to Strip"}),e.jsx(k,{id:"segments-to-strip",type:"number",min:"0",max:"10",value:L,onChange:A=>a({...t,segmentsToStrip:Number(A.target.value)}),className:"segments-to-strip-input"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Strips first N path segments from session names"})]}),d==="tree"&&e.jsxs("div",{className:"path-prefix-filter space-y-2",children:[e.jsx(x,{htmlFor:"path-prefix",className:"text-sm font-medium",children:"Path Prefix (to strip)"}),e.jsx(k,{id:"path-prefix",type:"text",placeholder:"/home/user/path",value:f,onChange:A=>a({...t,pathPrefix:A.target.value}),className:"path-prefix-input"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Strips this prefix from tree paths"})]})]})})]})]}),e.jsx("div",{onClick:A=>A.stopPropagation(),children:e.jsx(se,{searchQuery:n,onSearchChange:p,onAdvancedSearch:$,onMessageSearch:V})})]}),e.jsxs(ye,{className:"session-list-content flex-1 min-h-0 p-0 overflow-hidden flex flex-col","data-test":"session-sidebar-content",children:[e.jsx("div",{className:"sessions-container flex-1 overflow-hidden","data-test":"session-sidebar-sessions-container",children:e.jsxs(we,{className:"session-scroll-area h-full w-full","data-test":"session-sidebar-scroll-area",children:[e.jsxs("div",{className:"space-y-2","data-test":"session-sidebar-sessions-list",children:[j&&e.jsx("div",{className:"error-message text-sm text-red-500 mb-2","data-test":"session-sidebar-error-message",children:j}),v&&s.length===0?e.jsx("div",{className:"loading-message text-sm text-muted-foreground","data-test":"session-sidebar-loading-message",children:"Loading sessions..."}):s.length===0?e.jsx("div",{className:"empty-state text-sm text-muted-foreground","data-test":"session-sidebar-empty-state",children:n?"No sessions match your search":"No sessions found"}):d==="tree"?e.jsx(Ee,{sessions:s,onSessionSelect:w,selectedSessionId:z,formatDate:R,formatCwd:I,pathPrefix:f,segmentsToStrip:L}):e.jsx(Oe,{sessions:s,onSessionSelect:w,selectedSessionId:z,focusedIndex:B,formatDate:R,formatCwd:I,segmentsToStrip:L,onNameUpdated:y,drafts:O})]}),e.jsx(Ce,{orientation:"horizontal"})]})}),o&&e.jsxs("div",{className:"pagination-controls flex flex-col gap-2 px-4 py-2 border-t flex-shrink-0","data-test":"session-sidebar-pagination-controls",children:[m&&b<o.totalPages&&e.jsxs(D,{variant:"outline",size:"sm",onClick:m,disabled:v,className:"load-more-button w-full","data-test":"session-sidebar-load-more-button",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Load More Sessions",e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",c.length," of ",o.totalCount,")"]})]}),S&&e.jsxs("div",{className:"pagination-nav flex items-center justify-between gap-2","data-test":"session-sidebar-pagination-nav",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>S(b-1),disabled:b===1||v,className:"pagination-prev","data-test":"session-sidebar-pagination-prev-button",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Prev"]}),e.jsxs("div",{className:"pagination-info text-xs text-muted-foreground","data-test":"session-sidebar-pagination-info",children:["Page ",o.page," of ",o.totalPages]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>S(b+1),disabled:b>=o.totalPages||v,className:"pagination-next","data-test":"session-sidebar-pagination-next-button",children:["Next",e.jsx(Be,{className:"h-4 w-4 ml-1"})]})]})]})]})]})}})}export{Ke as S};
