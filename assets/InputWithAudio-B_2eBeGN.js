import{r as e,j as a}from"./react-vendor-Byz07MLO.js";import{T as I,I as T,U as k,A as R}from"./index-BEUYSeX_.js";import{d as $,N as y}from"./icons-Detj0uxE.js";const A=e.forwardRef(({value:i,onChange:r,placeholder:d="Type your message...",disabled:u=!1,multiline:n=!1,className:c="",onKeyPress:p},l)=>{const[s,g]=e.useState(!1),[h,m]=e.useState(0),[f,b]=e.useState(0),[C,o]=e.useState(!1),S=e.useCallback(t=>{(t.transcriptionStatus==="pending"||t.transcriptionStatus==="processing")&&o(!0)},[]),x=e.useCallback(t=>{if(t.transcription){const v=i.trim()?" ":"";r(i+v+t.transcription),o(!1)}else t.transcriptionStatus==="failed"&&o(!1)},[i,r]),w=e.useCallback(t=>{g(t)},[]),N=e.useCallback(()=>{s?b(t=>t+1):m(t=>t+1)},[s]),j=n?I:T;return a.jsxs("div",{className:`input-with-audio-container relative ${c}`,"data-test":"input-with-audio-container",children:[a.jsx(j,{ref:l,value:i,onChange:t=>r(t.target.value),onKeyPress:p,placeholder:d,disabled:u,className:`input-with-audio ${n?"pr-12 pb-10":"pr-20"}`,"data-test":"input-with-audio-input"}),C&&a.jsx("div",{className:`transcription-spinner absolute ${n?"right-11 bottom-3":"right-11 top-1/2 -translate-y-1/2"}`,"data-test":"input-with-audio-transcribing-spinner",children:a.jsx($,{className:"w-4 h-4 animate-spin text-muted-foreground"})}),a.jsx("button",{onClick:N,className:`voice-input-button-inline absolute ${n?"right-2 bottom-2":"right-2 top-1/2 -translate-y-1/2"} p-1.5 rounded-md transition-colors ${s?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"hover:bg-accent"}`,title:s?"Stop recording":"Start voice input",type:"button","data-test":"input-with-audio-record-button",children:a.jsx(y,{className:`voice-input-icon ${k.sm} ${s?"animate-pulse":""}`})}),a.jsx("div",{className:"audio-panel-wrapper hidden","data-test":"input-with-audio-audio-panel-wrapper",children:a.jsx(R,{sessionName:"input-with-audio",enableAutoPersist:!1,loadPersistedChunks:!1,autoStart:!1,startTrigger:h,stopTrigger:f,onChunkCreated:S,onChunkUpdated:x,onRecordingStateChange:w})})]})});A.displayName="InputWithAudio";export{A as I};
