import{f as k,u as A,r as l,j as s}from"./react-vendor-CrhW4DYn.js";import{S as K}from"./SessionSidebar-o2c6r3GP.js";import{P as Q,K as T,Q as m,R as _,U as $,N as q}from"./index-CgyRe94A.js";import"./radio-group-yyvGmlz8.js";import"./radix-ui-BcQf1l4u.js";import"./icons-6Gjq1X59.js";import"./tree-YoeeSzP_.js";import"./utils-DPdF7W5J.js";import"./ui-utils-BxIQ3qGg.js";function ee(){const{sessionId:n}=k(),g=A(),{messages:v,sessionDetails:e,metadata:x,loading:P,pagination:d,currentPage:j,loadOlderMessages:M,searchMessages:w,refreshSession:r}=Q(n,{onSessionDeleted:()=>{g("/claude")}}),{sessions:N,loadingSessions:L,sessionsError:b,pagination:y,currentPage:C,searchSessions:E,refreshSessions:c,handlePageChange:I,handleLoadMore:R}=T({loadOnMount:!1,subscribeToSSE:!1});l.useLayoutEffect(()=>{var o,t,a,p,S,f;if(e!=null&&e.cwd){const i=m.getState();((a=(t=(o=i.app)==null?void 0:o.claude)==null?void 0:t.ui)==null?void 0:a.selectedProjectPath)!==e.cwd&&m.updateState({app:{...i.app,claude:{...(p=i.app)==null?void 0:p.claude,ui:{...(f=(S=i.app)==null?void 0:S.claude)==null?void 0:f.ui,selectedProjectPath:e.cwd}}}})}},[e==null?void 0:e.cwd]);const O=o=>{g(`/claude/${o}`)},[z,h]=l.useState(null),[B,u]=l.useState(!1),U=async(o,t)=>{try{u(!0);const a=await q.searchMessages(o,t);h(a.results),console.log("Message search results:",a)}catch(a){console.error("Message search failed:",a),h([])}finally{u(!1)}};return s.jsx("div",{className:"session-details-page h-full p-4 overflow-hidden",children:s.jsxs("div",{className:"session-layout grid grid-cols-[350px_1fr] gap-4 h-full overflow-hidden",children:[s.jsx("div",{className:"sessions-sidebar overflow-hidden",children:s.jsx(K,{sessions:N,loading:L,error:b,onSessionSelect:O,selectedSessionId:n??null,onRefresh:()=>{c(),r()},pagination:y,currentPage:C,onPageChange:I,onLoadMore:R,onSearch:E,onMessageSearch:U,onNameUpdated:()=>{r(),c()}})}),s.jsxs("div",{className:"chat-area flex flex-col gap-4 min-h-0 overflow-hidden",children:[s.jsx("div",{className:"chat-messages flex-1 min-h-0 overflow-hidden",children:s.jsx(_,{messages:v,sessionDetails:e,metadata:x,loading:P,pagination:d,onLoadOlder:d&&j<d.totalPages?M:void 0,onSearch:w,onNameUpdated:()=>{r(),c()}})}),s.jsx("div",{className:"chat-input flex-shrink-0",children:n&&s.jsx($,{sessionId:n,onSendSuccess:()=>{r()}})})]})]})})}export{ee as SessionDetailsPage};
