import{j as e,r as p}from"./react-vendor-Byz07MLO.js";import{dk as Z,dl as D,U as R}from"./index-eHP58yiE.js";import{a5 as te,dm as me,dn as fe,o as se,a2 as oe,p as he,_ as ge,P as be,a as Ne,aV as ye,T as ne,w as je,ae as ve,af as we,R as Ce}from"./icons-vtiX7BHn.js";const $e=s=>Z[s]||Z.default,ke=s=>{if(!s||s==="none")return{zoom:1,panX:0,panY:0};const o=/matrix\((.+)\)/.exec(s);if(o){const t=o[1].split(", ").map(Number);return{zoom:t[0],panX:t[4],panY:t[5]}}return{zoom:1,panX:0,panY:0}},Q=(s,o,t,r=1,c=0,x=0)=>({x:(s-t.left-c)/r,y:(o-t.top-x)/r}),Ie=(s,o=!1,t=!1)=>{const r=[D.base,D[s]];return(o||t)&&r.push(D.hover),r.join(" ")},Se=(s,o)=>!(o==="output"&&s==="input"||o==="input"&&s==="output"),ee=s=>{const o=window.getComputedStyle(s).transform;return ke(o)},X=({type:s,nodeId:o,onConnectionStart:t,onConnectionEnd:r,isHovered:c=!1,isActive:x=!1,className:l="",title:i})=>{const u=Ie(s,c,x),n=s==="input"?"Input - connect from other nodes":"Output - connect to other nodes";return e.jsx("div",{className:`${u} ${l}`,title:i||n,onMouseDown:d=>{d.stopPropagation(),t==null||t(o,s)},onMouseUp:d=>{d.stopPropagation(),r==null||r(o,s)}})};function Oe({data:s,onChange:o,isConnected:t}){var u;const[r,c]=p.useState(s.text||"");p.useEffect(()=>{s.text!==r&&c(s.text||"")},[s.text,r]);const x=n=>{c(n),o({...s,text:n})},i=t&&s.text!==void 0&&r!==s.text||((u=s.text)==null?void 0:u.includes(":"))&&s.text.includes(`
`);return e.jsxs("div",{className:`text-node p-3 text-white rounded-lg shadow-lg min-w-48 relative ${i?`${Z.input} border-2 border-green-300`:Z.text}`,children:[e.jsxs("div",{className:"node-header flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:R.sm}),e.jsx("span",{className:"font-medium text-sm",children:i?"Text Output":"Text Input"})]}),i&&e.jsx(me,{className:`${R.xs} opacity-70`})]}),e.jsx("div",{className:"node-content",children:e.jsx("textarea",{value:r,onChange:n=>x(n.target.value),placeholder:i?"Output from connected node...":"Enter text...",className:`w-full p-2 text-black rounded text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-blue-300 ${i?"bg-green-50 border border-green-200":""}`,readOnly:i,onClick:n=>n.stopPropagation()})}),e.jsx("div",{className:"node-output mt-2",children:e.jsxs("div",{className:"text-xs opacity-80 flex items-center justify-between",children:[e.jsxs("span",{children:["Output: ",r.length," characters"]}),!i&&e.jsx(fe,{className:`${R.xs} opacity-70`})]})}),!i&&e.jsx(X,{type:"input",nodeId:"",title:"Input - connect from other nodes"}),e.jsx(X,{type:"output",nodeId:"",title:"Output - connect to other nodes"})]})}const Me=[{value:"option1",label:"Option 1"},{value:"option2",label:"Option 2"},{value:"option3",label:"Option 3"},{value:"custom",label:"Custom Value"}];function Re({data:s,onChange:o}){const[t,r]=p.useState(s.selectedValue||""),[c,x]=p.useState(s.customValue||""),l=s.options||Me,i=n=>{r(n),o({...s,selectedValue:n,outputValue:n==="custom"?c:n})},u=n=>{x(n),t==="custom"&&o({...s,customValue:n,outputValue:n})};return e.jsxs("div",{className:"select-node p-3 bg-purple-500 text-white rounded-lg shadow-lg min-w-48",children:[e.jsxs("div",{className:"node-header flex items-center gap-2 mb-3",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Select Input"})]}),e.jsxs("div",{className:"node-content space-y-2",children:[e.jsxs("select",{value:t,onChange:n=>i(n.target.value),className:"w-full p-2 text-black rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-300",onClick:n=>n.stopPropagation(),children:[e.jsx("option",{value:"",children:"-- Select an option --"}),l.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),t==="custom"&&e.jsx("input",{type:"text",value:c,onChange:n=>u(n.target.value),placeholder:"Enter custom value...",className:"w-full p-2 text-black rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-300",onClick:n=>n.stopPropagation()})]}),e.jsx("div",{className:"node-output mt-2",children:e.jsxs("div",{className:"text-xs opacity-80",children:["Output: ",t==="custom"?c:t||"none"]})}),e.jsx("div",{className:"node-handle node-handle-input absolute -left-2 top-1/2 w-4 h-4 bg-background rounded-full border-2 border-border transform -translate-y-1/2"}),e.jsx("div",{className:"node-handle node-handle-output absolute -right-2 top-1/2 w-4 h-4 bg-background rounded-full border-2 border-border transform -translate-y-1/2"})]})}function Ve({data:s,onChange:o}){const[t,r]=p.useState(!1),[c,x]=p.useState(!1),[l,i]=p.useState(s.audioUrl||""),[u,n]=p.useState(s.duration||0),d=p.useRef(null),f=p.useRef(null),m=async()=>{try{const y=await navigator.mediaDevices.getUserMedia({audio:!0}),C=new MediaRecorder(y);d.current=C;const V=[];C.ondataavailable=g=>{V.push(g.data)},C.onstop=()=>{const g=new Blob(V,{type:"audio/wav"}),S=URL.createObjectURL(g);i(S),o({...s,audioUrl:S,audioBlob:g}),y.getTracks().forEach(O=>O.stop())},C.start(),r(!0)}catch(y){console.error("Error starting recording:",y)}},k=()=>{d.current&&(d.current.stop(),r(!1))},I=()=>{f.current&&l&&(c?(f.current.pause(),x(!1)):(f.current.play(),x(!0)))};return e.jsxs("div",{className:`audio-node p-3 ${Z.audio} text-white rounded-lg shadow-lg min-w-48`,children:[e.jsxs("div",{className:"node-header flex items-center gap-2 mb-3",children:[e.jsx(oe,{className:R.sm}),e.jsx("span",{className:"font-medium text-sm",children:"Audio Input"})]}),e.jsxs("div",{className:"node-content space-y-3",children:[e.jsx("div",{className:"recording-controls flex gap-2",children:t?e.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-3 py-2 bg-red-700 hover:bg-red-800 rounded text-sm transition-colors animate-pulse",onMouseDown:y=>y.stopPropagation(),children:[e.jsx(ge,{className:R.xs}),"Stop"]}):e.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-sm transition-colors",onMouseDown:y=>y.stopPropagation(),children:[e.jsx(he,{className:R.xs}),"Record"]})}),l&&e.jsxs("div",{className:"playback-controls",children:[e.jsx("button",{onClick:I,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm transition-colors w-full justify-center",onMouseDown:y=>y.stopPropagation(),children:c?e.jsxs(e.Fragment,{children:[e.jsx(be,{className:R.xs}),"Pause"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:R.xs}),"Play"]})}),e.jsx("audio",{ref:f,src:l,onEnded:()=>x(!1),onLoadedMetadata:y=>{const C=y.target;n(C.duration),o({...s,duration:C.duration})}})]})]}),e.jsx("div",{className:"node-output mt-2",children:e.jsx("div",{className:"text-xs opacity-80",children:l?`Duration: ${u.toFixed(1)}s`:"No audio recorded"})}),e.jsx(X,{type:"output",nodeId:""})]})}function Pe({node:s,isSelected:o,onSelect:t,onDelete:r,onDrag:c,onConnectionStart:x,onConnectionEnd:l,isConnecting:i,connectionStartType:u,onDataChange:n,hasInputConnections:d,hasOutputConnections:f}){const[m,k]=p.useState(!1),[I,y]=p.useState({x:0,y:0}),C=j=>{if(j.button!==0)return;const $=document.querySelector(".node-editor-canvas");if(!$)return;const W=$.getBoundingClientRect(),{zoom:U,panX:E,panY:H}=ee($),{x:_,y:F}=Q(j.clientX,j.clientY,W,U,E,H);y({x:_-s.position.x,y:F-s.position.y}),k(!0),t(s.id)},V=j=>{if(!m)return;const $=document.querySelector(".node-editor-canvas");if(!$)return;const W=$.getBoundingClientRect(),{zoom:U,panX:E,panY:H}=ee($),{x:_,y:F}=Q(j.clientX,j.clientY,W,U,E,H),q=_-I.x,B=F-I.y;c(s.id,{x:q,y:B})},g=()=>{k(!1)},S=j=>{if(i&&!m&&u){j.stopPropagation();const $=u==="output"?"input":"output";($==="input"&&s.type!=="input"||$==="output"&&s.type!=="output")&&(l==null||l(s.id,$))}};p.useEffect(()=>{if(m)return document.addEventListener("mousemove",V),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",g)}},[m,I]);const O=$e(s.type),P=i&&u&&Se(s.type,u),L=j=>{n==null||n(s.id,j)},A=()=>{if(s.type==="text"||s.type==="select"||s.type==="audio"){const j=s.type==="text"?Oe:s.type==="select"?Re:Ve;return e.jsxs("div",{className:"node-wrapper relative",children:[e.jsx(j,{data:s.data,onChange:L,isConnected:d||f}),(s.type==="text"||s.type==="select")&&e.jsx(X,{type:"input",nodeId:s.id,onConnectionStart:x,onConnectionEnd:l}),(s.type==="text"||s.type==="select"||s.type==="audio")&&e.jsx(X,{type:"output",nodeId:s.id,onConnectionStart:x,onConnectionEnd:l})]})}return e.jsxs("div",{className:`node-content ${O} text-white rounded-lg shadow-lg p-4 min-w-32`,children:[e.jsxs("div",{className:"node-header flex items-center justify-between mb-2",children:[e.jsx(ye,{className:`${R.sm} opacity-60`}),e.jsx("button",{onClick:j=>{j.stopPropagation(),r(s.id)},className:"text-white hover:text-red-200 opacity-60 hover:opacity-100",children:e.jsx(ne,{className:R.sm})})]}),e.jsxs("div",{className:"node-body",children:[e.jsx("h3",{className:"font-medium text-sm mb-1",children:s.label}),e.jsx("div",{className:"text-xs opacity-80",children:s.type})]}),s.type!=="output"&&e.jsx(X,{type:"output",nodeId:s.id,onConnectionStart:x,onConnectionEnd:l}),s.type!=="input"&&e.jsx(X,{type:"input",nodeId:s.id,onConnectionStart:x,onConnectionEnd:l})]})};return e.jsx("div",{className:`node-item absolute cursor-move select-none ${o?"ring-2 ring-blue-400":""} ${P?"ring-2 ring-green-400 ring-opacity-50":""}`,style:{left:s.position.x,top:s.position.y,transform:m?"scale(1.05)":"scale(1)",transition:m?"none":"transform 0.1s ease"},onMouseDown:C,onMouseUp:S,children:A()})}function Ae({connection:s,sourceNode:o,targetNode:t,onDelete:r}){const i=o.x+128+8,u=t.x-8,n=o.y+100/2,d=t.y+100/2,f=Math.abs(u-i)*.4,m=i+f,k=u-f,I=`M ${i} ${n} C ${m} ${n}, ${k} ${d}, ${u} ${d}`;return e.jsxs("g",{className:"connection-group",children:[e.jsx("path",{d:I,fill:"none",stroke:"#6b7280",strokeWidth:"2",className:"connection-path hover:stroke-red-500 cursor-pointer",onClick:()=>r==null?void 0:r(s.id)}),e.jsx("circle",{cx:i,cy:n,r:"3",fill:"#6b7280",className:"connection-start-dot"}),e.jsx("circle",{cx:u,cy:d,r:"3",fill:"#6b7280",className:"connection-end-dot"})]})}const Te=[{id:"input",label:"Input",color:"bg-green-500",inputs:0,outputs:1},{id:"process",label:"Process",color:"bg-blue-500",inputs:1,outputs:1},{id:"output",label:"Output",color:"bg-red-500",inputs:1,outputs:0},{id:"text",label:"Text Input",color:"bg-blue-600",inputs:0,outputs:1},{id:"select",label:"Select Input",color:"bg-purple-500",inputs:1,outputs:1},{id:"audio",label:"Audio Input",color:"bg-green-600",inputs:0,outputs:1}],Xe={text:te,select:se,audio:oe};function Ue({onAddNode:s}){return e.jsxs("div",{className:"node-toolbox bg-card border border-border rounded-lg p-4 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Node Types"}),e.jsx("div",{className:"space-y-2",children:Te.map(o=>{const t=Xe[o.id]||je;return e.jsxs("button",{onClick:()=>s(o.id),className:`toolbox-node-item w-full text-left p-3 rounded-lg border transition-colors hover:shadow-md ${o.color} text-white hover:opacity-90`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:o.label})]}),e.jsxs("div",{className:"text-xs opacity-80 mt-1",children:[o.inputs>0&&`${o.inputs} input${o.inputs>1?"s":""}`,o.inputs>0&&o.outputs>0&&" â€¢ ",o.outputs>0&&`${o.outputs} output${o.outputs>1?"s":""}`]})]},o.id)})})]})}class z{static editorNodesToWorkflowNodes(o){return o.map(t=>({id:t.id,type:t.type,position:t.position,parameters:t.data,inputs:[{id:"input_main",name:"Input"}],outputs:[{id:"output_main",name:"Output"}]}))}static editorConnectionsToWorkflowConnections(o){return o.map(t=>({id:t.id,sourceNodeId:t.source,sourceHandleId:t.sourceHandle||"output_main",targetNodeId:t.target,targetHandleId:t.targetHandle||"input_main"}))}static createWorkflowFromEditor(o,t,r="editor-workflow",c="Node Editor Workflow"){return{id:r,name:c,nodes:this.editorNodesToWorkflowNodes(o),connections:this.editorConnectionsToWorkflowConnections(t)}}static extractNodeOutput(o){var t;switch(o.type){case"text":return{text:o.data.text||"",length:((t=o.data.text)==null?void 0:t.length)||0,type:"text"};case"select":return{selectedValue:o.data.selectedValue||o.data.outputValue||"",options:o.data.options||[],type:"select"};case"audio":return{duration:o.data.duration||0,url:o.data.url||"",type:"audio"};default:return{...o.data,type:o.type}}}static applyInputToNode(o,t){switch(o.type){case"text":return typeof t=="string"?{text:t}:t&&typeof t=="object"?"text"in t?{text:String(t.text)}:"selectedValue"in t?{text:String(t.selectedValue)}:"duration"in t?{text:`Audio (${t.duration}s)`}:{text:JSON.stringify(t,null,2)}:{text:String(t||"")};case"select":return typeof t=="string"?{selectedValue:t,outputValue:t}:t&&"selectedValue"in t?{selectedValue:t.selectedValue,outputValue:t.selectedValue}:{};case"audio":return t&&"duration"in t?{duration:t.duration,url:t.url||""}:{};default:return typeof t=="object"&&t!==null?{...t}:{value:t}}}}class J{static processDataFlow(o,t,r){const c=new Map,x=new Set,l=[o],i=t.find(u=>u.id===o);if(i){const u=z.extractNodeOutput(i);c.set(o,u),x.add(o)}for(;l.length>0;){const u=l.shift(),n=r.filter(d=>d.source===u);for(const d of n){const f=d.target;if(x.has(f))continue;const m=t.find(V=>V.id===f);if(!m)continue;const k=this.getInputDataForNode(f,t,r,c),I=z.applyInputToNode(m,k),y={...m,data:{...m.data,...I}},C=z.extractNodeOutput(y);c.set(f,C),l.push(f),x.add(f)}}return c}static getInputDataForNode(o,t,r,c){const x=r.filter(n=>n.target===o);if(x.length===0)return null;if(x.length===1){const n=x[0].source;if(c.has(n)){const d=c.get(n);return d.type==="text"?d.text:d.type==="select"?d.selectedValue:d}else{const d=t.find(f=>f.id===n);if(d){const f=z.extractNodeOutput(d);return f.type==="text"?f.text:f.type==="select"?f.selectedValue:f}}return null}const l={},i=[];for(const n of x){const d=n.source,f=t.find(k=>k.id===d);if(!f)continue;let m;c.has(d)?m=c.get(d):m=z.extractNodeOutput(f),l[d]=m,m.type==="text"&&m.text?i.push(`${f.label}: ${m.text}`):m.type==="select"&&m.selectedValue?i.push(`${f.label}: ${m.selectedValue}`):m.type==="audio"&&i.push(`${f.label}: Audio (${m.duration}s)`)}const u=t.find(n=>n.id===o);return(u==null?void 0:u.type)==="text"&&i.length>0?i.join(`
`):l}static getAffectedNodes(o,t){const r=new Set,c=[o],x=new Set;for(;c.length>0;){const l=c.shift();if(x.has(l))continue;x.add(l);const i=t.filter(u=>u.source===l);for(const u of i)r.add(u.target),c.push(u.target)}return Array.from(r)}static hasInputConnections(o,t){return t.some(r=>r.target===o)}static hasOutputConnections(o,t){return t.some(r=>r.source===o)}}const ae=p.forwardRef(({initialNodes:s=[],initialConnections:o=[],hideToolbox:t=!1},r)=>{const[c,x]=p.useState(s),[l,i]=p.useState(o),[u,n]=p.useState(null),[d,f]=p.useState(1),[m,k]=p.useState({x:0,y:0}),[I,y]=p.useState(!1),[C,V]=p.useState({x:0,y:0}),[g,S]=p.useState(null),[O,P]=p.useState(!1),[L,A]=p.useState(null),j=p.useRef(null),$=p.useRef(s.length),W=p.useRef(o.length),U=p.useCallback(a=>{const h={id:`node-${$.current++}`,type:a,label:`${a.charAt(0).toUpperCase()}${a.slice(1)} Node`,position:{x:100+Math.random()*200,y:100+Math.random()*200},data:{}};x(b=>[...b,h])},[]);p.useImperativeHandle(r,()=>({addNode:U}));const E=p.useCallback(a=>{x(h=>h.filter(b=>b.id!==a)),i(h=>h.filter(b=>b.source!==a&&b.target!==a)),u===a&&n(null)},[u]),H=p.useCallback((a,h)=>{x(b=>b.map(v=>v.id===a?{...v,position:h}:v))},[]),_=p.useCallback((a,h)=>{x(b=>{const v=b.map(N=>N.id===a?{...N,data:{...N.data,...h}}:N),T=J.processDataFlow(a,v,l);return v.map(N=>{if(T.has(N.id)&&N.id!==a){const w=T.get(N.id);let M={};return N.type==="text"?typeof w=="string"?M={text:w}:w&&"text"in w&&(M={text:w.text}):N.type==="select"?w&&"selectedValue"in w&&(M={selectedValue:w.selectedValue,outputValue:w.selectedValue}):N.type==="audio"&&w&&"duration"in w&&(M={duration:w.duration,url:w.url||""}),{...N,data:{...N.data,...M}}}return N})})},[l]),F=p.useCallback(()=>{x([]),i([]),n(null)},[]),q=p.useCallback(a=>{i(h=>h.filter(b=>b.id!==a))},[]),B=p.useCallback((a,h)=>{S({nodeId:a,handleType:h}),P(!0)},[]),re=p.useCallback((a,h)=>{if(!g||!O)return;if(g.nodeId===a){S(null),P(!1),A(null);return}if(g.handleType===h){S(null),P(!1),A(null);return}const b=g.handleType==="output"?g.nodeId:a,v=g.handleType==="output"?a:g.nodeId;if(!l.find(N=>N.source===b&&N.target===v)){const N={id:`connection-${W.current++}`,source:b,target:v};i(Y=>[...Y,N])}S(null),P(!1),A(null)},[g,O,l]),le=a=>{a.button===1||a.button===0&&a.altKey?(y(!0),V({x:a.clientX-m.x,y:a.clientY-m.y}),a.preventDefault()):a.target===a.currentTarget&&n(null)},ce=a=>{if(I)k({x:a.clientX-C.x,y:a.clientY-C.y});else if(O&&j.current){const h=j.current.getBoundingClientRect(),b=(a.clientX-h.left-m.x)/d,v=(a.clientY-h.top-m.y)/d;A({x:b,y:v})}},K=()=>{y(!1),O&&(S(null),P(!1),A(null))},G=a=>{f(h=>Math.max(.1,Math.min(2,h+a)))},ie=()=>{f(1),k({x:0,y:0})};return e.jsxs("div",{className:"node-editor flex h-full",children:[!t&&e.jsxs("div",{className:"editor-sidebar w-80 p-4 bg-gray-50 border-r border-gray-200 overflow-auto",children:[e.jsx(Ue,{onAddNode:U}),e.jsxs("div",{className:"editor-controls mt-6 space-y-4",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Controls"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>G(.1),className:"flex items-center gap-1 px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[e.jsx(ve,{className:"w-4 h-4"}),"Zoom In"]}),e.jsxs("button",{onClick:()=>G(-.1),className:"flex items-center gap-1 px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:[e.jsx(we,{className:"w-4 h-4"}),"Zoom Out"]})]}),e.jsxs("button",{onClick:ie,className:"flex items-center gap-1 px-3 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 w-full",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Reset View"]}),e.jsxs("button",{onClick:F,className:"flex items-center gap-1 px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 w-full",children:[e.jsx(ne,{className:"w-4 h-4"}),"Clear All"]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Stats"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Nodes: ",c.length]}),e.jsxs("div",{children:["Connections: ",l.length]}),e.jsxs("div",{children:["Zoom: ",(d*100).toFixed(0),"%"]})]})]})]})]}),e.jsxs("div",{className:"editor-canvas-container flex-1 relative overflow-hidden bg-gray-100",children:[e.jsxs("div",{ref:j,className:"node-editor-canvas w-full h-full relative cursor-grab",style:{transform:`scale(${d}) translate(${m.x}px, ${m.y}px)`,transformOrigin:"0 0",cursor:I?"grabbing":"grab"},onMouseDown:le,onMouseMove:ce,onMouseUp:K,onMouseLeave:K,children:[e.jsx("div",{className:"canvas-grid absolute inset-0 pointer-events-none opacity-20",children:e.jsxs("svg",{width:"100%",height:"100%",className:"absolute inset-0",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"#d1d5db",strokeWidth:"1"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"})]})}),e.jsxs("svg",{className:"connections-layer absolute inset-0 pointer-events-auto",width:"100%",height:"100%",children:[l.map(a=>{const h=c.find(v=>v.id===a.source),b=c.find(v=>v.id===a.target);return!h||!b?null:e.jsx(Ae,{connection:a,sourceNode:h.position,targetNode:b.position,onDelete:q},a.id)}),O&&g&&L&&(()=>{const a=c.find(xe=>xe.id===g.nodeId);if(!a)return null;const h=128,b=100,v=8,T=g.handleType==="output"?a.position.x+h+v:a.position.x-v,N=a.position.y+b/2,Y=L.x,w=L.y,M=Math.abs(Y-T)*.4,ue=T+(g.handleType==="output"?M:-M),de=Y-(g.handleType==="output"?M:-M),pe=`M ${T} ${N} C ${ue} ${N}, ${de} ${w}, ${Y} ${w}`;return e.jsx("path",{d:pe,fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"5,5",className:"temp-connection"})})()]}),e.jsx("div",{className:"nodes-layer absolute inset-0",children:c.map(a=>{const h=J.hasInputConnections(a.id,l),b=J.hasOutputConnections(a.id,l);return e.jsx(Pe,{node:a,isSelected:u===a.id,onSelect:n,onDelete:E,onDrag:H,onConnectionStart:B,onConnectionEnd:re,isConnecting:O,connectionStartType:(g==null?void 0:g.handleType)||null,onDataChange:_,hasInputConnections:h,hasOutputConnections:b},a.id)})})]}),c.length===0&&e.jsx("div",{className:"instructions absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsxs("div",{className:"bg-card/90 p-6 rounded-lg shadow-lg text-center max-w-md",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Node Editor"}),e.jsx("p",{className:"text-gray-600",children:"Add nodes from the toolbox on the left. Drag nodes to move them around. Use middle mouse button or Alt+drag to pan the canvas."})]})})]})]})});ae.displayName="NodeEditor";const Ee=Object.freeze(Object.defineProperty({__proto__:null,NodeEditor:ae},Symbol.toStringTag,{value:"Module"}));export{Ve as A,ae as N,Re as S,Oe as T,Ee as i};
