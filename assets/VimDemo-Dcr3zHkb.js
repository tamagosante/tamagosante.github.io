import{r as t,j as e}from"./react-vendor-Byz07MLO.js";import{V as d,K as R,S as L,C,R as k,a as M,I as A}from"./VimInputHandlerV2-CkxNomCQ.js";import{V as m,D as T,E as D}from"./logging-O1kyNMYs.js";import{ak as F}from"./index-DPqC4dt9.js";const b=[{text:"Hello Vim World!"},{text:"This is a simple Vim editor demo."},{text:"Try navigating with h, j, k, l keys."},{text:"Press i to enter INSERT mode."},{text:"Press ESC to return to NORMAL mode."},{text:""},{text:"Try these commands:"},{text:"  dd - delete current line"},{text:"  yy - copy (yank) current line"},{text:"  p - paste after cursor"},{text:"  ^ - go to line start"},{text:"  $ - go to line end"},{text:"  gg - go to first line"},{text:"  G - go to last line"}];function _({logger:i}){const[o,v]=t.useState(d.NORMAL),[a,u]=t.useState({line:0,col:0}),[w,y]=t.useState(b),p=t.useRef(null),x=t.useRef(null),n=t.useRef(null),N=t.useRef(!1),g=t.useRef(new F),l=(r,s)=>{i==null||i.info(r),g.current.sendLogs(r,s,"vim-client.log").catch(console.error)},f=(r,s)=>{i==null||i.error(r),g.current.sendLogs(`ERROR: ${r}`,s,"vim-client.log").catch(console.error)};t.useEffect(()=>{if(!x.current)return;const r=8.4,s=20,c=16,j=16,h=56,S=c+a.line*s,E=j+h+a.col*r;x.current.style.top=`${S}px`,x.current.style.left=`${E}px`},[a]),t.useEffect(()=>{if(!N.current&&p.current)return(async()=>{try{await g.current.clearLogs("vim-client.log"),V()}catch(r){f(`Failed during initialization: ${r instanceof Error?r.message:String(r)}`,{error:r})}})(),()=>{n.current&&n.current.popIdIf(m.vimDemo)}},[i]);const V=()=>{let r;try{const s=window.__vimContainer;if(s?(r=s,l("Using existing Vim container")):(r=T.createContainer(),D.register(r),R.register(r),L.register(r),C.register(r),k.register(r),M.register(r),window.__vimContainer=r),n.current=r.get(A),!n.current)throw new Error("VimInputHandlerV2 instance is null")}catch(s){f(`Failed to initialize Vim: ${s instanceof Error?s.message:String(s)}`,{error:s}),console.error("Vim initialization error:",s);return}if(n.current)try{n.current.registerAndInit({vimId:m.vimDemo,container:p.current??void 0,vimState:{id:m.vimDemo,lines:b,cursor:{line:0,col:0},mode:d.NORMAL},hooks:{modeChanged:(s,c,j)=>{var h;(h=s.vimState)!=null&&h.cursor&&(l(`Mode changed to: ${s.vimState.mode}`,{mode:s.vimState.mode}),v(s.vimState.mode),u(s.vimState.cursor))},onInsertInput:(s,c,j)=>(s!=null&&s.lines&&s.cursor&&(y([...s.lines]),u(s.cursor)),!0),commandListener:s=>{var c;!((c=s.vimState)!=null&&c.lines)||!s.vimState.cursor||(y([...s.vimState.lines]),u(s.vimState.cursor))},afterInit:s=>{l("Vim editor initialized for vim-demo")}}}),n.current.setActiveId(m.vimDemo),N.current=!0,l("Vim Demo ready!")}catch(s){f(`Failed to register Vim instance: ${s instanceof Error?s.message:String(s)}`,{error:s}),console.error("Vim registration error:",s)}},I=()=>{n.current&&(n.current.setActiveId(m.vimDemo),l("Vim editor focused"))};return e.jsxs("div",{className:"vim-demo space-y-6",children:[e.jsxs("div",{className:"status-bar bg-gray-800 text-white p-3 rounded-lg font-mono flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-bold",children:["Mode: ",e.jsx("span",{className:o===d.INSERT?"text-green-400":o===d.VISUAL?"text-yellow-400":"text-blue-400",children:o})]}),e.jsxs("span",{className:"text-gray-400",children:["Cursor: Line ",a.line+1,", Col ",a.col+1]})]}),e.jsx("div",{className:"text-sm text-gray-400",children:"Click editor to focus | Press 'i' for INSERT, 'v' for VISUAL, ESC for NORMAL"})]}),e.jsxs("div",{className:`vim-container mode-${o} border-2 border-gray-300 rounded-lg overflow-hidden relative bg-white`,style:{minHeight:"400px"},children:[e.jsx("div",{ref:x,id:"caret",className:"caret-blinking"}),e.jsx("div",{ref:p,className:"vim-lines p-4 font-mono text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",contentEditable:o===d.INSERT,suppressContentEditableWarning:!0,onFocus:I,tabIndex:0,children:w.map((r,s)=>e.jsxs("div",{className:"vim-line flex",children:[e.jsx("span",{className:"line-number text-gray-400 w-12 select-none mr-2",children:s+1}),e.jsx("span",{className:"line-content",children:r.text||" "})]},s))})]}),e.jsxs("div",{className:"info-panel bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-900",children:"Vim Demo Features"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"feature-section",children:[e.jsx("h4",{className:"font-semibold mb-2 text-blue-800",children:"Navigation (NORMAL mode)"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-700",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"h/l"})," - Move left/right"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"k/u"})," - Move up/down"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"w/b"})," - Word forward/back"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"^/$"})," - Line start/end"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"gg/G"})," - First/last line"]})]})]}),e.jsxs("div",{className:"feature-section",children:[e.jsx("h4",{className:"font-semibold mb-2 text-blue-800",children:"Editing Commands"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-700",children:[e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"i"})," - Enter INSERT mode"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"v"})," - Enter VISUAL mode"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"dd"})," - Delete line"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"yy"})," - Yank (copy) line"]}),e.jsxs("li",{children:[e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"p"})," - Paste"]})]})]}),e.jsxs("div",{className:"feature-section",children:[e.jsx("h4",{className:"font-semibold mb-2 text-blue-800",children:"Search & Replace"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-700",children:[e.jsxs("li",{children:[e.jsxs("code",{className:"bg-white px-2 py-1 rounded",children:["f","{char}"]})," - Find character forward"]}),e.jsxs("li",{children:[e.jsxs("code",{className:"bg-white px-2 py-1 rounded",children:["F","{char}"]})," - Find character backward"]}),e.jsxs("li",{children:[e.jsxs("code",{className:"bg-white px-2 py-1 rounded",children:["r","{char}"]})," - Replace character"]})]})]}),e.jsxs("div",{className:"feature-section",children:[e.jsx("h4",{className:"font-semibold mb-2 text-blue-800",children:"Implementation"}),e.jsxs("ul",{className:"text-sm space-y-1 text-gray-700",children:[e.jsx("li",{children:"✅ Full VimInputHandlerV2 integration"}),e.jsx("li",{children:"✅ Mode-based command routing"}),e.jsx("li",{children:"✅ React hooks for state sync"}),e.jsx("li",{children:"✅ Visible cursor with blinking"})]})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," This demo uses the actual VimInputHandlerV2 system. Try the Vim commands above - they really work! The system supports multiple concurrent editors, custom key bindings, and comprehensive Vim command sets. See ",e.jsx("code",{className:"bg-white px-1 rounded",children:"src/features/vim/_docs/analysis/react-integration-guide.md"})," for integration details."]})})]}),e.jsxs("div",{className:"quick-reference bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-800",children:"Quick Reference - Try These!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:"dd"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Delete current line"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:"yy"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Copy current line"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:"p"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Paste after cursor"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:"u"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Undo (down in NORMAL)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:"Ctrl+Shift+Z"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Redo"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:"i"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Start typing"})]})]})]})]})}export{_ as V};
