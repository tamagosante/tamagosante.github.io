import{j as e,d as Ie,r as i,h as ls,u as ns}from"./react-vendor-Byz07MLO.js";import{t as U}from"./utils-DJ2ViQ2u.js";import{V as F,B as xe,aX as ze,a as p,aY as os,w as Me,aZ as ds,r as cs,C as fe,b as he,c as ge,l as J,L as M,S as pe,h as ve,i as je,j as ye,k as G,I as Z,e as ke,aw as ms,a_ as us,a$ as xs,b0 as fs,ac as Ne,s as hs,M as gs,T as ps}from"./index-eHP58yiE.js";import{G as L,b7 as Q,N as Te,b8 as vs,c as js,T as ys,F as ks,b9 as Ns,ba as bs,h as Cs,aa as ws,ad as Ss,X as be,r as Is,q as zs,e as Ms}from"./icons-vtiX7BHn.js";import"./radix-ui-v9Pxfv0s.js";import"./ui-utils-BxIQ3qGg.js";const Ce=3,Ts={template:"bg-purple-500/20 text-purple-700 dark:text-purple-300 border-purple-500/30",bug:"bg-red-500/20 text-red-700 dark:text-red-300 border-red-500/30",experiment:"bg-blue-500/20 text-blue-700 dark:text-blue-300 border-blue-500/30",archive:"bg-gray-500/20 text-gray-700 dark:text-gray-300 border-gray-500/30"};function Fs({fork:t,isSelected:c=!1,onClick:l,onToggleFavorite:a,onEdit:d,onDelete:m,sessionName:j,messageCount:y,onTagClick:f,onCategoryClick:n}){var w,S;const b=()=>{l==null||l(t)},u=o=>{o.stopPropagation(),a==null||a(t)},k=o=>{o.stopPropagation(),d==null||d(t)},v=o=>{o.stopPropagation(),m==null||m(t)},r=o=>{o.stopPropagation(),t.category&&n&&n(t.category)},N=(o,g)=>{o.stopPropagation(),f==null||f(g)},C=((w=t.tags)==null?void 0:w.slice(0,Ce))??[],x=(((S=t.tags)==null?void 0:S.length)??0)-Ce;return e.jsxs("div",{"data-test":"fork-list-item",className:F("fork-list-item group relative p-3 rounded-lg border cursor-pointer transition-colors",c?"bg-primary/10 border-primary":"hover:bg-accent border-transparent hover:border-border"),onClick:b,children:[e.jsxs("div",{"data-test":"fork-list-item-header",className:"fork-list-item-header flex items-start gap-2",children:[e.jsx(L,{size:16,className:"mt-0.5 flex-shrink-0 text-muted-foreground","data-test":"fork-list-item-icon"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{"data-test":"fork-list-item-name",className:"fork-list-item-name font-medium text-sm truncate",children:t.sessionName||t.description||"Unnamed Fork"}),t.isFavorite&&e.jsx(Q,{size:12,className:"flex-shrink-0 fill-yellow-400 text-yellow-400","data-test":"fork-list-item-favorite-icon"})]}),j&&e.jsx("div",{"data-test":"fork-list-item-session",className:"fork-list-item-session text-xs text-muted-foreground truncate",children:j}),(t.category||t.tags&&t.tags.length>0)&&e.jsxs("div",{"data-test":"fork-list-item-badges",className:"flex flex-wrap items-center gap-1 mt-1",children:[t.category&&e.jsx(xe,{"data-test":"fork-list-item-category",variant:"outline",className:F("text-[10px] px-1.5 py-0 h-4",Ts[t.category],n&&"cursor-pointer hover:opacity-80"),onClick:n?r:void 0,children:t.category}),C.map(o=>e.jsx(xe,{"data-test":"fork-list-item-tag",variant:"secondary",className:F("text-[10px] px-1.5 py-0 h-4 bg-secondary/50",f&&"cursor-pointer hover:bg-secondary/80"),onClick:f?g=>N(g,o):void 0,children:o},o)),x>0&&e.jsxs("span",{"data-test":"fork-list-item-tags-overflow",className:"text-[10px] text-muted-foreground",children:["+",x," more"]})]})]})]}),e.jsxs("div",{"data-test":"fork-list-item-meta",className:"fork-list-item-meta mt-2 flex items-center gap-3 text-xs text-muted-foreground",children:[y!==void 0&&e.jsxs("span",{className:"flex items-center gap-1","data-test":"fork-list-item-message-count",children:[e.jsx(Te,{size:10}),y," messages"]}),e.jsxs("span",{className:"flex items-center gap-1","data-test":"fork-list-item-date",children:[e.jsx(vs,{size:10}),ze(t.forkedAt)]})]}),e.jsxs("div",{"data-test":"fork-list-item-actions",className:F("fork-list-item-actions absolute right-2 top-2 flex gap-1","opacity-0 group-hover:opacity-100 transition-opacity"),children:[a&&e.jsx(p,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:u,"data-test":"fork-list-item-favorite-btn",title:t.isFavorite?"Remove from favorites":"Add to favorites",children:e.jsx(Q,{size:12,className:F(t.isFavorite&&"fill-yellow-400 text-yellow-400")})}),d&&e.jsx(p,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:k,"data-test":"fork-list-item-edit-btn",title:"Edit fork",children:e.jsx(js,{size:12})}),m&&e.jsx(p,{variant:"ghost",size:"icon",className:"h-6 w-6 hover:text-destructive",onClick:v,"data-test":"fork-list-item-delete-btn",title:"Delete fork",children:e.jsx(ys,{size:12})})]})]})}function Es(t){switch(t){case"user":return e.jsx(Cs,{size:10,className:"text-primary"});case"assistant":return e.jsx(bs,{size:10,className:"text-green-500"});case"tool_result":return e.jsx(Ns,{size:10,className:"text-orange-500"});default:return e.jsx(Te,{size:10,className:"text-muted-foreground"})}}function we({message:t}){return e.jsxs("div",{"data-test":"fork-message-preview",className:"flex items-start gap-1.5 text-xs text-muted-foreground py-0.5",children:[e.jsx("span",{className:"flex-shrink-0 mt-0.5",children:Es(t.entryType)}),e.jsx("span",{className:"truncate",children:t.preview||"(empty)"})]})}function Fe(t){const l=!!t.forkedAt?e.jsx(L,{size:14,className:"text-muted-foreground"}):e.jsx(ks,{size:14,className:"text-muted-foreground"});return{id:t.sessionId,label:t.customName||t.name||`Session ${t.sessionId.slice(0,8)}`,icon:l,data:t,children:t.children.map(Fe)}}function Ee(t){const c=new Set([t.sessionId]);for(const l of t.children)Ee(l).forEach(d=>c.add(d));return c}function Ps({tree:t,selectedSessionId:c,loading:l=!1,error:a,onSessionSelect:d,showMessages:m=!1}){const j=Ie(),y=i.useMemo(()=>t?[Fe(t)]:[],[t]),f=i.useMemo(()=>t?Ee(t):new Set,[t]),n=u=>{d?d(u.id):j(`/claude/${u.id}`)},b=(u,k,v)=>{const r=u.data,N=m&&(r==null?void 0:r.inheritedMessages)&&r.inheritedMessages.length>0,C=m&&(r==null?void 0:r.messages)&&r.messages.length>0;return e.jsxs("div",{"data-test":"fork-tree-node",className:F("fork-tree-node flex flex-col py-2 px-3 hover:bg-accent hover:text-accent-foreground cursor-pointer rounded-sm transition-colors",k&&"bg-primary/10 border border-primary"),onClick:v,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"fork-tree-node-icon w-4 h-4 mr-2 flex-shrink-0"}),u.icon&&e.jsx("div",{className:"fork-tree-node-custom-icon mr-2 flex-shrink-0","data-test":"fork-tree-node-icon",children:u.icon}),e.jsxs("div",{className:"fork-tree-node-content flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"fork-tree-node-label truncate","data-test":"fork-tree-node-label",children:u.label}),(r==null?void 0:r.isFavorite)&&e.jsx(Q,{size:12,className:"flex-shrink-0 fill-yellow-400 text-yellow-400","data-test":"fork-tree-node-favorite"}),(r==null?void 0:r.messageCount)!==void 0&&e.jsxs("span",{className:"text-xs text-muted-foreground","data-test":"fork-tree-node-message-count",children:["(",r.messageCount,")"]})]}),(r==null?void 0:r.forkedAt)&&e.jsx("div",{className:"text-xs text-muted-foreground","data-test":"fork-tree-node-meta",children:ze(r.forkedAt)})]})]}),N&&e.jsxs("div",{"data-test":"fork-tree-node-inherited-messages",className:"fork-tree-node-inherited-messages mt-2 ml-6 pl-2 border-l-2 border-muted-foreground/30 space-y-0.5",children:[e.jsx("div",{className:"text-xs text-muted-foreground/70 font-medium mb-1",children:"Inherited from parent:"}),r.inheritedMessages.slice(0,3).map(x=>e.jsx(we,{message:x},x.uuid)),r.inheritedMessages.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground italic",children:["+",r.inheritedMessages.length-3," more..."]})]}),C&&e.jsxs("div",{"data-test":"fork-tree-node-messages",className:"fork-tree-node-messages mt-2 ml-6 pl-2 border-l-2 border-primary/30 space-y-0.5",children:[N&&e.jsx("div",{className:"text-xs text-muted-foreground/70 font-medium mb-1",children:"New in this fork:"}),r.messages.slice(0,5).map(x=>e.jsx(we,{message:x},x.uuid)),r.messages.length>5&&e.jsxs("div",{className:"text-xs text-muted-foreground italic",children:["+",r.messages.length-5," more..."]})]})]})};return l?e.jsx("div",{"data-test":"fork-tree-loading",className:"fork-tree-loading flex items-center justify-center h-full",children:e.jsx("div",{className:"text-muted-foreground animate-pulse",children:"Loading fork tree..."})}):a?e.jsx("div",{"data-test":"fork-tree-error",className:"fork-tree-error flex items-center justify-center h-full text-destructive",children:a}):!t||y.length===0?e.jsxs("div",{"data-test":"fork-tree-empty",className:"fork-tree-empty flex flex-col items-center justify-center h-full text-muted-foreground",children:[e.jsx(L,{size:48,className:"mb-4 opacity-50"}),e.jsx("p",{children:"No fork tree available"}),e.jsx("p",{className:"text-sm",children:"Select a session to view its fork hierarchy"})]}):e.jsx("div",{"data-test":"fork-tree-visualization",className:"fork-tree-visualization h-full",children:e.jsx(os,{data:y,onItemClick:n,defaultExpandedIds:f,selectedId:c,renderLeaf:b,className:"p-2"})})}function As(t){const[c,l]=i.useState(null),[a,d]=i.useState(0),[m,j]=i.useState(!1),[y,f]=i.useState(null),n=i.useCallback(async(u,k)=>{j(!0),f(null);const v={includeMessages:t==null?void 0:t.includeMessages,messageTypes:t==null?void 0:t.messageTypes,messageLimit:t==null?void 0:t.messageLimit,...k};try{const r=await Me.getForkTree(u,v);l(r.root),d(r.totalNodes)}catch(r){console.error("[useForkTree] Failed to load fork tree:",{sessionId:u,options:v,error:r,errorMessage:r instanceof Error?r.message:"Unknown error",timestamp:new Date().toISOString()}),f(r instanceof Error?r.message:"Failed to load fork tree"),l(null),d(0)}finally{j(!1)}},[t==null?void 0:t.includeMessages,t==null?void 0:t.messageTypes,t==null?void 0:t.messageLimit]),b=i.useCallback(()=>{l(null),d(0),f(null)},[]);return{tree:c,totalNodes:a,loading:m,error:y,loadTree:n,clearTree:b}}const Se=[{value:"template",label:"Template"},{value:"bug",label:"Bug"},{value:"experiment",label:"Experiment"},{value:"archive",label:"Archive"}];function Pe(t,c){if(!t)return null;if(t.sessionId===c)return t;for(const l of t.children){const a=Pe(l,c);if(a)return a}return null}function _s(){const[t]=ls(),{forkId:c}=ns(),l=Ie(),[a,d]=i.useState(null),[m,j]=i.useState(null),[y,f]=i.useState(!1),[n,b]=i.useState(null),[u,k]=i.useState(""),[v,r]=i.useState(""),[N,C]=i.useState(void 0),[x,w]=i.useState([]),[S,o]=i.useState(""),[g,O]=i.useState(!1),[B,Ae]=i.useState(!0),[W,Le]=i.useState(void 0),[R,ee]=i.useState(""),[H,Be]=i.useState(!1),E=t.get("sessionId"),{forks:P,loading:K,error:se,pagination:I,currentPage:A,favoritesOnly:te,refreshForks:V,loadForks:X,toggleFavoritesOnly:ae,toggleFavorite:ie,updateFork:re,deleteFork:le}=ds({loadOnMount:!0,parentSessionId:E??void 0,filterByCategory:W,filterByTag:R||void 0,includeChildren:H,pageSize:20}),{tree:$,loading:Re,error:Ve,loadTree:D}=As({includeMessages:B,messageTypes:"user,assistant",messageLimit:10}),{messages:ne,sessionDetails:z,metadata:$e,loading:De,pagination:_e,loadOlderMessages:Ue,refreshSession:oe,addOptimisticMessage:Ge,removeOptimisticMessage:We}=cs(m,{loadOnMount:!0,subscribeToSSE:!0}),de=i.useMemo(()=>{const s=Math.round(window.innerWidth*.6),h=Math.round(window.innerHeight*.8),T=Math.round((window.innerWidth-s)/2),me=Math.round((window.innerHeight-h)/2);return{size:{width:s,height:h},position:{x:T,y:me}}},[]),Y=i.useMemo(()=>!m||!$?null:Pe($,m),[m,$]);i.useEffect(()=>{if(c&&P.length>0){const s=P.find(h=>String(h.id)===c);s&&(a==null?void 0:a.id)!==s.id&&d(s)}},[c,P,a==null?void 0:a.id]),i.useEffect(()=>{const s=(a==null?void 0:a.sessionId)??E;s&&D(s)},[a==null?void 0:a.sessionId,E,D,B]),i.useEffect(()=>{X(1)},[W,R,H]);const He=i.useCallback(s=>{d(s),l(`/claude/forks/${s.id}`)},[l]),Ke=i.useCallback(s=>{ie(s.sessionId)},[ie]),Xe=i.useCallback(async s=>{window.confirm(`Are you sure you want to delete this fork${s.description?` "${s.description}"`:""}?`)&&(await le(s.sessionId),(a==null?void 0:a.id)===s.id&&d(null))},[le,a]),Ye=i.useCallback(s=>{b(s),k(s.sessionName??""),r(s.description??""),C(s.category),w(s.tags??[]),o("")},[]),_=i.useCallback(()=>{b(null),k(""),r(""),C(void 0),w([]),o("")},[]),qe=i.useCallback(async()=>{if(n){O(!0);try{const s=[],h={},T=v.trim()||void 0;T!==n.description&&(h.description=T),N!==n.category&&(h.category=N),JSON.stringify(x)!==JSON.stringify(n.tags??[])&&(h.tags=x),Object.keys(h).length>0&&s.push(re(n.sessionId,h));const ue=u.trim()||null;ue!==(n.sessionName??null)&&s.push(Me.updateSessionName(n.sessionId,ue)),s.length>0&&(await Promise.all(s),U.success("Fork updated"),V()),_()}catch{U.error("Failed to update fork")}finally{O(!1)}}},[n,u,v,N,x,re,V,_]),Je=i.useCallback(s=>{j(s),f(!0)},[]),Ze=i.useCallback(()=>{f(!1)},[]),Qe=i.useCallback(()=>{V();const s=(a==null?void 0:a.sessionId)??E;s&&D(s)},[V,D,a==null?void 0:a.sessionId,E]),ce=i.useCallback(s=>{X(s)},[X]),Oe=i.useCallback(()=>{ae()},[ae]),es=i.useCallback(s=>s.length<=19?s:`${s.slice(0,8)}...${s.slice(-8)}`,[]),ss=i.useCallback(async s=>{try{await navigator.clipboard.writeText(s),U.success("Session ID copied")}catch{U.error("Failed to copy")}},[]),q=i.useCallback(()=>{const s=S.trim().toLowerCase();s&&!x.includes(s)&&(w(h=>[...h,s]),o(""))},[S,x]),ts=i.useCallback(s=>{w(h=>h.filter(T=>T!==s))},[]),as=i.useCallback(s=>{s.key==="Enter"&&(s.preventDefault(),q())},[q]),is=i.useCallback(s=>{Le(s==="all"?void 0:s)},[]),rs=i.useCallback(()=>{ee("")},[]);return e.jsxs("div",{"data-test":"forks-page",className:"forks-page h-full p-4 overflow-hidden",children:[e.jsxs("div",{className:"forks-page-layout grid grid-cols-[350px_1fr] gap-4 h-full overflow-hidden",children:[e.jsxs(fe,{"data-test":"forks-sidebar",className:"forks-sidebar flex flex-col overflow-hidden",children:[e.jsxs(he,{className:"flex-shrink-0 pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ge,{className:"flex items-center gap-2 text-lg",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>l("/claude"),"data-test":"forks-back-btn",title:"Back to Sessions",children:e.jsx(ws,{size:16})}),e.jsx(L,{size:18}),"Forks",I&&I.totalCount>0&&e.jsxs("span",{"data-test":"forks-count",className:"text-sm font-normal text-muted-foreground",children:["(",I.totalCount,")"]})]}),e.jsx(p,{variant:"ghost",size:"icon",onClick:Qe,disabled:K,"data-test":"forks-refresh-btn",title:"Refresh",children:e.jsx(Ss,{size:16,className:K?"animate-spin":""})})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{id:"favorites-only",checked:te,onCheckedChange:()=>Oe(),"data-test":"forks-favorites-toggle"}),e.jsx(M,{htmlFor:"favorites-only",className:"text-sm",children:"Favorites only"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{id:"include-children",checked:H,onCheckedChange:Be,"data-test":"forks-include-children-toggle"}),e.jsx(M,{htmlFor:"include-children",className:"text-sm",children:"Include derived"})]}),e.jsxs(pe,{value:W??"all",onValueChange:is,children:[e.jsx(ve,{"data-test":"forks-category-filter",className:"w-[120px] h-8 text-xs",children:e.jsx(je,{placeholder:"Category"})}),e.jsxs(ye,{children:[e.jsx(G,{value:"all",children:"All Categories"}),Se.map(s=>e.jsx(G,{value:s.value,children:s.label},s.value))]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Z,{"data-test":"forks-tag-filter",placeholder:"Filter by tag...",value:R,onChange:s=>ee(s.target.value),className:"h-8 text-xs pr-8"}),R&&e.jsx(p,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6",onClick:rs,"data-test":"forks-tag-filter-clear",children:e.jsx(be,{size:12})})]})})]})]}),e.jsx(ke,{className:"flex-1 min-h-0 p-0",children:e.jsx(ms,{"data-test":"forks-list",className:"forks-list h-full px-4",children:K?e.jsx("div",{"data-test":"forks-loading",className:"flex items-center justify-center py-8 text-muted-foreground",children:"Loading forks..."}):se?e.jsx("div",{"data-test":"forks-error",className:"flex items-center justify-center py-8 text-destructive",children:se}):P.length===0?e.jsxs("div",{"data-test":"forks-empty",className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[e.jsx(L,{size:32,className:"mb-2 opacity-50"}),e.jsx("p",{children:te?"No favorite forks":"No forks yet"}),e.jsx("p",{className:"text-sm",children:"Create a fork from any session to start exploring alternatives"})]}):e.jsx("div",{className:"space-y-2 py-2",children:P.map(s=>e.jsx(Fs,{fork:s,isSelected:(a==null?void 0:a.id)===s.id,onClick:He,onToggleFavorite:Ke,onEdit:Ye,onDelete:Xe},s.id))})})}),I&&I.totalPages>1&&e.jsxs("div",{"data-test":"forks-pagination",className:"forks-pagination flex items-center justify-between px-4 py-2 border-t",children:[e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>ce(A-1),disabled:A<=1,"data-test":"forks-prev-page",children:[e.jsx(Is,{size:16}),"Previous"]}),e.jsxs("span",{className:"text-sm text-muted-foreground","data-test":"forks-page-info",children:["Page ",A," of ",I.totalPages]}),e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>ce(A+1),disabled:A>=I.totalPages,"data-test":"forks-next-page",children:["Next",e.jsx(zs,{size:16})]})]})]}),e.jsxs(fe,{"data-test":"forks-tree-panel",className:"forks-tree-panel flex flex-col overflow-hidden",children:[e.jsxs(he,{className:"flex-shrink-0 pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ge,{className:"text-lg",children:"Fork Tree"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{id:"show-messages",checked:B,onCheckedChange:Ae,"data-test":"forks-show-messages-toggle"}),e.jsx(M,{htmlFor:"show-messages",className:"text-sm",children:"Show messages"})]})]}),a&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-muted-foreground","data-test":"forks-tree-panel-selected",children:["Viewing: ",a.sessionName||a.description||`Fork ${a.sessionId.slice(0,8)}`]}),e.jsxs("div",{className:"flex items-center gap-1","data-test":"forks-tree-panel-session-id",children:[e.jsxs(us,{children:[e.jsx(xs,{asChild:!0,children:e.jsx("span",{className:"text-xs font-mono text-muted-foreground cursor-default",children:es(a.sessionId)})}),e.jsx(fs,{children:e.jsx("span",{className:"font-mono text-xs",children:a.sessionId})})]}),e.jsx(p,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>ss(a.sessionId),"data-test":"forks-tree-panel-copy-id",title:"Copy session ID",children:e.jsx(Ms,{size:12})})]})]})]}),e.jsx(ke,{className:"flex-1 min-h-0 p-0",children:e.jsx(Ps,{tree:$,selectedSessionId:a==null?void 0:a.sessionId,loading:Re,error:Ve??void 0,onSessionSelect:Je,showMessages:B})})]})]}),e.jsx(Ne,{isVisible:y,onClose:Ze,title:(z==null?void 0:z.customName)??(z==null?void 0:z.name)??"Session Chat",shouldCloseManually:!0,resizable:!0,initialSize:de.size,initialPosition:de.position,children:e.jsxs("div",{className:"flex flex-col h-full","data-test":"fork-chat-popover-content",children:[e.jsx("div",{className:"flex-1 overflow-auto","data-test":"fork-chat-messages-area",children:e.jsx(hs,{messages:ne,sessionDetails:z,metadata:$e,loading:De,pagination:_e,onLoadOlder:Ue,onNameUpdated:oe,inheritedMessages:Y==null?void 0:Y.inheritedMessages})}),m&&e.jsx("div",{className:"border-t p-2","data-test":"fork-chat-input-area",children:e.jsx(gs,{sessionId:m,onSendSuccess:()=>{oe()},onAddOptimisticMessage:Ge,onRemoveOptimisticMessage:We,userMessages:ne.filter(s=>s.role==="user"&&!s._isOptimistic)})})]})}),e.jsx(Ne,{isVisible:n!==null,onClose:_,title:"Edit Fork",shouldCloseManually:!0,resizable:!1,initialSize:{width:400,height:500},initialPosition:{x:Math.round((window.innerWidth-400)/2),y:Math.round((window.innerHeight-500)/2)},children:e.jsxs("div",{className:"p-4 flex flex-col gap-4","data-test":"fork-edit-popover-content",children:[e.jsxs("div",{"data-test":"fork-edit-name-field",className:"space-y-2",children:[e.jsx(M,{htmlFor:"fork-edit-name",children:"Name"}),e.jsx(Z,{id:"fork-edit-name","data-test":"fork-edit-name-input",placeholder:"Fork name...",value:u,onChange:s=>k(s.target.value),disabled:g})]}),e.jsxs("div",{"data-test":"fork-edit-description-field",className:"space-y-2",children:[e.jsx(M,{htmlFor:"fork-edit-description",children:"Description"}),e.jsx(ps,{id:"fork-edit-description","data-test":"fork-edit-description-input",placeholder:"Why was this fork created?",value:v,onChange:s=>r(s.target.value),disabled:g,rows:3,className:"resize-none"})]}),e.jsxs("div",{"data-test":"fork-edit-category-field",className:"space-y-2",children:[e.jsx(M,{htmlFor:"fork-edit-category",children:"Category"}),e.jsxs(pe,{value:N??"none",onValueChange:s=>C(s==="none"?void 0:s),disabled:g,children:[e.jsx(ve,{"data-test":"fork-edit-category-select",id:"fork-edit-category",children:e.jsx(je,{placeholder:"Select category..."})}),e.jsxs(ye,{children:[e.jsx(G,{value:"none",children:"None"}),Se.map(s=>e.jsx(G,{value:s.value,children:s.label},s.value))]})]})]}),e.jsxs("div",{"data-test":"fork-edit-tags-field",className:"space-y-2",children:[e.jsx(M,{htmlFor:"fork-edit-tags",children:"Tags"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Z,{id:"fork-edit-tags","data-test":"fork-edit-tags-input",placeholder:"Add tag...",value:S,onChange:s=>o(s.target.value),onKeyDown:as,disabled:g,className:"flex-1"}),e.jsx(p,{type:"button",variant:"outline",size:"sm",onClick:q,disabled:g||!S.trim(),"data-test":"fork-edit-tags-add",children:"Add"})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2","data-test":"fork-edit-tags-list",children:x.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs rounded-full bg-secondary text-secondary-foreground","data-test":"fork-edit-tag-item",children:[s,e.jsx("button",{type:"button",onClick:()=>ts(s),disabled:g,className:"hover:text-destructive","data-test":"fork-edit-tag-remove",children:e.jsx(be,{size:12})})]},s))})]}),e.jsxs("div",{"data-test":"fork-edit-actions",className:"flex justify-end gap-2",children:[e.jsx(p,{variant:"outline",onClick:_,disabled:g,"data-test":"fork-edit-cancel",children:"Cancel"}),e.jsx(p,{onClick:qe,disabled:g,"data-test":"fork-edit-submit",children:g?"Saving...":"Save"})]})]})})]})}export{_s as ForksPage};
