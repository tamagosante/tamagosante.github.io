import{r as n,j as t}from"./react-vendor-Byz07MLO.js";import{B as X}from"./Breadcrumbs-BjZV4SIv.js";import{s as m,C as v,b as N,c as b,e as w,L as o,I as S,a as i,d as G,aj as J,B as Q,a7 as W,l as Y,H as Z}from"./index-hTFRJyrx.js";import{T as I}from"./textarea-ZFIB_HyS.js";import{S as z,T as A,al as _,a2 as ee,am as te,an as se,ab as ae,X as re,C as le,e as ne}from"./icons-yhbeTEay.js";import"./radix-ui-9f16WUVy.js";import"./utils-G1l1U0hd.js";import"./ui-utils-BxIQ3qGg.js";function ce(){const[l,c]=n.useState(()=>{var e,a;return((a=(e=m.get("app"))==null?void 0:e.replacer)==null?void 0:a.rules)??[]}),[p,C]=n.useState(""),[u,k]=n.useState({}),[B,h]=n.useState({}),[x,j]=n.useState(()=>{var e,a;return((a=(e=m.get("app"))==null?void 0:e.replacer)==null?void 0:a.presets)??[]}),[g,$]=n.useState(""),y=n.useRef(null);n.useEffect(()=>{var s,r,d,E;const e=((r=(s=m.get("app"))==null?void 0:s.replacer)==null?void 0:r.rules)??[];e.length>0&&c(e);const a=((E=(d=m.get("app"))==null?void 0:d.replacer)==null?void 0:E.presets)??[];a.length>0&&j(a)},[]),n.useEffect(()=>{m.update("app",{replacer:{rules:l,presets:x}})},[l,x]);const F=(e,a)=>{if(!e)return{isValid:!0};try{const s=a?"g":"gi";return{isValid:!0,regex:new RegExp(e,s)}}catch(s){return{isValid:!1,error:s instanceof Error?s.message:"Invalid regex"}}},L=()=>{const e={id:Date.now().toString(),pattern:"",replacement:"",caseSensitive:!0,enabled:!0};c(a=>[...a,e])},O=e=>{c(a=>a.filter(s=>s.id!==e)),k(a=>{const s={...a};return delete s[e],s})},f=(e,a,s)=>{c(r=>r.map(d=>d.id===e?{...d,[a]:s}:d))},V=e=>{const a=l.find(r=>r.id===e);if(!a)return;const s={id:Date.now().toString(),pattern:a.pattern,replacement:a.replacement,caseSensitive:a.caseSensitive,enabled:a.enabled};c(r=>[...r,s])},H=e=>{c(a=>a.map(s=>s.id===e?{...s,pattern:s.replacement,replacement:s.pattern}:s))},T=()=>{if(!g.trim())return;const e={id:Date.now().toString(),name:g.trim(),rules:l,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};j(a=>[...a,e]),$("")},K=e=>{const a=x.find(s=>s.id===e);a&&c(a.rules)},q=e=>{j(a=>a.filter(s=>s.id!==e))},M=e=>{j(a=>a.map(s=>s.id===e?{...s,rules:l,updatedAt:new Date().toISOString()}:s))},R=n.useMemo(()=>{let e=p;const a={};for(const s of l){if(!s.enabled||!s.pattern)continue;const r=F(s.pattern,s.caseSensitive);if(!r.isValid){a[s.id]=r.error||"Invalid regex";continue}r.regex&&(e=e.replace(r.regex,s.replacement))}return k(a),e},[p,l]),U=async(e,a)=>{try{await navigator.clipboard.writeText(e),h(s=>({...s,[a]:"copied"})),setTimeout(()=>{h(s=>({...s,[a]:"idle"}))},2e3)}catch(s){console.error("Failed to copy:",s),h(r=>({...r,[a]:"error"})),setTimeout(()=>{h(r=>({...r,[a]:"idle"}))},2e3)}},P=({content:e,copyKey:a})=>{const s=B[a]||"idle";return t.jsx(i,{variant:"outline",size:"sm",onClick:()=>U(e,a),disabled:!e,className:"gap-2","data-test":"copy-button",children:s==="copied"?t.jsxs(t.Fragment,{children:[t.jsx(le,{className:"h-4 w-4 text-green-500"}),"Copied"]}):t.jsxs(t.Fragment,{children:[t.jsx(ne,{className:"h-4 w-4"}),"Copy"]})})},D=({onClear:e,disabled:a})=>t.jsxs(i,{variant:"outline",size:"sm",onClick:e,disabled:a,className:"gap-2 hover:bg-destructive hover:text-destructive-foreground hover:border-destructive","data-test":"clear-button",children:[t.jsx(re,{className:"h-4 w-4"}),"Clear"]});return t.jsx("div",{className:"p-6 w-full","data-test":"replacer",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs(v,{"data-test":"replacer-presets-card",children:[t.jsx(N,{className:"pb-3",children:t.jsx(b,{className:"text-lg","data-test":"replacer-presets-title",children:"Presets"})}),t.jsxs(w,{className:"space-y-3",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(o,{htmlFor:"preset-name-input",className:"text-xs font-medium",children:"Save Current Rules as Preset"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(S,{id:"preset-name-input",value:g,onChange:e=>$(e.target.value),placeholder:"Enter preset name...",className:"flex-1 h-8",onKeyPress:e=>{e.key==="Enter"&&T()},"data-test":"preset-name-input"}),t.jsxs(i,{onClick:T,disabled:!g.trim(),size:"sm",className:"gap-2","data-test":"save-preset-button",children:[t.jsx(z,{className:"h-4 w-4"}),"Save"]})]})]}),x.length>0&&t.jsxs("div",{className:"space-y-2 border-t pt-3",children:[t.jsx(o,{className:"text-xs font-medium block",children:"Loaded Presets"}),t.jsx("div",{className:"space-y-1 max-h-[200px] overflow-y-auto",children:x.map(e=>t.jsxs("div",{className:"flex items-center gap-1 bg-muted/50 border rounded px-2 py-1 text-xs","data-test":`preset-${e.id}`,children:[t.jsx("button",{onClick:()=>K(e.id),className:"flex-1 text-left hover:underline cursor-pointer truncate",title:"Load this preset","data-test":`load-preset-${e.id}`,children:e.name}),t.jsx(i,{variant:"ghost",size:"icon",onClick:()=>M(e.id),className:"h-5 w-5 flex-shrink-0",title:"Update preset with current rules","data-test":`update-preset-${e.id}`,children:t.jsx(z,{className:"h-3 w-3"})}),t.jsx(i,{variant:"ghost",size:"icon",onClick:()=>q(e.id),className:"h-5 w-5 flex-shrink-0",title:"Delete this preset","data-test":`delete-preset-${e.id}`,children:t.jsx(A,{className:"h-3 w-3"})})]},e.id))})]})]})]}),t.jsxs(v,{"data-test":"replacer-rules-card",children:[t.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[t.jsxs("div",{children:[t.jsxs(b,{className:"text-lg flex items-center gap-2","data-test":"replacer-rules-title",children:[t.jsx(_,{className:"h-4 w-4"}),"Replacement Rules"]}),t.jsx(G,{"data-test":"replacer-rules-description",children:"Define patterns and replacements. Rules are applied sequentially."})]}),t.jsxs(i,{variant:"outline",size:"sm",onClick:L,"data-test":"add-rule-button",className:"flex-shrink-0",children:[t.jsx(ee,{className:"h-4 w-4 mr-1"}),"Add Rule"]})]}),t.jsx(w,{children:t.jsx(J,{className:"h-[600px] rounded-md border","data-test":"rules-scroll-area",children:t.jsx("div",{className:"p-4 space-y-3",children:l.length===0?t.jsx("div",{className:"text-center py-8 text-muted-foreground","data-test":"rules-empty-state",children:t.jsx("p",{className:"text-sm",children:'No rules yet. Click "Add Rule" to create one.'})}):l.map((e,a)=>t.jsxs("div",{className:"border rounded-lg p-3 space-y-2","data-test":`rule-${e.id}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsxs(Q,{variant:"outline","data-test":`rule-badge-${e.id}`,children:["Rule ",a+1]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(W,{checked:e.enabled,onCheckedChange:s=>f(e.id,"enabled",s===!0),"data-test":`rule-enabled-${e.id}`}),t.jsx(o,{className:"text-xs cursor-pointer",children:"Enabled"})]}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Y,{checked:e.caseSensitive,onCheckedChange:s=>f(e.id,"caseSensitive",s),"data-test":`case-sensitive-${e.id}`}),t.jsx(o,{className:"text-xs cursor-pointer whitespace-nowrap",children:"Case sensitive"})]}),t.jsx(i,{variant:"ghost",size:"icon",onClick:()=>H(e.id),className:"h-7 w-7",title:"Swap pattern and replacement","data-test":`reverse-rule-${e.id}`,children:t.jsx(te,{className:"h-4 w-4"})}),t.jsx(i,{variant:"ghost",size:"icon",onClick:()=>V(e.id),className:"h-7 w-7",title:"Duplicate this rule","data-test":`duplicate-rule-${e.id}`,children:t.jsx(se,{className:"h-4 w-4"})}),t.jsx(i,{variant:"ghost",size:"icon",onClick:()=>O(e.id),className:"h-7 w-7",title:"Delete this rule","data-test":`remove-rule-${e.id}`,children:t.jsx(A,{className:"h-4 w-4"})})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(o,{htmlFor:`pattern-${e.id}`,className:"text-xs",children:"Pattern"}),t.jsxs("div",{className:"relative",children:[t.jsx(S,{id:`pattern-${e.id}`,value:e.pattern,onChange:s=>f(e.id,"pattern",s.target.value),placeholder:"Regex...",className:Z("font-mono text-sm",u[e.id]&&"border-destructive"),"data-test":`pattern-${e.id}`}),u[e.id]&&t.jsx(ae,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-destructive"})]}),u[e.id]&&t.jsx("p",{className:"text-xs text-destructive","data-test":`error-${e.id}`,children:u[e.id]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(o,{htmlFor:`replacement-${e.id}`,className:"text-xs",children:"Replacement"}),t.jsx(S,{id:`replacement-${e.id}`,value:e.replacement,onChange:s=>f(e.id,"replacement",s.target.value),placeholder:"Text...",className:"font-mono text-sm","data-test":`replacement-${e.id}`})]})]})]},e.id))})})})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(v,{"data-test":"replacer-input-card",children:[t.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(b,{className:"text-lg","data-test":"replacer-input-title",children:"Input Text"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(D,{onClear:()=>{var e;C(""),(e=y.current)==null||e.focus()},disabled:!p}),t.jsx(P,{content:p,copyKey:"replacer-input"})]})]}),t.jsx(w,{children:t.jsx(I,{ref:y,value:p,onChange:e=>C(e.target.value),placeholder:"Enter or paste text to process...",className:"h-[280px] font-mono text-sm","data-test":"replacer-input-textarea"})})]}),t.jsxs(v,{"data-test":"replacer-output-card",children:[t.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(b,{className:"text-lg","data-test":"replacer-output-title",children:"Output Text"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(D,{onClear:()=>{var e;C(""),(e=y.current)==null||e.focus()},disabled:!R}),t.jsx(P,{content:R,copyKey:"replacer-output"})]})]}),t.jsx(w,{children:t.jsx(I,{value:R,readOnly:!0,className:"h-[280px] font-mono text-sm bg-muted","data-test":"replacer-output-textarea"})})]})]})]})})}function je({logger:l}){const c=[{label:"Home",href:"/"},{label:"Demo",href:"/demo"},{label:"Replacer"}];return t.jsxs("div",{className:"replacer-demo-page flex-1 flex flex-col h-full","data-test":"replacer-demo-page",children:[t.jsx("div",{className:"page-header p-6 pb-0 flex-shrink-0","data-test":"page-header",children:t.jsx(X,{items:c})}),t.jsx("div",{className:"page-content flex-1 overflow-y-auto min-h-0","data-test":"page-content",children:t.jsx(ce,{})})]})}export{je as ReplacerDemoPage};
