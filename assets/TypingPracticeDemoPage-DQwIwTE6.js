import{r as o,j as e}from"./react-vendor-Byz07MLO.js";import{B as Ye}from"./Breadcrumbs-D-EeNrHD.js";import{r as Ge,l as He,d as Ue}from"./sciFiTheme-CwQKl2ZR.js";import{ad as Je,ae as Ze,a as q,af as Qe,ag as Xe,bb as et,e as tt,L as F,S as oe,h as ie,i as le,j as ce,k as de,R as rt,P as Ce,$ as we,Q as je,l as B,aY as st,aZ as nt,a_ as at,I as ot,ac as be,m as it,n as lt,o as ve,p as Ne}from"./index-BEUYSeX_.js";import{ae as ct,bn as dt,bk as ut,bj as mt,bo as gt,f as Se,g as Oe,as as ht,Y as pt,y as ft,C as xt,e as yt,b8 as bt,a1 as Ct,l as wt}from"./icons-Detj0uxE.js";import{u as jt,b as vt,a as Nt}from"./react-hooks-CNdHs55p.js";import"./radix-ui-B6r6BEmy.js";import"./utils-DjFvUtuq.js";import"./ui-utils-BxIQ3qGg.js";import"./DragDropManager-CacIWg_Z.js";const We=o.createContext(null),Le="app-theme-variant";function St(){try{const t=localStorage.getItem(Le);if(t&&["dark","light","red","default"].includes(t))return t}catch{}return"default"}function Ot(t){try{localStorage.setItem(Le,t)}catch{}}function Tt({children:t,initialTheme:r}){const[n,a]=o.useState(()=>r??St()),i=o.useMemo(()=>{switch(n){case"dark":return Ue;case"light":return He;case"red":return Ge;default:return null}},[n]),c=o.useCallback(d=>{a(d),Ot(d)},[]),f=n!=="default",g=o.useCallback(()=>{switch(n){case"dark":return"bg-slate-950";case"light":return"bg-slate-50";case"red":return"bg-red-950";default:return"bg-background"}},[n]);o.useEffect(()=>{const d=g();return document.body.classList.remove("bg-slate-950","bg-slate-50","bg-red-950","bg-background"),document.body.classList.add(d),()=>{document.body.classList.remove(d)}},[g]);const x=o.useMemo(()=>({variant:n,theme:i,setTheme:c,isSciFiTheme:f,getBackgroundClass:g}),[n,i,c,f,g]);return e.jsx(We.Provider,{value:x,children:t})}function Ae(){const t=o.useContext(We);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}const ue=[{value:"default",label:"Default",icon:e.jsx(dt,{className:"h-4 w-4"}),description:"Standard app theme"},{value:"dark",label:"SciFi Dark",icon:e.jsx(ut,{className:"h-4 w-4"}),description:"Cyan-centered sci-fi theme"},{value:"light",label:"SciFi Light",icon:e.jsx(mt,{className:"h-4 w-4"}),description:"Light sci-fi theme"},{value:"red",label:"SciFi Red",icon:e.jsx(gt,{className:"h-4 w-4"}),description:"Combat/alert theme"}];function kt({iconOnly:t=!0,className:r}){const{variant:n,setTheme:a,theme:i}=Ae(),c=ue.find(g=>g.value===n)??ue[0],f=()=>{if(!i)return;const{palette:g,variant:x}=i,d=x==="light";return{backgroundColor:"transparent",color:d?g.neutral[700]:g.neutral[300],borderColor:d?g.neutral[300]:g.neutral[600]}};return e.jsxs(Je,{children:[e.jsx(Ze,{asChild:!0,children:e.jsx(q,{variant:"outline",size:t?"icon":"default",className:r,title:"Select Theme",style:f(),"data-test":"theme-selector-button",children:t?e.jsx(ct,{className:"h-4 w-4"}):e.jsxs(e.Fragment,{children:[c.icon,e.jsx("span",{className:"ml-2",children:c.label})]})})}),e.jsx(Qe,{align:"start","data-test":"theme-selector-menu",children:ue.map(g=>e.jsxs(Xe,{onClick:()=>a(g.value),className:"flex items-center gap-2 cursor-pointer","data-test":"theme-selector-option",children:[g.icon,e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:g.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g.description})]}),n===g.value&&e.jsx("span",{className:"ml-auto text-primary","data-test":"theme-active-indicator",children:"✓"})]},g.value))})]})}const Fe=["ignore","oneOf","anyOrder","onlyThese","sequence"],R={lesson:"words",amount:5,length:5,repeat:1,autoEnter:!0,autoNew:!1,newWordsOnTrigger:!1,clearOnError:!1,clearLineOnFinish:!1,stopOnError:!0,hideInput:!0,autoSpace:!0,chunking:!1,collectOftenWrong:!0,ignore:[],anyOrder:[],oneOf:[],onlyThese:[],sequence:[],filterOrder:Fe},Et=5,Wt=6e4,H={calculateStats:t=>{const{targetText:r,typedText:n,startTime:a,currentTime:i}=t,c=H.getErrorIndices(r,n),f=n.length-c.length,g=n.length,x=i-a,d=H.calculateWpm(f,x),u=H.calculateAccuracy(f,g),v=n.length===r.length&&c.length===0;return{wpm:d,accuracy:u,errors:c,isComplete:v,correctChars:f,totalTypedChars:g}},getErrorIndices:(t,r)=>{const n=[],a=Math.min(t.length,r.length);for(let i=0;i<a;i++)t[i]!==r[i]&&n.push(i);return n},calculateWpm:(t,r)=>{if(r<=0)return 0;const n=r/Wt,a=t/Et;return Math.round(a/n)},calculateAccuracy:(t,r)=>r<=0?100:Math.round(t/r*100)},ye=["the","and","for","are","but","not","you","all","can","had","her","was","one","our","out","day","get","has","him","his","how","its","may","new","now","old","see","two","way","who","that","with","have","this","will","your","from","they","been","call","come","each","find","give","good","know","look","make","more","must","over","such","take","than","them","then","time","very","when","work","year","also","back","down","even","here","about","after","being","could","first","great","other","their","there","these","think","which","would","child","world","house","where","place","small","found","still","right","every","never","under","might","while","again","since","state","water","write","people","should","before","number","little","system","called","really","things","change","always","different","another","because","between","through","against","example","without","however","something","important","different","following","possible"],Re=["th","he","in","er","an","re","on","at","en","nd","ti","es","or","te","of","ed","is","it","al","ar","st","to","nt","ng","se","ha","as","ou","io","le","ve","co","me","de","hi","ri","ro","ic","ne","ea","ra","ce","li","ch","ll","be","ma","si","om","ur"],Ie=["e","t","a","o","i","n","s","h","r","d","l","c","u","m","w","f","g","y","p","b","v","k","j","x","q","z"],Lt=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],At=["h","j","k","l","w","b","e","0","$","w","W","b","B","e","E","ge","gE","0","^","$","g_","gg","G","H","M","L","zt","zz","zb","f","F","t","T",";",",","/","?","n","N","iw","aw","is","as","ip","ap","i(","a(","i{","a{","d","c","y","v","V","dw","cw","yw","dd","cc","yy","diw","ciw","yiw","daw","caw","yaw","di(","ci(","yi(","da(","ca(","ya("],De=["abc","def","ghi","jkl","mno","pqr","stu","vwx","yz","aei","bcd","fgh","jkm","nop","qrs","tuv","wxy","z","asdf","jkl;","qwer","uiop","zxcv","bnm,"],Pe=["am","an","as","at","go","in","is","it","me","no","on","or","so","to","age","ago","aim","air","ant","are","arm","art","ate","ear","eat","ego","era","gas","gem","get","got","grim","inn","ion","ire","its","man","mar","mat","men","met","net","nit","nor","not","oar","oat","one","ore","ram","ran","rat","rig","rim","rot","sat","sea","set","sin","sir","sit","son","tag","tan","tar","tea","ten","tie","tin","toe","ton","too","rig","ages","aims","airs","ants","area","arms","arts","earn","ears","east","eats","emit","eras","gain","gait","game","gate","gear","gems","germ","gets","gist","goat","goes","gone","gore","grim","grin","grit","into","ions","iron","item","main","mane","mans","mare","mars","mast","mate","mean","meat","meet","melt","memo","mens","mint","mire","miss","mist","moan","moat","more","most","name","near","neat","nest","nets","nine","none","norm","nose","note","oars","oats","omen","omit","ones","ores","rage","rain","rams","rang","rant","rare","rate","rats","ream","rear","rest","rigs","rims","ring","riot","rise","rite","roam","roar","roes","rose","rots","sage","same","sane","sang","sate","seam","sear","seas","seat","sent","sets","sign","sing","sins","sire","site","sits","slam","soar","some","song","sons","sore","sort","stag","star","stem","stir","tags","tame","tans","tars","team","tear","teas","teen","tens","term","ties","time","tins","tire","toes","tome","tone","tons","tore","torn","trim","tsar","agent","aging","agios","agree","aimer","airts","amens","amino","anise","antes","antis","aorta","areas","arenas","arise","armor","arose","asset","aster","earns","eater","emits","enema","enter","ester","gains","gaits","gamer","games","gases","gates","gears","genre","germs","giant","goats","goner","grain","grams","grant","grass","grate","great","greet","grins","grits","groan","groat","groom","image","inane","inert","inner","inter","irate","irons","items","mains","manes","manor","mares","masts","mates","means","meats","meets","merit","mints","miser","mists","miter","moans","moats","moist","moons","moors","moose","mores","morns","morse","names","nears","neats","nests","nines","noise","norms","noses","notes","oases","omens","omits","onset","orate","organ","otras","rages","rains","raise","range","rants","rates","reams","rears","reign","reins","remit","rents","rests","retro","rigid","rings","riots","risen","rises","rites","roams","roars","roast","roses","rotate","sages","saint","saner","satin","seams","sears","seats","semen","sense","serum","sites","smart","smear","soars","sonar","songs","sorer","sorts","stage","stain","stair","stamp","stare","stars","start","state","steam","steer","stems","stern","stirs","stomp","stone","store","storm","story","strain","strum","swamp","tamer","tames","teams","tears","teens","tenor","tense","terms","tiger","times","timer","tires","toast","tomes","toner","tones","torso","totes","train","trait","trans","treat","trees","tries","trims","tsars","agents","agrees","aimers","amount","angers","anoint","arenas","armies","armors","artist","assert","assent","asters","eaters","engine","enters","entire","esters","gaming","gators","genres","giants","goiter","grains","grange","grants","grapes","grates","greats","greets","groans","grooms","ignore","images","ingots","ingest","innate","inners","insert","insist","intern","irates","magnet","manger","manors","mantra","margin","marine","marten","master","matter","merits","minter","mirage","misers","mister","miters","moaner","moist","morass","mortar","mosaic","namers","nation","native","nester","noises","notate","noting","organs","orient","origin","ornate","ragout","raisin","ranges","ration","reason","regent","region","reigns","remits","renege","resign","resist","resort","retain","retina","rings","rising","roamer","roasts","rotate","rotors","saints","satire","season","seating","senior","sensor","sermon","singer","sinner","sister","smarts","smears","soaring","sonata","sorter","stains","stairs","stamen","stares","starts","states","steams","steers","sterns","stings","stooge","stores","storms","strain","stream","string","strong","tamers","taming","tangas","target","tenors","tensor","tigers","timers","tinges","tiring","toasts","toners","toting","trains","traits","treats","trimer","tsarina"],$e=["might"],Ft=[...ye,...Re,...Ie,...Lt,...De,...Pe],ze="typing-practice-often-wrong-words";function se(){try{const t=localStorage.getItem(ze);if(t)return JSON.parse(t)}catch{}return[]}function re(t){try{localStorage.setItem(ze,JSON.stringify(t))}catch{}}function Rt(){const[t,r]=o.useState(se);o.useEffect(()=>{r(se())},[]);const n=o.useCallback(c=>{const f=c.toLowerCase().trim();f&&r(g=>{if(g.includes(f))return g;const x=[...g,f];return re(x),x})},[]),a=o.useCallback(c=>{const f=c.toLowerCase().trim();r(g=>{const x=g.filter(d=>d!==f);return re(x),x})},[]),i=o.useCallback(()=>{r([]),re([])},[]);return{userWords:t,addWord:n,removeWord:a,clearWords:i}}function Me(){return se()}function It(t){const r=t.toLowerCase().trim();if(!r)return!1;const n=se();if(n.includes(r))return!1;const a=[...n,r];return re(a),!0}function Te(t){return function(){let r=t+=1831565813;return r=Math.imul(r^r>>>15,r|1),r^=r+Math.imul(r^r>>>7,r|61),((r^r>>>14)>>>0)/4294967296}}function _e(t,r){const n=[...t];for(let a=n.length-1;a>0;a--){const i=Math.floor(r()*(a+1));[n[a],n[i]]=[n[i],n[a]]}return n}function ke(t,r,n){return _e(t,n).slice(0,r)}function te(t){switch(t){case"words":return ye;case"homerow":return Pe;case"bigrams":return Re;case"alphabet":return De;case"letterFrequency":return Ie;case"vimMotions":return At;case"allWords":return Ft;case"oftenWrong":{const r=Me();return[...$e,...r]}default:return ye}}function Dt(t,r,n){return t.filter(a=>!(r!==void 0&&a.length<r||n!==void 0&&a.length>n))}function ee(t){return t?Array.isArray(t)?t:t.split(/[,\s]+/).filter(Boolean):[]}function ne(t){const r=[];for(const n of t)for(const a of n)a&&!r.includes(a.toLowerCase())&&r.push(a.toLowerCase());return r}function Pt(t,r){if(r.length===0)return!0;const n=t.toLowerCase();return ne(r).every(i=>n.includes(i))}function $t(t,r){if(r.length===0)return!0;const n=t.toLowerCase();return ne(r).some(i=>n.includes(i))}function zt(t,r){if(r.length===0)return!0;const n=t.toLowerCase(),a=new Set(ne(r));for(const i of n)if(!a.has(i))return!1;return!0}function Mt(t,r){if(r.length===0)return!0;const n=t.toLowerCase();return r.some(a=>n.includes(a.toLowerCase()))}function _t(t,r){if(r.length===0)return!1;const n=t.toLowerCase();return ne(r).some(i=>n.includes(i))}function me(t){return{lesson:t.lesson??R.lesson,amount:t.amount??R.amount,length:t.length??R.length,repeat:t.repeat??R.repeat,autoEnter:t.autoEnter??R.autoEnter,autoNew:t.autoNew??R.autoNew,newWordsOnTrigger:t.newWordsOnTrigger??R.newWordsOnTrigger,clearOnError:t.clearOnError??R.clearOnError,clearLineOnFinish:t.clearLineOnFinish??R.clearLineOnFinish,stopOnError:t.stopOnError??R.stopOnError,hideInput:t.hideInput??R.hideInput,autoSpace:t.autoSpace??R.autoSpace,chunking:t.chunking??R.chunking,collectOftenWrong:t.collectOftenWrong??R.collectOftenWrong,ignore:ee(t.ignore),anyOrder:ee(t.anyOrder),oneOf:ee(t.oneOf),onlyThese:ee(t.onlyThese),sequence:ee(t.sequence),filterOrder:t.filterOrder??Fe}}function Bt(t){return t==="letterFrequency"||t==="alphabet"||t==="bigrams"}function Kt(t,r,n){switch(r){case"ignore":return!_t(t,n.ignore);case"anyOrder":return Pt(t,n.anyOrder);case"oneOf":return $t(t,n.oneOf);case"onlyThese":return zt(t,n.onlyThese);case"sequence":return Mt(t,n.sequence);default:return!0}}function Ee(t,r){const n=Bt(r.lesson);return t.filter(a=>{if(r.length>0&&!n&&(a.length<r.length-2||a.length>r.length+2))return!1;for(const i of r.filterOrder)if(!Kt(a,i,r))return!1;return!0})}function qt(t,r){if(r<=1)return t;const n=[];for(const a of t)for(let i=0;i<r;i++)n.push(a);return n}const Q={generateLesson:(t,r)=>{const n=r??Date.now(),a=Te(n);let i=te(t.type);return t.type==="words"&&(i=Dt(i,t.minLength,t.maxLength)),ke(i,t.wordCount,a)},getNextLine:(t,r)=>Q.generateLesson(t,r).join(" "),getLessonTypes:()=>[{type:"words",label:"Common Words",description:"Practice with common English words"},{type:"homerow",label:"Homerow (arstgmneio)",description:"Words using only homerow keys"},{type:"bigrams",label:"Bigrams",description:"Two-letter combinations (th, he, in...)"},{type:"alphabet",label:"Alphabet Chunks",description:"Alphabet in random groupings"},{type:"letterFrequency",label:"Letter Frequency",description:"Letters ordered by frequency (e, t, a, o...)"},{type:"vimMotions",label:"Vim Motions",description:"Practice vim movement commands"},{type:"allWords",label:"All Words",description:"All word pools combined (words, homerow, bigrams, etc.)"},{type:"oftenWrong",label:"Often Wrong",description:"Words commonly mistyped"}],normalizeConfig:t=>me(t),generateFilteredLesson:(t,r)=>{const n=r??Date.now(),a=Te(n),i=me(t);let c=te(i.lesson);c=Ee(c,i),c.length===0&&(c=te(i.lesson));let f=ke(c,i.amount,a);return f=qt(f,i.repeat),i.repeat>1&&(f=_e(f,a)),f},getFilteredNextLine:(t,r)=>Q.generateFilteredLesson(t,r).join(" "),getFilteredPoolSize:t=>{const r=me(t),n=te(r.lesson);return Ee(n,r).length}},Be="typing-practice-config";function Vt(){try{const t=localStorage.getItem(Be);if(t)return JSON.parse(t)}catch{}return null}function ge(t){try{localStorage.setItem(Be,JSON.stringify(t))}catch{}}function Yt(t={}){const{initialLessonType:r="words",initialWordCount:n=5,initialConfig:a,onLineComplete:i}=t,[c,f]=o.useState(()=>{const m=Vt();return m||{...R,lesson:r,amount:n,...a}}),g=o.useCallback(m=>{f(m),ge(m)},[]),x=o.useMemo(()=>({type:c.lesson,wordCount:c.amount,minLength:c.length>0?c.length-2:void 0,maxLength:c.length>0?c.length+2:void 0}),[c.lesson,c.amount,c.length]),[d,u]=o.useState(""),[v,A]=o.useState(""),[$,w]=o.useState(!0),[N,s]=o.useState(null),[h,j]=o.useState(null),O=o.useRef(null),z=o.useRef(0),l=o.useRef(0),T=o.useRef(0),W=o.useRef(0),p=o.useRef(new Map),b=o.useMemo(()=>Q.getFilteredPoolSize(c),[c]),y=o.useCallback(()=>{if(O.current=null,z.current=0,l.current=0,c.chunking){const L={...c,amount:1,repeat:1},E=Q.getFilteredNextLine(L).trim(),D=`${E} ${E} ${E}`;u(D),A(""),s(null),j(null);return}const m=Q.getFilteredNextLine(c);u(m),A(""),s(null),j(null)},[c]),V=o.useCallback(()=>{y(),w(!0),O.current=null},[y]),_=o.useCallback(()=>{A(""),s(null),j(null),O.current=null,z.current=0,l.current=0,T.current=0,W.current=0,w(!1)},[]),S=o.useCallback(()=>{const m=z.current+l.current;return m>0?Math.round(z.current/m*100):100},[]),C=o.useCallback((m,L)=>{const E=m.split(" ");let D=0;for(const P of E){if(L<=D+P.length)return P;D+=P.length+1}return null},[]),k=o.useCallback(m=>{if(!c.collectOftenWrong)return;const E=(p.current.get(m)??0)+1;p.current.set(m,E),E>=3&&(It(m),p.current.set(m,0))},[c.collectOftenWrong]),I=o.useCallback(m=>{p.current.has(m)&&p.current.set(m,0)},[]),K=o.useCallback(m=>{O.current===null&&m.length>0&&(O.current=Date.now());const L=m.length>v.length;if(c.stopOnError&&L){const D=m.length-1,P=d[D],G=m[D];if(P!==G){l.current+=1,W.current+=1;const X=C(d,D);if(X&&k(X),c.chunking){if(A(""),j(null),z.current=0,l.current=0,O.current!==null){const ae=H.calculateStats({targetText:d,typedText:"",startTime:O.current,currentTime:Date.now()});s({...ae,accuracy:S()})}return}if(j(G),O.current!==null){const ae=H.calculateStats({targetText:d,typedText:v,startTime:O.current,currentTime:Date.now()});s({...ae,accuracy:S()})}return}else j(null),z.current+=1,T.current+=1}else if(L&&!c.stopOnError){const D=m.length-1,P=d[D],G=m[D];if(P===G)z.current+=1,T.current+=1;else{l.current+=1,W.current+=1;const X=C(d,D);X&&k(X)}}let E=m;if(c.autoSpace&&L&&d[m.length]===" "){E=m+" ",z.current+=1,T.current+=1;const P=C(d,m.length-1);P&&I(P)}if(A(E),O.current!==null){const P={...H.calculateStats({targetText:d,typedText:E,startTime:O.current,currentTime:Date.now()}),accuracy:S()};if(s(P),P.isComplete){const G=C(d,E.length-1);G&&I(G),i==null||i(P),y(),O.current=null}}},[d,v,c.stopOnError,c.autoSpace,c.chunking,i,y,S,C,k,I]),U=o.useCallback(m=>{if(m.ctrlKey||m.altKey||m.metaKey)return;if(m.key==="Backspace"){m.preventDefault(),v.length>0&&K(v.slice(0,-1)),j(null);return}if(m.key.length!==1&&m.key!==" ")return;if(c.autoSpace&&m.key===" "){m.preventDefault();return}m.preventDefault();const L=v+m.key;K(L)},[v,K,c.autoSpace]),J=o.useCallback(m=>{f(L=>{const E={...L,lesson:m};return ge(E),E})},[]),Z=o.useCallback(m=>{f(L=>{const E={...L,amount:m};return ge(E),E})},[]);return o.useEffect(()=>{if(!$||!O.current)return;const m=()=>{if(O.current&&v.length>0){const E=H.calculateStats({targetText:d,typedText:v,startTime:O.current,currentTime:Date.now()});s({...E,accuracy:S()})}};m();const L=setInterval(m,500);return()=>{clearInterval(L)}},[$,d,v,S]),o.useEffect(()=>{$&&y()},[x.type,x.wordCount,$]),{targetText:d,typedText:v,lessonConfig:x,filterConfig:c,isActive:$,currentResult:N,filteredPoolSize:b,errorChar:h,wordErrorCounts:p.current,handleInput:K,handleKeyDown:U,startSession:V,resetSession:_,setLessonType:J,setWordCount:Z,setFilterConfig:g,generateNewLine:y}}const Y={saveSession:(t,r)=>[...r,t],loadSessions:t=>{if(!t||t.trim()==="")return[];try{const r=JSON.parse(t);return Array.isArray(r)?r:[]}catch{return[]}},calculateAverageWpm:t=>{if(t.length===0)return 0;const r=t.reduce((n,a)=>n+a.wpm,0);return Math.round(r/t.length)},getErrorPatterns:t=>{const r={};for(const n of t)for(const[a,i]of Object.entries(n.errorPatterns))r[a]=(r[a]??0)+i;return r},serializeForStorage:t=>JSON.stringify(t),calculateAverageAccuracy:t=>{if(t.length===0)return 100;const r=t.reduce((n,a)=>n+a.accuracy,0);return Math.round(r/t.length)},getTotalWordsTyped:t=>t.reduce((r,n)=>r+n.wordsTyped,0),getRecentSessions:(t,r=10)=>[...t].sort((n,a)=>new Date(a.timestamp).getTime()-new Date(n.timestamp).getTime()).slice(0,r)},he="typing-practice-stats";function Gt(){const[t,r]=o.useState([]);o.useEffect(()=>{try{const d=localStorage.getItem(he),u=Y.loadSessions(d);r(u)}catch(d){console.error("Failed to load typing stats:",d),r([])}},[]),o.useEffect(()=>{try{const d=Y.serializeForStorage(t);localStorage.setItem(he,d)}catch(d){console.error("Failed to save typing stats:",d)}},[t]);const n=o.useCallback((d,u)=>{const v={id:`session-${Date.now()}`,timestamp:new Date().toISOString(),wpm:d.wpm,accuracy:d.accuracy,lessonType:u,wordsTyped:Math.ceil(d.correctChars/5),errorPatterns:{}};r(A=>Y.saveSession(v,A))},[]),a=o.useCallback(()=>{r([]);try{localStorage.removeItem(he)}catch(d){console.error("Failed to clear typing stats:",d)}},[]),i=Y.calculateAverageWpm(t),c=Y.calculateAverageAccuracy(t),f=Y.getTotalWordsTyped(t),g=Y.getErrorPatterns(t),x=Y.getRecentSessions(t,5);return{sessions:t,averageWpm:i,averageAccuracy:c,totalWordsTyped:f,errorPatterns:g,recentSessions:x,saveSession:n,clearHistory:a}}const Ht={ignore:{label:"Ignore",tooltip:"Exclude words containing ANY of these characters. E.g., 'ro' excludes words with r OR o.",placeholder:"e.g., ro (no r or o)"},oneOf:{label:"One Of",tooltip:"Word must contain at least one of these characters. E.g., 'aeiou' for words with vowels.",placeholder:"e.g., aeiou (vowels)"},anyOrder:{label:"Any Order",tooltip:"Word must contain ALL of these characters in any order. E.g., 'rs' requires both r AND s.",placeholder:"e.g., rs (both r AND s)"},onlyThese:{label:"Only These",tooltip:"Word must contain ONLY these letters, no others. E.g., 'arstg' for left homerow only.",placeholder:"e.g., arstg (left homerow)"},sequence:{label:"Sequence",tooltip:"Word must contain this exact sequence of characters. E.g., 'th' or 'ing'.",placeholder:"e.g., th, ing"}};function Ut({manager:t,filterType:r,index:n,dropZoneId:a,value:i,onChange:c,isDragging:f,draggedIndex:g}){const x=Nt(t,`${a}-${r}`,{index:n,dropZoneId:a,filterType:r}),d=Ht[r],u=f&&g===n;return e.jsxs("div",{ref:x,className:`space-y-2 p-2 rounded border border-transparent hover:border-border transition-colors ${u?"opacity-50":""}`,"data-test":`${r}-filter`,children:[e.jsxs(F,{htmlFor:r,className:"flex items-center gap-2",children:[e.jsx(pt,{size:14,className:"cursor-grab active:cursor-grabbing text-muted-foreground hover:text-foreground flex-shrink-0","data-test":`${r}-drag-handle`}),d.label,e.jsx(M,{content:d.tooltip})]}),e.jsx(ot,{id:r,placeholder:d.placeholder,value:i.join(", "),onChange:v=>c(v.target.value),className:"cursor-text","data-test":`${r}-input`})]})}function M({content:t}){return e.jsxs(st,{children:[e.jsx(nt,{asChild:!0,children:e.jsx("button",{type:"button",className:"p-0.5 rounded hover:bg-accent",onClick:r=>r.preventDefault(),"data-test":"info-tooltip-trigger",children:e.jsx(ht,{className:"h-3 w-3 text-muted-foreground"})})}),e.jsx(at,{side:"top","data-test":"info-tooltip-content",children:e.jsx("p",{className:"max-w-xs",children:t})})]})}function Jt({config:t,onChange:r,filteredPoolSize:n,isKeyboardOpen:a,onToggleKeyboard:i}){const[c,f]=o.useState(!0),[g,x]=o.useState(!0),[d,u]=o.useState(null),A=`filter-dropzone-${o.useId()}`,$=Q.getLessonTypes(),w=o.useCallback(l=>{r({...t,...l})},[r,t]),N=(l,T)=>{const W=T.split(/[,\s]+/).map(p=>p.trim()).filter(Boolean);w({[l]:W})},s=o.useCallback((l,T)=>{const W=[...t.filterOrder],[p]=W.splice(l,1);W.splice(T,0,p),w({filterOrder:W})},[t.filterOrder,w]),h=o.useCallback(l=>{var p;const T=(p=l.item.data)==null?void 0:p.index,W=l.sortIndex;if(T!==void 0&&W!==null&&T!==W){const b=T<W?W-1:W;s(T,b)}u(null)},[s]),{manager:j,state:O}=jt({sort:{enabled:!0,orientation:"vertical",threshold:.5},dragThreshold:5},{onDragStart:l=>{var T;u(((T=l.item.data)==null?void 0:T.index)??null)},onDragEnd:()=>{u(null)},onDrop:h}),z=vt(j,A);return e.jsx(et,{delayDuration:300,children:e.jsx("div",{"data-test":"configuration-panel",className:"mt-2",children:e.jsxs(tt,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4","data-test":"basic-settings",children:[e.jsxs("div",{className:"space-y-2","data-test":"lesson-type-setting",children:[e.jsx(F,{htmlFor:"lesson-type",children:"Lesson Type"}),e.jsxs(oe,{value:t.lesson,onValueChange:l=>w({lesson:l}),children:[e.jsx(ie,{id:"lesson-type","data-test":"lesson-type-trigger",children:e.jsx(le,{})}),e.jsx(ce,{children:$.map(l=>e.jsx(de,{value:l.type,children:l.label},l.type))})]})]}),e.jsxs("div",{className:"space-y-2","data-test":"word-count-setting",children:[e.jsx(F,{htmlFor:"amount",children:"Word Count"}),e.jsxs(oe,{value:String(t.amount),onValueChange:l=>w({amount:Number(l)}),children:[e.jsx(ie,{id:"amount","data-test":"word-count-trigger",children:e.jsx(le,{})}),e.jsx(ce,{children:[3,5,8,10,15,20].map(l=>e.jsx(de,{value:String(l),children:l},l))})]})]}),e.jsxs("div",{className:"space-y-2","data-test":"word-length-setting",children:[e.jsx(F,{htmlFor:"length",children:"Target Length"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rt,{id:"length",min:2,max:12,step:1,value:[t.length],onValueChange:([l])=>w({length:l}),className:"flex-1","data-test":"word-length-slider"}),e.jsx("span",{className:"w-8 text-center text-sm",children:t.length})]})]}),e.jsxs("div",{className:"space-y-2","data-test":"repeat-setting",children:[e.jsx(F,{htmlFor:"repeat",children:"Repeat Each"}),e.jsxs(oe,{value:String(t.repeat),onValueChange:l=>w({repeat:Number(l)}),children:[e.jsx(ie,{id:"repeat","data-test":"repeat-trigger",children:e.jsx(le,{})}),e.jsx(ce,{children:[1,2,3,4,5].map(l=>e.jsxs(de,{value:String(l),children:[l,"x"]},l))})]})]})]}),e.jsxs(Ce,{open:c,onOpenChange:f,children:[e.jsx(we,{asChild:!0,children:e.jsxs(q,{variant:"ghost",className:"w-full justify-between","data-test":"advanced-toggle",children:[e.jsx("span",{children:"Behavior Options"}),c?e.jsx(Se,{className:"h-4 w-4"}):e.jsx(Oe,{className:"h-4 w-4"})]})}),e.jsx(je,{className:"pt-4","data-test":"behavior-options",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between","data-test":"auto-enter-option",children:[e.jsxs(F,{htmlFor:"autoEnter",className:"flex items-center gap-2 cursor-pointer",children:["Auto Enter",e.jsx(M,{content:"Automatically advance to new line when finished typing correctly"})]}),e.jsx(B,{id:"autoEnter",checked:t.autoEnter,onCheckedChange:l=>w({autoEnter:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"auto-new-option",children:[e.jsxs(F,{htmlFor:"autoNew",className:"flex items-center gap-2 cursor-pointer",children:["Auto New",e.jsx(M,{content:"Automatically generate new words by clearing the old line"})]}),e.jsx(B,{id:"autoNew",checked:t.autoNew,onCheckedChange:l=>w({autoNew:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"trigger-option",children:[e.jsxs(F,{htmlFor:"newWordsOnTrigger",className:"flex items-center gap-2 cursor-pointer",children:['"." Trigger',e.jsx(M,{content:"Add new words when typing a period (.) character"})]}),e.jsx(B,{id:"newWordsOnTrigger",checked:t.newWordsOnTrigger,onCheckedChange:l=>w({newWordsOnTrigger:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"clear-error-option",children:[e.jsxs(F,{htmlFor:"clearOnError",className:"flex items-center gap-2 cursor-pointer",children:["Clear on Error",e.jsx(M,{content:"Clear the entire line when a typing error is made"})]}),e.jsx(B,{id:"clearOnError",checked:t.clearOnError,onCheckedChange:l=>w({clearOnError:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"clear-finish-option",children:[e.jsxs(F,{htmlFor:"clearLineOnFinish",className:"flex items-center gap-2 cursor-pointer",children:["Clear on Finish",e.jsx(M,{content:"Clear the line when finished (alternative to auto enter)"})]}),e.jsx(B,{id:"clearLineOnFinish",checked:t.clearLineOnFinish,onCheckedChange:l=>w({clearLineOnFinish:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"stop-error-option",children:[e.jsxs(F,{htmlFor:"stopOnError",className:"flex items-center gap-2 cursor-pointer",children:["Stop on Error",e.jsx(M,{content:"Don't record wrong characters - wait for correct key to be pressed"})]}),e.jsx(B,{id:"stopOnError",checked:t.stopOnError,onCheckedChange:l=>w({stopOnError:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"hide-input-option",children:[e.jsxs(F,{htmlFor:"hideInput",className:"flex items-center gap-2 cursor-pointer",children:["Hide Input",e.jsx(M,{content:"Hide the input field - keypresses are captured directly from keyboard events"})]}),e.jsx(B,{id:"hideInput",checked:t.hideInput,onCheckedChange:l=>w({hideInput:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"auto-space-option",children:[e.jsxs(F,{htmlFor:"autoSpace",className:"flex items-center gap-2 cursor-pointer",children:["Auto Space",e.jsx(M,{content:"Automatically insert space when word is complete - no need to type spaces between words"})]}),e.jsx(B,{id:"autoSpace",checked:t.autoSpace,onCheckedChange:l=>w({autoSpace:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"chunking-option",children:[e.jsxs(F,{htmlFor:"chunking",className:"flex items-center gap-2 cursor-pointer",children:["Chunking",e.jsx(M,{content:"Display 3 words vertically - on error, restart from first word"})]}),e.jsx(B,{id:"chunking",checked:t.chunking,onCheckedChange:l=>w({chunking:l})})]}),e.jsxs("div",{className:"flex items-center justify-between","data-test":"collect-often-wrong-option",children:[e.jsxs(F,{htmlFor:"collectOftenWrong",className:"flex items-center gap-2 cursor-pointer",children:["Collect Often Wrong",e.jsx(M,{content:"Auto-add words to 'Often Wrong' after 3 consecutive errors on the same word"})]}),e.jsx(B,{id:"collectOftenWrong",checked:t.collectOftenWrong,onCheckedChange:l=>w({collectOftenWrong:l})})]})]})})]}),e.jsxs(Ce,{open:g,onOpenChange:x,children:[e.jsx(we,{asChild:!0,children:e.jsxs(q,{variant:"ghost",className:"w-full justify-between","data-test":"filters-toggle",children:[e.jsx("span",{children:"Letter Filters (drag to reorder)"}),g?e.jsx(Se,{className:"h-4 w-4"}):e.jsx(Oe,{className:"h-4 w-4"})]})}),e.jsx(je,{className:"pt-4","data-test":"letter-filters",children:e.jsx("div",{ref:z,"data-drop-zone":A,className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:t.filterOrder.map((l,T)=>e.jsx(Ut,{manager:j,filterType:l,index:T,dropZoneId:A,value:t[l],onChange:W=>N(l,W),isDragging:O.isDragging,draggedIndex:d},l))})})]}),n!==void 0&&e.jsxs("div",{className:"pt-4 border-t text-center text-sm text-muted-foreground","data-test":"filtered-pool-size",children:[n," words available"]})]})})})}const Ke="typing-practice-config-popover",Zt={isOpen:!1,position:{x:50,y:50}};function Qt(){try{const t=localStorage.getItem(Ke);if(t)return JSON.parse(t)}catch{}return Zt}function pe(t){try{localStorage.setItem(Ke,JSON.stringify(t))}catch{}}function Xt({config:t,onChange:r,filteredPoolSize:n,isKeyboardOpen:a,onToggleKeyboard:i,theme:c}){const[f,g]=o.useState(Qt),[x,d]=o.useState(!1),u=o.useCallback(async()=>{const N=Me(),s=[...$e,...N],j=[...new Set(s)].map(O=>`"${O}"`).join(", ");try{await navigator.clipboard.writeText(j),d(!0),setTimeout(()=>d(!1),2e3)}catch{console.error("Failed to copy to clipboard")}},[]),v=()=>{if(!c)return;const{palette:N,variant:s}=c,h=s==="light";return f.isOpen?{backgroundColor:N.operational[500],color:h?N.neutral[50]:N.neutral[950],borderColor:N.operational[500]}:{backgroundColor:"transparent",color:h?N.neutral[700]:N.neutral[300],borderColor:h?N.neutral[300]:N.neutral[600]}},A=o.useCallback(()=>{g(N=>{const s={...N,isOpen:!N.isOpen};return pe(s),s})},[]),$=o.useCallback(()=>{g(N=>{const s={...N,isOpen:!1};return pe(s),s})},[]),w=o.useCallback(N=>{g(s=>{const h={...s,position:N};return pe(h),h})},[]);return e.jsxs(e.Fragment,{children:[e.jsx(q,{variant:f.isOpen?"secondary":"outline",size:"icon",onClick:A,title:"Configuration",style:v(),"data-test":"config-button",children:e.jsx(ft,{className:"h-4 w-4"})}),e.jsx(be,{isVisible:f.isOpen,onClose:$,title:"Configuration",initialPosition:f.position,initialSize:{width:420,height:600},resizable:!0,shouldCloseManually:!0,onPositionChange:w,className:"w-auto",headerActions:e.jsx(q,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:u,title:"Copy Often Wrong words to clipboard","data-test":"copy-often-wrong-button",children:x?e.jsx(xt,{className:"h-3 w-3 text-green-500"}):e.jsx(yt,{className:"h-3 w-3"})}),children:e.jsx("div",{className:"overflow-auto max-h-[calc(100vh-8rem)]","data-test":"config-popover-content",children:e.jsx(Jt,{config:t,onChange:r,filteredPoolSize:n,isKeyboardOpen:a,onToggleKeyboard:i})})})]})}const qe="typing-practice-stats-popover",er={isOpen:!1,position:{x:50,y:300}};function tr(){try{const t=localStorage.getItem(qe);if(t)return JSON.parse(t)}catch{}return er}function fe(t){try{localStorage.setItem(qe,JSON.stringify(t))}catch{}}function rr({sessions:t,recentSessions:r,averageWpm:n,averageAccuracy:a,totalWordsTyped:i,onClearHistory:c,theme:f,wordErrorCounts:g}){const[x,d]=o.useState(tr),[u,v]=o.useState("sessions"),A=()=>{if(!f)return;const{palette:s,variant:h}=f,j=h==="light";return x.isOpen?{backgroundColor:s.operational[500],color:j?s.neutral[50]:s.neutral[950],borderColor:s.operational[500]}:{backgroundColor:"transparent",color:j?s.neutral[700]:s.neutral[300],borderColor:j?s.neutral[300]:s.neutral[600]}},$=o.useCallback(()=>{d(s=>{const h={...s,isOpen:!s.isOpen};return fe(h),h})},[]),w=o.useCallback(()=>{d(s=>{const h={...s,isOpen:!1};return fe(h),h})},[]),N=o.useCallback(s=>{d(h=>{const j={...h,position:s};return fe(j),j})},[]);return e.jsxs(e.Fragment,{children:[e.jsx(q,{variant:x.isOpen?"secondary":"outline",size:"icon",onClick:$,title:"Statistics",style:A(),"data-test":"stats-button",children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx(be,{isVisible:x.isOpen,onClose:w,title:"Statistics",initialPosition:x.position,initialSize:{width:400,height:500},resizable:!0,shouldCloseManually:!0,onPositionChange:N,className:"w-auto",children:e.jsxs("div",{className:"p-3 space-y-3","data-test":"stats-popover-content",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2","data-test":"stats-grid",children:[e.jsxs("div",{className:"text-center p-2 bg-muted rounded","data-test":"avg-wpm-stat",children:[e.jsx("div",{className:"text-lg font-bold",children:n}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg WPM"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded","data-test":"avg-accuracy-stat",children:[e.jsxs("div",{className:"text-lg font-bold",children:[a,"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Accuracy"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded","data-test":"total-words-stat",children:[e.jsx("div",{className:"text-lg font-bold",children:i}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Words"})]}),e.jsxs("div",{className:"text-center p-2 bg-muted rounded","data-test":"sessions-stat",children:[e.jsx("div",{className:"text-lg font-bold",children:t.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Sessions"})]})]}),e.jsxs(it,{value:u,onValueChange:v,className:"w-full",children:[e.jsxs(lt,{className:"grid w-full grid-cols-2","data-test":"stats-tabs",children:[e.jsx(ve,{value:"sessions","data-test":"sessions-tab",children:"Sessions"}),e.jsx(ve,{value:"often-wrong","data-test":"often-wrong-tab",children:"Often Wrong"})]}),e.jsx(Ne,{value:"sessions",className:"mt-3","data-test":"sessions-tab-content",children:r.length>0?e.jsxs("div",{"data-test":"recent-sessions",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Recent Sessions"}),t.length>0&&e.jsx(q,{variant:"ghost",size:"sm",onClick:c,"data-test":"clear-history-button",children:"Clear"})]}),e.jsx("div",{className:"space-y-1.5 max-h-64 overflow-auto",children:r.map(s=>e.jsxs("div",{className:"flex justify-between text-sm p-2 bg-muted/50 rounded","data-test":`session-${s.id}`,children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:new Date(s.timestamp).toLocaleString()}),e.jsxs("span",{className:"text-xs",children:[s.wpm," WPM • ",s.accuracy,"%"]})]},s.id))})]}):e.jsx("div",{className:"text-center text-muted-foreground py-4 text-sm","data-test":"no-sessions",children:"No sessions yet. Start typing to track your progress!"})}),e.jsx(Ne,{value:"often-wrong",className:"mt-3","data-test":"often-wrong-tab-content",children:(()=>{const s=Array.from(g.entries()).map(([h,j])=>({word:h,count:j})).filter(({count:h})=>h>0).sort((h,j)=>j.count-h.count);return s.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-4 text-sm","data-test":"no-often-wrong",children:"No errors yet. Words with errors will appear here ranked by frequency."}):e.jsx("div",{className:"space-y-1.5 max-h-64 overflow-auto","data-test":"often-wrong-list",children:s.map(({word:h,count:j},O)=>e.jsxs("div",{className:"flex justify-between items-center text-sm p-2 bg-muted/50 rounded","data-test":`often-wrong-${h}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground w-4",children:[O+1,"."]}),e.jsx("span",{className:"font-mono",children:h})]}),e.jsx("span",{className:"text-xs text-orange-500 font-medium","data-test":`error-count-${h}`,children:j})]},h))})})()})]})]})})]})}const Ve="typing-practice-keyboard-layout",sr={isOpen:!1,position:{x:50,y:100}};function nr(){try{const t=localStorage.getItem(Ve);if(t)return JSON.parse(t)}catch{}return sr}function xe(t){try{localStorage.setItem(Ve,JSON.stringify(t))}catch{}}function ar({logger:t,theme:r}){const n=o.useRef(null),a=Gt(),i=Rt(),[c,f]=o.useState(null),[g,x]=o.useState(nr),d=o.useCallback(p=>{a.saveSession(p,u.lessonConfig.type),t==null||t.info(`Line completed! WPM: ${p.wpm}, Accuracy: ${p.accuracy}%`)},[a,t]),u=Yt({onLineComplete:d});o.useEffect(()=>{var p;u.isActive&&!u.filterConfig.hideInput&&((p=n.current)==null||p.focus())},[u.isActive,u.filterConfig.hideInput]),o.useEffect(()=>{if(!u.isActive||!u.filterConfig.hideInput)return;const p=b=>{const y=b.target;y.tagName==="INPUT"||y.tagName==="TEXTAREA"||y.tagName==="SELECT"||u.handleKeyDown(b)};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[u.isActive,u.filterConfig.hideInput,u.handleKeyDown]);const v=o.useCallback(()=>{x(p=>{const b={...p,isOpen:!p.isOpen};return xe(b),b})},[]),A=o.useCallback(()=>{x(p=>{const b={...p,isOpen:!1};return xe(b),b})},[]),$=o.useCallback(p=>{x(b=>{const y={...b,position:p};return xe(y),y})},[]),w=o.useCallback(p=>{i.addWord(p),f(p),setTimeout(()=>f(null),2e3),t==null||t.info(`Added "${p}" to Often Wrong list`)},[i,t]),N=()=>{const p=u.targetText.split(""),b=u.typedText,y=S=>{if(r){const C=r.palette,k=r.variant==="light",I={color:k?C.neutral[400]:C.neutral[500],backgroundColor:"transparent",borderBottomWidth:"2px",borderBottomStyle:"solid",borderBottomColor:"transparent",transition:"none"};return S<b.length?b[S]===p[S]?{className:"",style:{...I,color:k?C.success[600]:C.success[400]}}:{className:"",style:{...I,color:k?C.critical[600]:C.critical[400],backgroundColor:k?`${C.critical[200]}80`:`${C.critical[900]}4D`}}:S===b.length?u.errorChar?{className:"",style:{...I,color:k?C.critical[600]:C.critical[400],backgroundColor:k?`${C.critical[200]}80`:`${C.critical[900]}4D`,borderBottomColor:C.critical[500]}}:{className:"",style:{...I,color:k?C.neutral[700]:C.neutral[300],borderBottomColor:C.operational[500]}}:{className:"",style:I}}else return S<b.length?b[S]===p[S]?{className:"text-green-600 dark:text-green-400"}:{className:"text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30"}:S===b.length?u.errorChar?{className:"text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30 border-b-2 border-red-500"}:{className:"text-gray-600 dark:text-gray-300 border-b-2 border-blue-500"}:{className:"text-gray-400"}};if(u.filterConfig.chunking){const S=u.targetText.split(" ");let C=0;return e.jsx("div",{className:"font-mono text-2xl tracking-wide leading-relaxed space-y-2","data-test":"target-text",children:S.map((k,I)=>{const K=C;return C+=k.length+1,e.jsx("div",{"data-test":`word-${I}`,onClick:()=>w(k),className:"cursor-pointer hover:bg-primary/10 rounded px-1 -mx-1 transition-colors",title:`Click to add "${k}" to Often Wrong`,children:k.split("").map((U,J)=>{const Z=K+J,{className:m,style:L}=y(Z);return e.jsx("span",{className:m,style:L,"data-test":`char-${Z}`,children:U},J)})},I)})})}const V=u.targetText.split(" ");let _=0;return e.jsx("div",{className:"font-mono text-2xl tracking-wide leading-relaxed","data-test":"target-text",children:V.map((S,C)=>{const k=_;return _+=S.length+1,e.jsxs("span",{children:[e.jsx("span",{onClick:()=>w(S),className:"cursor-pointer hover:bg-primary/10 rounded transition-colors",title:`Click to add "${S}" to Often Wrong`,"data-test":`word-${C}`,children:S.split("").map((I,K)=>{const U=k+K,{className:J,style:Z}=y(U);return e.jsx("span",{className:J,style:Z,"data-test":`char-${U}`,children:I},K)})}),C<V.length-1&&e.jsx("span",{className:y(k+S.length).className,style:y(k+S.length).style,"data-test":`char-${k+S.length}`,children:" "})]},C)})})},s=r==null?void 0:r.palette,h=(r==null?void 0:r.variant)==="light",j="typing-practice-demo h-full flex flex-col relative transition-colors duration-300",O=s?{backgroundColor:h?`${s.neutral[100]}CC`:`${s.neutral[900]}80`,borderColor:`${s.operational[400]}33`}:void 0,z=s?{backgroundColor:h?`${s.neutral[50]}E6`:`${s.neutral[900]}B3`,borderColor:`${s.operational[400]}4D`,color:h?s.neutral[900]:s.neutral[100]}:void 0,l=s?{color:h?s.neutral[600]:s.neutral[400]}:void 0,T=p=>{if(s)return h?p?{backgroundColor:s.operational[500],color:s.neutral[50]}:{backgroundColor:`${s.neutral[200]}CC`,color:s.neutral[700]}:p?{backgroundColor:s.operational[500],color:s.neutral[950]}:{backgroundColor:`${s.neutral[800]}80`,color:s.neutral[300]}},W=p=>{if(s)return p?{backgroundColor:s.operational[500],color:h?s.neutral[50]:s.neutral[950],borderColor:s.operational[500]}:{backgroundColor:"transparent",color:h?s.neutral[700]:s.neutral[300],borderColor:h?s.neutral[300]:s.neutral[600]}};return e.jsxs("div",{className:j,"data-test":"typing-practice-demo",children:[e.jsxs("div",{className:"absolute top-0 left-0 flex gap-2 z-10","data-test":"top-controls",children:[e.jsx(kt,{}),e.jsx(q,{variant:g.isOpen?"secondary":"outline",size:"icon",onClick:v,title:"Keyboard Layout",style:W(g.isOpen),"data-test":"keyboard-button",children:e.jsx(Ct,{className:"h-4 w-4"})}),e.jsx(Xt,{config:u.filterConfig,onChange:u.setFilterConfig,filteredPoolSize:u.filteredPoolSize,isKeyboardOpen:g.isOpen,onToggleKeyboard:v,theme:r}),e.jsx(rr,{sessions:a.sessions,recentSessions:a.recentSessions,averageWpm:a.averageWpm,averageAccuracy:a.averageAccuracy,totalWordsTyped:a.totalWordsTyped,onClearHistory:a.clearHistory,theme:r,wordErrorCounts:u.wordErrorCounts})]}),e.jsx(be,{isVisible:g.isOpen,onClose:A,title:"Colemak Layout",initialPosition:g.position,initialSize:{width:520,height:220},resizable:!1,shouldCloseManually:!0,onPositionChange:$,className:"w-auto",children:e.jsx("div",{className:"p-4","data-test":"keyboard-layout",children:e.jsxs("div",{className:"flex gap-6 justify-center","data-test":"keyboard-halves",children:[e.jsxs("div",{className:"space-y-1.5","data-test":"left-hand",children:[e.jsx("div",{className:`text-sm text-center mb-2 ${s?"":"text-muted-foreground"}`,style:s?{color:h?s.neutral[600]:s.neutral[400]}:void 0,children:"Left"}),["qwfpb","arstg","zxcdv"].map((p,b)=>e.jsx("div",{className:"flex gap-1.5","data-test":`left-row-${b}`,children:p.split("").map(y=>{const _=u.typedText.slice(-1).toLowerCase()===y;return e.jsx("div",{className:`w-10 h-10 flex items-center justify-center rounded text-base font-mono uppercase transition-colors ${s?"":_?"bg-primary text-primary-foreground":"bg-muted"}`,style:T(_),"data-test":`key-${y}`,children:y},y)})},b))]}),e.jsx("div",{className:`w-px ${s?"":"bg-border"}`,style:s?{backgroundColor:h?s.neutral[300]:s.neutral[700]}:void 0,"data-test":"keyboard-divider"}),e.jsxs("div",{className:"space-y-1.5","data-test":"right-hand",children:[e.jsx("div",{className:`text-sm text-center mb-2 ${s?"":"text-muted-foreground"}`,style:s?{color:h?s.neutral[600]:s.neutral[400]}:void 0,children:"Right"}),["jluy;","mneio","kh,."].map((p,b)=>e.jsx("div",{className:"flex gap-1.5","data-test":`right-row-${b}`,children:p.split("").map(y=>{const _=u.typedText.slice(-1).toLowerCase()===y;return e.jsx("div",{className:`w-10 h-10 flex items-center justify-center rounded text-base font-mono uppercase transition-colors ${s?"":_?"bg-primary text-primary-foreground":"bg-muted"}`,style:T(_),"data-test":`key-${y}`,children:y},y)})},b))]})]})})}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8","data-test":"typing-container",children:e.jsx("div",{className:"w-full max-w-2xl space-y-4","data-test":"typing-area",children:u.isActive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`relative p-6 rounded-lg ${s?"":"bg-muted"} ${s?"border":""}`,style:O,"data-test":"target-display",children:[e.jsx(q,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:u.generateNewLine,title:"Generate new words","data-test":"reload-button",children:e.jsx(wt,{className:"h-4 w-4"})}),N(),c&&e.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 px-3 py-1 text-sm bg-green-600 text-white rounded-full animate-pulse","data-test":"word-added-notification",children:['Added "',c,'" to Often Wrong']})]}),!u.filterConfig.hideInput&&e.jsx("div",{className:"flex justify-center","data-test":"input-container",children:e.jsx("input",{ref:n,type:"text",value:u.typedText.split(" ").pop()||"",onChange:p=>{let b=p.target.value;u.filterConfig.autoSpace&&(b=b.replace(/ /g,""));const y=u.typedText.split(" ");y.pop();const V=y.length>0?y.join(" ")+" ":"";u.handleInput(V+b)},className:`w-1/2 p-4 text-xl font-mono border rounded-lg text-center focus:outline-none focus:ring-2 ${s?"focus:ring-cyan-500/50":"bg-background border-input focus:ring-blue-500"}`,style:z,placeholder:u.typedText.length===0?"Start typing...":void 0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-test":"typing-input"})}),u.currentResult&&e.jsxs("div",{className:`flex gap-6 text-sm justify-center ${s?"":"text-muted-foreground"}`,style:l,"data-test":"live-stats",children:[e.jsxs("span",{"data-test":"wpm-display",children:["WPM:"," ",e.jsx("strong",{className:s?"":"text-foreground",style:s?{color:h?s.operational[600]:s.operational[300]}:void 0,children:u.currentResult.wpm})]}),e.jsxs("span",{"data-test":"accuracy-display",children:["Accuracy:"," ",e.jsxs("strong",{className:s?"":"text-foreground",style:s?{color:h?s.success[600]:s.success[300]}:void 0,children:[u.currentResult.accuracy,"%"]})]}),e.jsxs("span",{"data-test":"errors-display",children:["Errors:"," ",e.jsx("strong",{className:s?"":"text-foreground",style:s?{color:u.currentResult.errors.length>0?h?s.critical[600]:s.critical[300]:h?s.neutral[600]:s.neutral[300]}:void 0,children:u.currentResult.errors.length})]})]})]}):null})})]})}function or({logger:t}){const{getBackgroundClass:r,theme:n}=Ae(),a=r(),i=[{label:"Home",href:"/"},{label:"Demo",href:"/demo"},{label:"Typing Practice"}];return e.jsxs("div",{className:`typing-practice-demo-page flex-1 flex flex-col h-full ${a} transition-colors duration-300`,"data-test":"typing-practice-demo-page",children:[e.jsx("div",{className:"page-header p-6 pb-0 flex-shrink-0","data-test":"page-header",children:e.jsx("div",{className:"breadcrumb-section mb-4","data-test":"breadcrumb-section",children:e.jsx(Ye,{items:i})})}),e.jsx("div",{className:"page-content flex-1 p-6 overflow-y-auto min-h-0","data-test":"page-content",children:e.jsx(ar,{logger:t,theme:n})})]})}function xr({logger:t}){return e.jsx(Tt,{children:e.jsx(or,{logger:t})})}export{xr as TypingPracticeDemoPage};
