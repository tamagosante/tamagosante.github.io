var Y=Object.defineProperty;var L=(x,e,s)=>e in x?Y(x,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):x[e]=s;var B=(x,e,s)=>L(x,typeof e!="symbol"?e+"":e,s);import{r as C,j as t}from"./react-vendor-Byz07MLO.js";import{B as P}from"./Breadcrumbs-BmC_qs_6.js";import{C as b,b as N,c as I,d as k,a as z,e as S,T as X,L as w,I as y}from"./index-DPqC4dt9.js";import{R as H,e as D}from"./icons-Ce2OFwrV.js";import"./radix-ui-CdiC0DQF.js";import"./utils-CsrmMPoT.js";import"./ui-utils-BxIQ3qGg.js";const F={scale:10,horizontalChar:"-",verticalChar:"|",cornerChar:"+",emptyChar:" ",showIds:!0,minBoxWidth:4,minBoxHeight:3,showAxes:!0,axisInterval:50};class M{constructor(e){B(this,"options");this.options={...F,...e}}convert(e){if(e.length===0)return"// No nodes to display";const s=this.calculateBounds(e),a=this.createGrid(s.width,s.height);for(const n of e)this.drawNode(a,n,s.minX,s.minY);return this.gridToString(a,{minX:s.minX,minY:s.minY})}convertSingle(e){const s=Math.max(this.options.minBoxWidth,Math.round((e.width??100)/this.options.scale)),a=Math.max(this.options.minBoxHeight,Math.round((e.height??50)/this.options.scale)),n=this.createGrid(s,a);return this.drawBox(n,0,0,s,a,e.id),this.gridToString(n)}calculateBounds(e){let s=1/0,a=1/0,n=-1/0,o=-1/0;for(const c of e){const i=c.width??100,p=c.height??50;s=Math.min(s,c.x),a=Math.min(a,c.y),n=Math.max(n,c.x+i),o=Math.max(o,c.y+p)}const l=this.options.scale,f=Math.ceil((n-s)/l)+2,m=Math.ceil((o-a)/l)+2;return{minX:s,minY:a,maxX:n,maxY:o,width:f,height:m}}createGrid(e,s){const a=[];for(let n=0;n<s;n++){a[n]=[];for(let o=0;o<e;o++)a[n][o]=this.options.emptyChar}return a}drawNode(e,s,a,n){const o=this.options.scale,l=s.width??100,f=s.height??50,m=Math.round((s.x-a)/o),c=Math.round((s.y-n)/o),i=Math.round((s.x+l-a)/o),p=Math.round((s.y+f-n)/o),d=Math.max(m+this.options.minBoxWidth-1,i),u=Math.max(c+this.options.minBoxHeight-1,p);this.drawBoxByCoords(e,m,c,d,u,s.id)}drawBox(e,s,a,n,o,l){this.drawBoxByCoords(e,s,a,s+n-1,a+o-1,l)}drawBoxByCoords(e,s,a,n,o,l){var j;const{horizontalChar:f,verticalChar:m,cornerChar:c}=this.options,i=e.length,p=((j=e[0])==null?void 0:j.length)??0,d=Math.max(0,s),u=Math.max(0,a),r=Math.min(p-1,n),v=Math.min(i-1,o);if(u>=0&&u<i){const h=this.options.showIds&&l?l:"",O=Math.min(h.length,r-d-1);for(let g=d;g<=r;g++){const A=g-d;A<O?e[u][g]=h[A]:g===d||g===r?e[u][g]=c:e[u][g]=f}}if(v>=0&&v<i)for(let h=d;h<=r;h++)h===d||h===r?e[v][h]=c:e[v][h]=f;for(let h=u+1;h<v;h++)h>=0&&h<i&&(d>=0&&d<p&&(e[h][d]=m),r>=0&&r<p&&(e[h][r]=m))}gridToString(e,s){var u;if(!this.options.showAxes||!s)return e.map(r=>r.join("")).join(`
`);const{scale:a,axisInterval:n}=this.options,o=((u=e[0])==null?void 0:u.length)??0,l=e.length,f=s.minY+l*a,m=Math.max(4,String(f).length+1),c=" ".repeat(m)+" ",i=[],p=new Array(o).fill(" "),d=new Array(o).fill(" ");for(let r=0;r<o;r++){const v=s.minX+r*a;if(v%n===0||r===0){d[r]="|";const j=String(v);for(let h=0;h<j.length&&r+h<o;h++)p[r+h]=j[h]}}i.push(c+p.join("")),i.push(c+d.join(""));for(let r=0;r<l;r++){const v=s.minY+r*a;let j="";v%n===0||r===0?j=String(v).padStart(m-1)+"-":j=" ".repeat(m-1)+" ",i.push(j+" "+e[r].join(""))}return i.join(`
`)}static fromJson(e,s){try{const a=JSON.parse(e),n=Array.isArray(a)?a:a.nodes??[a];return new M(s).convert(n)}catch(a){return`// Error: ${a instanceof Error?a.message:"Invalid JSON"}`}}}const T=`{
  "nodes": [
    {"id": "A", "x": 0, "y": 0, "width": 100, "height": 50},
    {"id": "B", "x": 150, "y": 0, "width": 80, "height": 50},
    {"id": "C", "x": 50, "y": 80, "width": 120, "height": 60}
  ]
}`,E={scale:10,horizontalChar:"-",verticalChar:"|",cornerChar:"+",showIds:!0,showAxes:!0,axisInterval:50};function q({logger:x}){const[e,s]=C.useState(T),[a,n]=C.useState(E),o=[{label:"Home",href:"/"},{label:"Demo",href:"/demo"},{label:"ASCII Preview"}],l=C.useMemo(()=>{try{return M.fromJson(e,a)}catch(i){return`// Error: ${i instanceof Error?i.message:"Unknown error"}`}},[e,a]),f=C.useCallback(()=>{navigator.clipboard.writeText(l),x==null||x.info("Copied ASCII output to clipboard")},[l,x]),m=C.useCallback(()=>{s(T),n(E),x==null||x.info("Reset to sample input")},[x]),c=C.useCallback((i,p)=>{n(d=>({...d,[i]:p}))},[]);return t.jsxs("div",{"data-test":"ascii-preview-demo-page",className:"ascii-preview-demo-page flex-1 flex flex-col h-full",children:[t.jsxs("div",{"data-test":"page-header",className:"page-header p-6 pb-0 flex-shrink-0",children:[t.jsx("div",{"data-test":"breadcrumb-section",className:"breadcrumb-section mb-4",children:t.jsx(P,{items:o})}),t.jsx("h1",{"data-test":"page-title",className:"text-3xl font-bold mb-2",children:"ASCII Preview"}),t.jsx("p",{"data-test":"page-description",className:"text-gray-600 mb-4",children:"Convert canvas node geometry (x, y, width, height) to ASCII art representation."})]}),t.jsxs("div",{"data-test":"page-content",className:"page-content flex-1 p-6 overflow-y-auto min-h-0",children:[t.jsxs("div",{"data-test":"main-row",className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[t.jsxs(b,{"data-test":"input-card",children:[t.jsx(N,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(I,{"data-test":"input-title",children:"Node Data (JSON)"}),t.jsx(k,{"data-test":"input-description",children:"Paste NodeDataV2 JSON with x, y, width, height properties"})]}),t.jsxs(z,{"data-test":"reset-button",variant:"outline",size:"sm",onClick:m,children:[t.jsx(H,{className:"h-4 w-4 mr-1"}),"Reset"]})]})}),t.jsx(S,{children:t.jsx(X,{"data-test":"input-textarea",value:e,onChange:i=>s(i.target.value),placeholder:"Paste your node JSON here...",className:"font-mono text-sm h-[400px] resize-none"})})]}),t.jsxs(b,{"data-test":"output-card",children:[t.jsx(N,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(I,{"data-test":"output-title",children:"ASCII Preview"}),t.jsx(k,{"data-test":"output-description",children:"Visual representation of node positions and sizes"})]}),t.jsxs(z,{"data-test":"copy-button",variant:"outline",size:"sm",onClick:f,children:[t.jsx(D,{className:"h-4 w-4 mr-1"}),"Copy"]})]})}),t.jsx(S,{children:t.jsx("pre",{"data-test":"output-preview",className:"font-mono text-sm h-[400px] overflow-auto bg-muted p-4 rounded-md whitespace-pre",children:l})})]})]}),t.jsxs(b,{"data-test":"options-card",children:[t.jsx(N,{children:t.jsx(I,{"data-test":"options-title",className:"text-base",children:"Converter Options"})}),t.jsxs(S,{children:[t.jsxs("div",{"data-test":"options-grid",className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[t.jsxs("div",{"data-test":"scale-option",children:[t.jsx(w,{htmlFor:"scale",children:"Scale (px/char)"}),t.jsx(y,{id:"scale","data-test":"scale-input",type:"number",min:1,max:100,value:a.scale??10,onChange:i=>c("scale",parseInt(i.target.value)||10),className:"font-mono"})]}),t.jsxs("div",{"data-test":"horizontal-char-option",children:[t.jsx(w,{htmlFor:"horizontal-char",children:"Horizontal"}),t.jsx(y,{id:"horizontal-char","data-test":"horizontal-char-input",maxLength:1,value:a.horizontalChar??"-",onChange:i=>c("horizontalChar",i.target.value||"-"),className:"font-mono text-center"})]}),t.jsxs("div",{"data-test":"vertical-char-option",children:[t.jsx(w,{htmlFor:"vertical-char",children:"Vertical"}),t.jsx(y,{id:"vertical-char","data-test":"vertical-char-input",maxLength:1,value:a.verticalChar??"|",onChange:i=>c("verticalChar",i.target.value||"|"),className:"font-mono text-center"})]}),t.jsxs("div",{"data-test":"corner-char-option",children:[t.jsx(w,{htmlFor:"corner-char",children:"Corner"}),t.jsx(y,{id:"corner-char","data-test":"corner-char-input",maxLength:1,value:a.cornerChar??"+",onChange:i=>c("cornerChar",i.target.value||"+"),className:"font-mono text-center"})]}),t.jsxs("div",{"data-test":"show-ids-option",className:"flex items-end gap-2",children:[t.jsx("input",{id:"show-ids","data-test":"show-ids-checkbox",type:"checkbox",checked:a.showIds??!0,onChange:i=>c("showIds",i.target.checked),className:"h-4 w-4"}),t.jsx(w,{htmlFor:"show-ids",className:"cursor-pointer",children:"Show IDs"})]}),t.jsxs("div",{"data-test":"show-axes-option",className:"flex items-end gap-2",children:[t.jsx("input",{id:"show-axes","data-test":"show-axes-checkbox",type:"checkbox",checked:a.showAxes??!0,onChange:i=>c("showAxes",i.target.checked),className:"h-4 w-4"}),t.jsx(w,{htmlFor:"show-axes",className:"cursor-pointer",children:"Show Axes"})]}),t.jsxs("div",{"data-test":"axis-interval-option",children:[t.jsx(w,{htmlFor:"axis-interval",children:"Axis Interval"}),t.jsx(y,{id:"axis-interval","data-test":"axis-interval-input",type:"number",min:10,max:500,value:a.axisInterval??50,onChange:i=>c("axisInterval",parseInt(i.target.value)||50),className:"font-mono"})]})]}),t.jsx("div",{"data-test":"reference-section",className:"mt-4 p-3 bg-muted rounded-lg",children:t.jsxs("p",{"data-test":"reference-text",className:"text-sm text-muted-foreground",children:[t.jsx("strong",{children:"NodeDataV2 geometry props:"})," id, x, y, width (default: 100), height (default: 50)"]})})]})]})]})]})}export{q as AsciiPreviewDemoPage};
