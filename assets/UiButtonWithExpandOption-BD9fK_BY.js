import{r as e,j as r}from"./react-vendor-Byz07MLO.js";import{V as u,a as q,ac as z}from"./index-BEUYSeX_.js";import{g as A,O as F,f as G,V as J}from"./icons-Detj0uxE.js";const K={left:J,up:G,right:F,down:A},Z=({children:C,expandContent:y,expandTitle:R,onClick:i,variant:j="outline",size:E="icon",popoverSize:b={width:320,height:400},resizable:P=!0,headerActions:N,className:k,disabled:o=!1,title:I,expandDirection:s="left",onHoldRepeat:c,holdRepeatInterval:m=300,dataTest:B})=>{const[v,f]=e.useState(!1),[O,S]=e.useState(null),U=e.useRef(null),p=e.useRef(null),n=e.useRef(null),d=e.useRef(!1);e.useEffect(()=>()=>{n.current&&clearInterval(n.current)},[]);const V=e.useCallback(()=>{!c||o||(d.current=!0,n.current=setInterval(()=>{d.current&&!o&&c()},m))},[c,m,o]),h=e.useCallback(()=>{d.current=!1,n.current&&(clearInterval(n.current),n.current=null)},[]),H=K[s],L=w=>{if(w.stopPropagation(),v){f(!1);return}if(p.current){const t=p.current.getBoundingClientRect(),{width:g,height:x}=b;let a,l;switch(s){case"up":a=t.left+t.width/2-g/2,l=t.top-x-8;break;case"down":a=t.left+t.width/2-g/2,l=t.bottom+8;break;case"right":a=t.right+8,l=t.top+t.height/2-x/2;break;case"left":default:a=t.left-g-8,l=t.top+t.height/2-x/2;break}S({x:a,y:l})}f(!0)},M=w=>{o||i==null||i()},T=()=>{switch(s){case"up":return"top-0 left-0 right-0 -translate-y-full flex-col";case"down":return"bottom-0 left-0 right-0 translate-y-full flex-col-reverse";case"right":return"right-0 top-0 bottom-0 translate-x-full flex-row-reverse";case"left":default:return"left-0 top-0 bottom-0 -translate-x-full flex-row"}},W=()=>{switch(s){case"up":return"py-1 rounded-t-md";case"down":return"py-1 rounded-b-md";case"right":return"px-1 rounded-r-md";case"left":default:return"px-1 rounded-l-md"}},_=()=>{switch(s){case"up":case"down":return"h-[3px] w-full";case"right":case"left":default:return"w-[3px] h-full"}};return r.jsxs("div",{ref:U,className:u("relative inline-flex group",k),"data-test":B??"ui-button-with-expand-container",children:[r.jsxs("div",{className:u("absolute flex items-stretch",T(),"opacity-0 group-hover:opacity-100 transition-opacity duration-150","pointer-events-none group-hover:pointer-events-auto"),"data-test":"ui-button-expand-trigger",children:[r.jsx("button",{type:"button",onClick:L,className:u("flex items-center justify-center",W(),"bg-foreground/5 hover:bg-foreground/10","transition-colors duration-150","cursor-pointer"),"aria-label":"Expand options",title:"Expand options","data-test":"ui-button-caret-button",children:r.jsx(H,{className:"h-3 w-3 text-foreground/60"})}),r.jsx("div",{className:u("bg-foreground/10",_()),"data-test":"ui-button-strip"})]}),r.jsx(q,{ref:p,variant:j,size:E,onClick:M,onPointerDown:V,onPointerUp:h,onPointerLeave:h,onPointerCancel:h,disabled:o,title:I,"data-test":"ui-button-with-expand-main",children:C}),r.jsx(z,{isVisible:v,onClose:()=>f(!1),title:R,triggerPosition:O??void 0,initialSize:b,resizable:P,shouldCloseManually:!0,headerActions:N,children:y})]})};export{Z as U};
