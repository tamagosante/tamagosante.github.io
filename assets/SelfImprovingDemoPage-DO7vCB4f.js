const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SpecView-zG6o8hbi.js","assets/react-vendor-CrhW4DYn.js","assets/index-CgyRe94A.js","assets/utils-DPdF7W5J.js","assets/radix-ui-BcQf1l4u.js","assets/ui-utils-BxIQ3qGg.js","assets/icons-6Gjq1X59.js","assets/index-BxdBf7Gf.css"])))=>i.map(i=>d[i]);
var re=Object.defineProperty;var ne=(s,t,e)=>t in s?re(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var V=(s,t,e)=>ne(s,typeof t!="symbol"?t+"":t,e);import{r as p,j as o,u as Ft,i as de}from"./react-vendor-CrhW4DYn.js";import{S as Mt,F as zt,a as Z,w as le,b as ce,h as Ut,c as rt,s as ue,d as Tt,e as he,f as ge,g as pe,T as Kt,i as me}from"./SpecView-zG6o8hbi.js";import{B as q,b3 as Yt,w as yt,q as Jt,M as fe,bv as we,bL as ut,y as xe,a8 as ve,z as ye,aN as Ht,aP as be,_ as ft,T as Bt,F as At,G as ot,H as it,bs as Wt,N as Vt,V as Te,bM as ke,bN as Ie,ag as Se,bz as Ce,bB as Ee,bC as $e,bD as De}from"./index-CgyRe94A.js";import"./utils-DPdF7W5J.js";import{b0 as je,a2 as Ne,X as pt,a1 as Be,b1 as Ae,D as Xt,aA as Fe,S as Me,aq as Pe,F as Re,O as Le}from"./icons-6Gjq1X59.js";import{L as Pt}from"./logging-3Ta40PMa.js";import"./radix-ui-BcQf1l4u.js";import"./ui-utils-BxIQ3qGg.js";class qe{constructor(){V(this,"todos",new Map);V(this,"currentFilter",{status:"all"});V(this,"currentDate",null)}addTodo(t){const e={id:this.generateId(),text:t.trim(),completed:!1,createdAt:Date.now(),tags:[]};return this.todos.set(e.id,e),e}addTag(t,e){const a=this.todos.get(t);if(!a)return!1;const i=e.trim();return i?(a.tags.includes(i)||a.tags.push(i),!0):!1}removeTag(t,e){const a=this.todos.get(t);if(!a)return!1;const i=a.tags.indexOf(e);return i===-1?!1:(a.tags.splice(i,1),!0)}getAllTags(){const t=new Set;for(const e of this.todos.values())for(const a of e.tags)t.add(a);return Array.from(t)}setPriority(t,e){const a=this.todos.get(t);return a?(a.priority=e,!0):!1}clearPriority(t){const e=this.todos.get(t);return e?(delete e.priority,!0):!1}getPriority(t){const e=this.todos.get(t);return e==null?void 0:e.priority}setDueDate(t,e){const a=this.todos.get(t);return a?(a.dueDate=e,!0):!1}removeDueDate(t){const e=this.todos.get(t);return e?(delete e.dueDate,!0):!1}getDueDate(t){const e=this.todos.get(t);return e==null?void 0:e.dueDate}setCurrentDate(t){this.currentDate=t}getCurrentDate(){return this.currentDate?this.currentDate:new Date().toISOString().split("T")[0]}toggleTodo(t){const e=this.todos.get(t);return e?(e.completed=!e.completed,e.completedAt=e.completed?Date.now():void 0,!0):!1}updateTodo(t,e){const a=this.todos.get(t);return a?(a.text=e.trim(),!0):!1}deleteTodo(t){return this.todos.delete(t)}clearCompleted(){let t=0;for(const[e,a]of this.todos.entries())a.completed&&(this.todos.delete(e),t++);return t}getTodo(t){return this.todos.get(t)||null}getAllTodos(){return Array.from(this.todos.values())}getFilteredTodos(){let t=this.getAllTodos();if(this.currentFilter.status==="active"?t=t.filter(e=>!e.completed):this.currentFilter.status==="completed"&&(t=t.filter(e=>e.completed)),this.currentFilter.searchText){const e=this.currentFilter.searchText.toLowerCase();t=t.filter(a=>a.text.toLowerCase().includes(e))}return this.currentFilter.tag&&(t=t.filter(e=>e.tags.includes(this.currentFilter.tag))),this.currentFilter.priority&&(t=t.filter(e=>e.priority===this.currentFilter.priority)),this.currentFilter.dueDate&&(t=this.filterByDueDate(t,this.currentFilter.dueDate)),t}filterByDueDate(t,e){const a=this.getCurrentDate();switch(e){case"today":return t.filter(i=>i.dueDate===a);case"overdue":return t.filter(i=>i.dueDate?i.dueDate<a:!1);case"this week":return t.filter(i=>{if(!i.dueDate)return!1;const r=this.getWeekEnd(a);return i.dueDate>=a&&i.dueDate<=r});case"none":return t.filter(i=>!i.dueDate);default:return t}}getWeekEnd(t){const e=new Date(t);return e.setDate(e.getDate()+6),e.toISOString().split("T")[0]}sortByPriority(t,e=!0){const a={high:3,medium:2,low:1};return[...t].sort((i,r)=>{const c=i.priority?a[i.priority]:0,u=r.priority?a[r.priority]:0;return e?u-c:c-u})}sortByDueDate(t,e=!0){return[...t].sort((a,i)=>{if(!a.dueDate&&!i.dueDate)return 0;if(!a.dueDate)return 1;if(!i.dueDate)return-1;const r=a.dueDate.localeCompare(i.dueDate);return e?r:-r})}setFilter(t){this.currentFilter={...this.currentFilter,...t}}getFilter(){return{...this.currentFilter}}getState(){const t=this.getAllTodos(),e=t.filter(a=>a.completed).length;return{todos:this.getFilteredTodos(),filter:this.getFilter(),stats:{total:t.length,active:t.length-e,completed:e}}}clearAll(){this.todos.clear(),this.currentFilter={status:"all"}}generateId(){return`todo-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}class Oe{constructor(){V(this,"service");V(this,"changeCallbacks",new Set);this.service=new qe}addTodo(t){if(!t.trim())throw new Error("Todo text cannot be empty");const e=this.service.addTodo(t);return this.notifyChange(),e}toggleTodo(t){const e=this.service.toggleTodo(t);return e&&this.notifyChange(),e}updateTodo(t,e){if(!e.trim())throw new Error("Todo text cannot be empty");const a=this.service.updateTodo(t,e);return a&&this.notifyChange(),a}deleteTodo(t){const e=this.service.deleteTodo(t);return e&&this.notifyChange(),e}addTag(t,e){const a=this.service.addTag(t,e);return a&&this.notifyChange(),a}removeTag(t,e){const a=this.service.removeTag(t,e);return a&&this.notifyChange(),a}getAllTags(){return this.service.getAllTags()}setPriority(t,e){const a=this.service.setPriority(t,e);return a&&this.notifyChange(),a}clearPriority(t){const e=this.service.clearPriority(t);return e&&this.notifyChange(),e}getPriority(t){return this.service.getPriority(t)}setDueDate(t,e){const a=this.service.setDueDate(t,e);return a&&this.notifyChange(),a}removeDueDate(t){const e=this.service.removeDueDate(t);return e&&this.notifyChange(),e}getDueDate(t){return this.service.getDueDate(t)}setCurrentDate(t){this.service.setCurrentDate(t)}clearCompleted(){const t=this.service.clearCompleted();return t>0&&this.notifyChange(),t}clearAll(){this.service.clearAll(),this.notifyChange()}getTodo(t){return this.service.getTodo(t)}getAllTodos(){return this.service.getAllTodos()}getFilteredTodos(){return this.service.getFilteredTodos()}getState(){return this.service.getState()}getStats(){return this.getState().stats}setFilter(t){this.service.setFilter(t),this.notifyChange()}getFilter(){return this.service.getFilter()}filterByStatus(t){this.setFilter({status:t})}search(t){this.setFilter({searchText:t})}filterByTag(t){this.setFilter({tag:t})}filterByPriority(t){this.setFilter({priority:t})}filterByDueDate(t){this.setFilter({dueDate:t})}sortByPriority(t=!0){const e=this.getFilteredTodos();return this.service.sortByPriority(e,t)}sortByDueDate(t=!0){const e=this.getFilteredTodos();return this.service.sortByDueDate(e,t)}onChange(t){return this.changeCallbacks.add(t),()=>{this.changeCallbacks.delete(t)}}dispose(){this.changeCallbacks.clear()}notifyChange(){const t=this.getState();this.changeCallbacks.forEach(e=>{try{e(t)}catch(a){console.error("Error in change callback:",a)}})}}let mt=null;const tt={register(s){mt=s},unregister(){mt=null},getActive(){if(!mt)throw new Error("No TodoFacade is currently registered. Make sure the component has initialized.");return mt},hasActive(){return mt!==null}};class _e{constructor(){V(this,"state");this.state={history:[],activeSuggestions:[],appliedImprovements:[],testFailures:[],metrics:{totalAnalyses:0,totalSuggestions:0,appliedSuggestions:0,successRate:0}}}analyzeCode(t){const e=this.performAnalysis(t),a=this.generateSuggestions(t,e),i={input:t,analysis:e,suggestions:a,metrics:this.calculateMetrics(t)};return this.state.history.push(i),this.state.activeSuggestions.push(...a),this.state.metrics.totalAnalyses++,this.state.metrics.totalSuggestions+=a.length,i}applySuggestion(t){const e=this.state.activeSuggestions.find(a=>a.id===t);return e?(e.status="applied",this.state.appliedImprovements.push(e),this.state.activeSuggestions=this.state.activeSuggestions.filter(a=>a.id!==t),this.state.metrics.appliedSuggestions++,this.updateSuccessRate(),!0):!1}rejectSuggestion(t){const e=this.state.activeSuggestions.find(a=>a.id===t);return e?(e.status="rejected",this.state.activeSuggestions=this.state.activeSuggestions.filter(a=>a.id!==t),!0):!1}getState(){return{...this.state}}clearHistory(){this.state.history=[],this.state.activeSuggestions=[]}captureTestFailure(t){const e={id:`test-failure-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),...t};return this.state.testFailures.push(e),e}getTestFailures(){return[...this.state.testFailures]}getLastFailure(){const t=this.state.testFailures;return t.length>0?t[t.length-1]:null}clearFailures(){this.state.testFailures=[]}performAnalysis(t){const e=t.split(`
`).length,a=t.length,i=/for|while|forEach|map|reduce/.test(t),r=/if|else|switch|case/.test(t),c=/async|await|Promise|then/.test(t);let u=`Code analysis complete:
`;return u+=`- Lines: ${e}
`,u+=`- Characters: ${a}
`,u+=`- Contains loops: ${i?"Yes":"No"}
`,u+=`- Contains conditionals: ${r?"Yes":"No"}
`,u+=`- Contains async code: ${c?"Yes":"No"}`,u}generateSuggestions(t,e){const a=[];return!t.includes(":")&&t.includes("function")&&a.push({id:`suggestion-${Date.now()}-1`,timestamp:Date.now(),type:"optimization",description:"Add TypeScript type annotations to improve type safety",confidence:85,status:"pending"}),t.split(`
`).length>20&&a.push({id:`suggestion-${Date.now()}-2`,timestamp:Date.now(),type:"refactor",description:"Consider extracting complex logic into smaller functions",confidence:70,status:"pending"}),!t.includes("try")&&t.includes("async")&&a.push({id:`suggestion-${Date.now()}-3`,timestamp:Date.now(),type:"bug-fix",description:"Add error handling for async operations",confidence:90,status:"pending"}),t.includes("let ")&&!t.includes("let i =")&&a.push({id:`suggestion-${Date.now()}-4`,timestamp:Date.now(),type:"optimization",description:"Consider using const instead of let for immutable variables",confidence:75,status:"pending"}),a}calculateMetrics(t){const e=t.split(`
`).length,a=Math.min(100,Math.max(0,100-e*2)),i=Math.floor(Math.random()*40)+60,r=Math.min(100,Math.max(0,100-t.length/50));return{complexity:a,performance:i,maintainability:r}}updateSuccessRate(){const t=this.state.metrics.totalSuggestions,e=this.state.metrics.appliedSuggestions;this.state.metrics.successRate=t>0?Math.round(e/t*100):0}}class Ue{constructor(t={}){V(this,"service");V(this,"stateChangeCallbacks",new Set);V(this,"analysisCallbacks",new Set);V(this,"testFailureCallbacks",new Set);V(this,"config");this.service=new _e,this.config={autoSave:t.autoSave??!1,maxHistory:t.maxHistory??50}}analyzeCode(t){if(!t.trim())throw new Error("Input cannot be empty");const e=this.service.analyzeCode(t);return this.notifyAnalysisCallbacks(e),this.notifyStateChange(),e}applySuggestion(t){const e=this.service.applySuggestion(t);return e&&this.notifyStateChange(),e}rejectSuggestion(t){const e=this.service.rejectSuggestion(t);return e&&this.notifyStateChange(),e}clearHistory(){this.service.clearHistory(),this.notifyStateChange()}getState(){return this.service.getState()}getActiveSuggestions(){return this.getState().activeSuggestions}getAppliedImprovements(){return this.getState().appliedImprovements}getHistory(){return this.getState().history}getLatestAnalysis(){const t=this.getHistory();return t.length>0?t[t.length-1]:null}getTestFailures(){return this.service.getTestFailures()}getLastFailure(){return this.service.getLastFailure()}clearFailures(){this.service.clearFailures(),this.notifyStateChange()}onStateChange(t){return this.stateChangeCallbacks.add(t),()=>{this.stateChangeCallbacks.delete(t)}}onAnalysis(t){return this.analysisCallbacks.add(t),()=>{this.analysisCallbacks.delete(t)}}onTestFailure(t){return this.testFailureCallbacks.add(t),()=>{this.testFailureCallbacks.delete(t)}}captureTestFailure(t){const e=typeof t.error=="string"?t.error:t.error.message,a=typeof t.error=="string"?void 0:t.error.stack,i=this.service.captureTestFailure({feature:t.feature,scenario:t.scenario,failedStep:t.failedStep,stepIndex:t.stepIndex,stepType:t.stepType,error:e,errorStack:a,facadeState:t.facadeState});return this.notifyTestFailureCallbacks(i),this.notifyStateChange(),i}getMetrics(){return this.getState().metrics}getSuccessRate(){return this.getMetrics().successRate}getTotalAnalyses(){return this.getMetrics().totalAnalyses}notifyStateChange(){const t=this.getState();this.stateChangeCallbacks.forEach(e=>{try{e(t)}catch(a){console.error("Error in state change callback:",a)}})}notifyAnalysisCallbacks(t){this.analysisCallbacks.forEach(e=>{try{e(t)}catch(a){console.error("Error in analysis callback:",a)}})}notifyTestFailureCallbacks(t){this.testFailureCallbacks.forEach(e=>{try{e(t)}catch(a){console.error("Error in test failure callback:",a)}})}dispose(){this.stateChangeCallbacks.clear(),this.analysisCallbacks.clear(),this.testFailureCallbacks.clear()}}function He({config:s,label:t="BDD Specs",variant:e="outline",size:a="sm",popoverTitle:i="ðŸ“‹ BDD Test Specifications",className:r,initialSize:c={width:600,height:700},onSizeChange:u,storageKey:f}){const[$,E]=p.useState(!1),[T,l]=p.useState(),x=h=>{const m=h.currentTarget.getBoundingClientRect();l({x:m.left,y:m.bottom+8}),E(!0)};return o.jsxs(o.Fragment,{children:[o.jsxs(q,{variant:e,size:a,onClick:x,className:r,"aria-label":"Open BDD specifications",children:[o.jsx(je,{className:"mr-2 h-4 w-4"}),t]}),o.jsx(Yt,{isVisible:$,onClose:()=>E(!1),title:i,triggerPosition:T,shouldCloseManually:!0,resizable:!0,initialSize:c,onSizeChange:u,children:o.jsx("div",{className:"spec-view-container flex-1 overflow-hidden",children:o.jsx(Mt,{config:s,storageKey:f})})})]})}const H={"I add tag {string} to todo {string}":"I add tag {string} to todo {string}","I am searching for {string}":"I am searching for {string}","I have added a todo with text {string}":"I have added a todo with text {string}","a todo facade":"a todo facade","the todo is completed":"the todo is completed","today is {string}":"today is {string}","todo {string} has due date {string}":"todo {string} has due date {string}","todo {string} has priority {string}":"todo {string} has priority {string}","todo {string} is completed":"todo {string} is completed"},b={"I add a todo with text {string}":"I add a todo with text {string}","I add tag {string} to todo {string}":"I add tag {string} to todo {string}","I clear all todos":"I clear all todos","I clear completed todos":"I clear completed todos","I clear priority from todo {string}":"I clear priority from todo {string}","I clear the search":"I clear the search","I delete the todo":"I delete the todo","I filter by due date {string}":"I filter by due date {string}","I filter by priority {string}":"I filter by priority {string}","I filter by status {string}":"I filter by status {string}","I filter by tag {string}":"I filter by tag {string}","I get all tags":"I get all tags","I remove due date from todo {string}":"I remove due date from todo {string}","I remove tag {string} from todo {string}":"I remove tag {string} from todo {string}","I search for {string}":"I search for {string}","I set due date {string} on todo {string}":"I set due date {string} on todo {string}","I set priority {string} on todo {string}":"I set priority {string} on todo {string}","I show only high priority todos":"I show only high priority todos","I sort todos by due date ascending":"I sort todos by due date ascending","I sort todos by priority descending":"I sort todos by priority descending","I toggle the todo":"I toggle the todo","I update the todo text to {string}":"I update the todo text to {string}"},y={"the active count should be {int}":"the active count should be {int}","the completed count should be {int}":"the completed count should be {int}","the filtered list should contain {int} todo":"the filtered list should contain {int} todo","the filtered list should contain {int} todos":"the filtered list should contain {int} todos","the filtered list should contain {string}":"the filtered list should contain {string}","the first todo should be {string}":"the first todo should be {string}","the second todo should be {string}":"the second todo should be {string}","the tag list should contain {string}":"the tag list should contain {string}","the tag list should have {int} unique tags":"the tag list should have {int} unique tags","the third todo should be {string}":"the third todo should be {string}","the todo list should contain {int} todo":"the todo list should contain {int} todo","the todo list should contain {int} todos":"the todo list should contain {int} todos","the todo should be completed":"the todo should be completed","the todo should have text {string}":"the todo should have text {string}","the todo should not be completed":"the todo should not be completed","the total count should be {int}":"the total count should be {int}","todo {string} should have due date {string}":"todo {string} should have due date {string}","todo {string} should have no due date":"todo {string} should have no due date","todo {string} should have no priority":"todo {string} should have no priority","todo {string} should have priority {string}":"todo {string} should have priority {string}","todo {string} should have tag {string}":"todo {string} should have tag {string}","todo {string} should not have tag {string}":"todo {string} should not have tag {string}"},wt=[{file:"/home/mine/dev/projects/2_typescript/nodejs/watcher-dir/watcher-v1/src/lib/modules/self-improving/__specifications__/features/todo-tags.feature",feature:"Todo Tags",description:"As a user I want to add tags to my todos So that I can organize and filter tasks by category",scenarios:[{scenario:"Add a single tag to a todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Buy groceries"',template:"I have added a todo with text {string}",params:{string0:"Buy groceries"}}],When:[{text:'I add tag "shopping" to todo "Buy groceries"',template:"I add tag {string} to todo {string}",params:{string0:"shopping",string1:"Buy groceries"}}],Then:[{text:'todo "Buy groceries" should have tag "shopping"',template:"todo {string} should have tag {string}",params:{string0:"Buy groceries",string1:"shopping"}}]},line:6},{scenario:"Add multiple tags to a todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Plan vacation"',template:"I have added a todo with text {string}",params:{string0:"Plan vacation"}}],When:[{text:'I add tag "personal" to todo "Plan vacation"',template:"I add tag {string} to todo {string}",params:{string0:"personal",string1:"Plan vacation"}},{text:'I add tag "important" to todo "Plan vacation"',template:"I add tag {string} to todo {string}",params:{string0:"important",string1:"Plan vacation"}}],Then:[{text:'todo "Plan vacation" should have tag "personal"',template:"todo {string} should have tag {string}",params:{string0:"Plan vacation",string1:"personal"}},{text:'todo "Plan vacation" should have tag "important"',template:"todo {string} should have tag {string}",params:{string0:"Plan vacation",string1:"important"}}]},line:12},{scenario:"Filter todos by tag",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Buy milk"',template:"I have added a todo with text {string}",params:{string0:"Buy milk"}},{text:'I have added a todo with text "Meeting with team"',template:"I have added a todo with text {string}",params:{string0:"Meeting with team"}},{text:'I have added a todo with text "Buy bread"',template:"I have added a todo with text {string}",params:{string0:"Buy bread"}},{text:'I add tag "shopping" to todo "Buy milk"',template:"I add tag {string} to todo {string}",params:{string0:"shopping",string1:"Buy milk"}},{text:'I add tag "work" to todo "Meeting with team"',template:"I add tag {string} to todo {string}",params:{string0:"work",string1:"Meeting with team"}},{text:'I add tag "shopping" to todo "Buy bread"',template:"I add tag {string} to todo {string}",params:{string0:"shopping",string1:"Buy bread"}}],When:[{text:'I filter by tag "shopping"',template:"I filter by tag {string}",params:{string0:"shopping"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Buy milk"',template:"the filtered list should contain {string}",params:{string0:"Buy milk"}},{text:'the filtered list should contain "Buy bread"',template:"the filtered list should contain {string}",params:{string0:"Buy bread"}}]},line:20},{scenario:"Remove tag from todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Organize files"',template:"I have added a todo with text {string}",params:{string0:"Organize files"}},{text:'I add tag "work" to todo "Organize files"',template:"I add tag {string} to todo {string}",params:{string0:"work",string1:"Organize files"}}],When:[{text:'I remove tag "work" from todo "Organize files"',template:"I remove tag {string} from todo {string}",params:{string0:"work",string1:"Organize files"}}],Then:[{text:'todo "Organize files" should not have tag "work"',template:"todo {string} should not have tag {string}",params:{string0:"Organize files",string1:"work"}}]},line:33},{scenario:"List all available tags",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task 1"',template:"I have added a todo with text {string}",params:{string0:"Task 1"}},{text:'I have added a todo with text "Task 2"',template:"I have added a todo with text {string}",params:{string0:"Task 2"}},{text:'I have added a todo with text "Task 3"',template:"I have added a todo with text {string}",params:{string0:"Task 3"}},{text:'I add tag "urgent" to todo "Task 1"',template:"I add tag {string} to todo {string}",params:{string0:"urgent",string1:"Task 1"}},{text:'I add tag "work" to todo "Task 2"',template:"I add tag {string} to todo {string}",params:{string0:"work",string1:"Task 2"}},{text:'I add tag "urgent" to todo "Task 3"',template:"I add tag {string} to todo {string}",params:{string0:"urgent",string1:"Task 3"}}],When:[{text:"I get all tags",template:"I get all tags"}],Then:[{text:'the tag list should contain "urgent"',template:"the tag list should contain {string}",params:{string0:"urgent"}},{text:'the tag list should contain "work"',template:"the tag list should contain {string}",params:{string0:"work"}},{text:"the tag list should have 2 unique tags",template:"the tag list should have {int} unique tags",params:{int0:2}}]},line:40}]},{file:"/home/mine/dev/projects/2_typescript/nodejs/watcher-dir/watcher-v1/src/lib/modules/self-improving/__specifications__/features/todo-priority.feature",feature:"Todo Priority",description:"As a user I want to assign priority levels to my todos So that I can focus on the most important tasks first",scenarios:[{scenario:"Set todo priority to high",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Critical bug fix"',template:"I have added a todo with text {string}",params:{string0:"Critical bug fix"}}],When:[{text:'I set priority "high" on todo "Critical bug fix"',template:"I set priority {string} on todo {string}",params:{string0:"high",string1:"Critical bug fix"}}],Then:[{text:'todo "Critical bug fix" should have priority "high"',template:"todo {string} should have priority {string}",params:{string0:"Critical bug fix",string1:"high"}}]},line:6},{scenario:"Set todo priority to medium",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Code review"',template:"I have added a todo with text {string}",params:{string0:"Code review"}}],When:[{text:'I set priority "medium" on todo "Code review"',template:"I set priority {string} on todo {string}",params:{string0:"medium",string1:"Code review"}}],Then:[{text:'todo "Code review" should have priority "medium"',template:"todo {string} should have priority {string}",params:{string0:"Code review",string1:"medium"}}]},line:12},{scenario:"Set todo priority to low",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Update docs"',template:"I have added a todo with text {string}",params:{string0:"Update docs"}}],When:[{text:'I set priority "low" on todo "Update docs"',template:"I set priority {string} on todo {string}",params:{string0:"low",string1:"Update docs"}}],Then:[{text:'todo "Update docs" should have priority "low"',template:"todo {string} should have priority {string}",params:{string0:"Update docs",string1:"low"}}]},line:18},{scenario:"Change todo priority",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Feature request"',template:"I have added a todo with text {string}",params:{string0:"Feature request"}},{text:'todo "Feature request" has priority "low"',template:"todo {string} has priority {string}",params:{string0:"Feature request",string1:"low"}}],When:[{text:'I set priority "high" on todo "Feature request"',template:"I set priority {string} on todo {string}",params:{string0:"high",string1:"Feature request"}}],Then:[{text:'todo "Feature request" should have priority "high"',template:"todo {string} should have priority {string}",params:{string0:"Feature request",string1:"high"}}]},line:24},{scenario:"Filter todos by high priority",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task 1"',template:"I have added a todo with text {string}",params:{string0:"Task 1"}},{text:'I have added a todo with text "Task 2"',template:"I have added a todo with text {string}",params:{string0:"Task 2"}},{text:'I have added a todo with text "Task 3"',template:"I have added a todo with text {string}",params:{string0:"Task 3"}},{text:'todo "Task 1" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Task 1",string1:"high"}},{text:'todo "Task 2" has priority "low"',template:"todo {string} has priority {string}",params:{string0:"Task 2",string1:"low"}},{text:'todo "Task 3" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Task 3",string1:"high"}}],When:[{text:'I filter by priority "high"',template:"I filter by priority {string}",params:{string0:"high"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Task 1"',template:"the filtered list should contain {string}",params:{string0:"Task 1"}},{text:'the filtered list should contain "Task 3"',template:"the filtered list should contain {string}",params:{string0:"Task 3"}}]},line:31},{scenario:"Filter todos by medium priority",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task A"',template:"I have added a todo with text {string}",params:{string0:"Task A"}},{text:'I have added a todo with text "Task B"',template:"I have added a todo with text {string}",params:{string0:"Task B"}},{text:'todo "Task A" has priority "medium"',template:"todo {string} has priority {string}",params:{string0:"Task A",string1:"medium"}},{text:'todo "Task B" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Task B",string1:"high"}}],When:[{text:'I filter by priority "medium"',template:"I filter by priority {string}",params:{string0:"medium"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:'the filtered list should contain "Task A"',template:"the filtered list should contain {string}",params:{string0:"Task A"}}]},line:44},{scenario:"Clear priority from todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Flexible task"',template:"I have added a todo with text {string}",params:{string0:"Flexible task"}},{text:'todo "Flexible task" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Flexible task",string1:"high"}}],When:[{text:'I clear priority from todo "Flexible task"',template:"I clear priority from todo {string}",params:{string0:"Flexible task"}}],Then:[{text:'todo "Flexible task" should have no priority',template:"todo {string} should have no priority",params:{string0:"Flexible task"}}]},line:54},{scenario:"Combine priority filter with status filter",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Active high"',template:"I have added a todo with text {string}",params:{string0:"Active high"}},{text:'I have added a todo with text "Completed high"',template:"I have added a todo with text {string}",params:{string0:"Completed high"}},{text:'I have added a todo with text "Active low"',template:"I have added a todo with text {string}",params:{string0:"Active low"}},{text:'todo "Active high" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Active high",string1:"high"}},{text:'todo "Completed high" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Completed high",string1:"high"}},{text:'todo "Active low" has priority "low"',template:"todo {string} has priority {string}",params:{string0:"Active low",string1:"low"}},{text:'todo "Completed high" is completed',template:"todo {string} is completed",params:{string0:"Completed high"}}],When:[{text:'I filter by priority "high"',template:"I filter by priority {string}",params:{string0:"high"}},{text:'I filter by status "active"',template:"I filter by status {string}",params:{string0:"active"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:'the filtered list should contain "Active high"',template:"the filtered list should contain {string}",params:{string0:"Active high"}}]},line:61},{scenario:"Sort todos by priority (high to low)",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Low priority task"',template:"I have added a todo with text {string}",params:{string0:"Low priority task"}},{text:'I have added a todo with text "High priority task"',template:"I have added a todo with text {string}",params:{string0:"High priority task"}},{text:'I have added a todo with text "Medium priority task"',template:"I have added a todo with text {string}",params:{string0:"Medium priority task"}},{text:'todo "Low priority task" has priority "low"',template:"todo {string} has priority {string}",params:{string0:"Low priority task",string1:"low"}},{text:'todo "High priority task" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"High priority task",string1:"high"}},{text:'todo "Medium priority task" has priority "medium"',template:"todo {string} has priority {string}",params:{string0:"Medium priority task",string1:"medium"}}],When:[{text:"I sort todos by priority descending",template:"I sort todos by priority descending"}],Then:[{text:'the first todo should be "High priority task"',template:"the first todo should be {string}",params:{string0:"High priority task"}},{text:'the second todo should be "Medium priority task"',template:"the second todo should be {string}",params:{string0:"Medium priority task"}},{text:'the third todo should be "Low priority task"',template:"the third todo should be {string}",params:{string0:"Low priority task"}}]},line:75},{scenario:"Show only high priority todos",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Important"',template:"I have added a todo with text {string}",params:{string0:"Important"}},{text:'I have added a todo with text "Not important"',template:"I have added a todo with text {string}",params:{string0:"Not important"}},{text:'I have added a todo with text "Very important"',template:"I have added a todo with text {string}",params:{string0:"Very important"}},{text:'todo "Important" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Important",string1:"high"}},{text:'todo "Very important" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"Very important",string1:"high"}}],When:[{text:"I show only high priority todos",template:"I show only high priority todos"}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Important"',template:"the filtered list should contain {string}",params:{string0:"Important"}},{text:'the filtered list should contain "Very important"',template:"the filtered list should contain {string}",params:{string0:"Very important"}}]},line:88}]},{file:"/home/mine/dev/projects/2_typescript/nodejs/watcher-dir/watcher-v1/src/lib/modules/self-improving/__specifications__/features/todo-filtering.feature",feature:"Todo Filtering",description:"As a user I want to filter my todos So that I can focus on specific tasks",scenarios:[{scenario:"Filter by active status",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Active 1"',template:"I have added a todo with text {string}",params:{string0:"Active 1"}},{text:'I have added a todo with text "Completed 1"',template:"I have added a todo with text {string}",params:{string0:"Completed 1"}},{text:'I have added a todo with text "Active 2"',template:"I have added a todo with text {string}",params:{string0:"Active 2"}},{text:'todo "Completed 1" is completed',template:"todo {string} is completed",params:{string0:"Completed 1"}}],When:[{text:'I filter by status "active"',template:"I filter by status {string}",params:{string0:"active"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Active 1"',template:"the filtered list should contain {string}",params:{string0:"Active 1"}},{text:'the filtered list should contain "Active 2"',template:"the filtered list should contain {string}",params:{string0:"Active 2"}}]},line:6},{scenario:"Filter by completed status",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Active 1"',template:"I have added a todo with text {string}",params:{string0:"Active 1"}},{text:'I have added a todo with text "Completed 1"',template:"I have added a todo with text {string}",params:{string0:"Completed 1"}},{text:'I have added a todo with text "Completed 2"',template:"I have added a todo with text {string}",params:{string0:"Completed 2"}},{text:'todo "Completed 1" is completed',template:"todo {string} is completed",params:{string0:"Completed 1"}},{text:'todo "Completed 2" is completed',template:"todo {string} is completed",params:{string0:"Completed 2"}}],When:[{text:'I filter by status "completed"',template:"I filter by status {string}",params:{string0:"completed"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Completed 1"',template:"the filtered list should contain {string}",params:{string0:"Completed 1"}},{text:'the filtered list should contain "Completed 2"',template:"the filtered list should contain {string}",params:{string0:"Completed 2"}}]},line:17},{scenario:"Show all todos",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Active 1"',template:"I have added a todo with text {string}",params:{string0:"Active 1"}},{text:'I have added a todo with text "Completed 1"',template:"I have added a todo with text {string}",params:{string0:"Completed 1"}},{text:'todo "Completed 1" is completed',template:"todo {string} is completed",params:{string0:"Completed 1"}}],When:[{text:'I filter by status "all"',template:"I filter by status {string}",params:{string0:"all"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}}]},line:29},{scenario:"Search todos by text",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Buy milk"',template:"I have added a todo with text {string}",params:{string0:"Buy milk"}},{text:'I have added a todo with text "Buy bread"',template:"I have added a todo with text {string}",params:{string0:"Buy bread"}},{text:'I have added a todo with text "Clean house"',template:"I have added a todo with text {string}",params:{string0:"Clean house"}}],When:[{text:'I search for "Buy"',template:"I search for {string}",params:{string0:"Buy"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Buy milk"',template:"the filtered list should contain {string}",params:{string0:"Buy milk"}},{text:'the filtered list should contain "Buy bread"',template:"the filtered list should contain {string}",params:{string0:"Buy bread"}}]},line:37},{scenario:"Search with no matches",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task 1"',template:"I have added a todo with text {string}",params:{string0:"Task 1"}},{text:'I have added a todo with text "Task 2"',template:"I have added a todo with text {string}",params:{string0:"Task 2"}}],When:[{text:'I search for "NonExistent"',template:"I search for {string}",params:{string0:"NonExistent"}}],Then:[{text:"the filtered list should contain 0 todos",template:"the filtered list should contain {int} todos",params:{int0:0}}]},line:47},{scenario:"Combine status filter and search",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Buy milk"',template:"I have added a todo with text {string}",params:{string0:"Buy milk"}},{text:'I have added a todo with text "Buy bread"',template:"I have added a todo with text {string}",params:{string0:"Buy bread"}},{text:'I have added a todo with text "Clean house"',template:"I have added a todo with text {string}",params:{string0:"Clean house"}},{text:'todo "Buy milk" is completed',template:"todo {string} is completed",params:{string0:"Buy milk"}}],When:[{text:'I filter by status "active"',template:"I filter by status {string}",params:{string0:"active"}},{text:'I search for "Buy"',template:"I search for {string}",params:{string0:"Buy"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:'the filtered list should contain "Buy bread"',template:"the filtered list should contain {string}",params:{string0:"Buy bread"}}]},line:54},{scenario:"Clear search filter",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task 1"',template:"I have added a todo with text {string}",params:{string0:"Task 1"}},{text:'I have added a todo with text "Task 2"',template:"I have added a todo with text {string}",params:{string0:"Task 2"}},{text:'I am searching for "Task 1"',template:"I am searching for {string}",params:{string0:"Task 1"}}],When:[{text:"I clear the search",template:"I clear the search"}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}}]},line:65}]},{file:"/home/mine/dev/projects/2_typescript/nodejs/watcher-dir/watcher-v1/src/lib/modules/self-improving/__specifications__/features/todo-due-dates.feature",feature:"Todo Due Dates",description:"As a user I want to set due dates on my todos So that I can track time-sensitive tasks",scenarios:[{scenario:"Set due date on a todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Submit report"',template:"I have added a todo with text {string}",params:{string0:"Submit report"}}],When:[{text:'I set due date "2024-12-31" on todo "Submit report"',template:"I set due date {string} on todo {string}",params:{string0:"2024-12-31",string1:"Submit report"}}],Then:[{text:'todo "Submit report" should have due date "2024-12-31"',template:"todo {string} should have due date {string}",params:{string0:"Submit report",string1:"2024-12-31"}}]},line:6},{scenario:"Update todo due date",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Project deadline"',template:"I have added a todo with text {string}",params:{string0:"Project deadline"}},{text:'todo "Project deadline" has due date "2024-12-15"',template:"todo {string} has due date {string}",params:{string0:"Project deadline",string1:"2024-12-15"}}],When:[{text:'I set due date "2024-12-20" on todo "Project deadline"',template:"I set due date {string} on todo {string}",params:{string0:"2024-12-20",string1:"Project deadline"}}],Then:[{text:'todo "Project deadline" should have due date "2024-12-20"',template:"todo {string} should have due date {string}",params:{string0:"Project deadline",string1:"2024-12-20"}}]},line:12},{scenario:"Remove due date from todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Flexible deadline"',template:"I have added a todo with text {string}",params:{string0:"Flexible deadline"}},{text:'todo "Flexible deadline" has due date "2024-12-10"',template:"todo {string} has due date {string}",params:{string0:"Flexible deadline",string1:"2024-12-10"}}],When:[{text:'I remove due date from todo "Flexible deadline"',template:"I remove due date from todo {string}",params:{string0:"Flexible deadline"}}],Then:[{text:'todo "Flexible deadline" should have no due date',template:"todo {string} should have no due date",params:{string0:"Flexible deadline"}}]},line:19},{scenario:"Filter todos due today",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'today is "2024-12-15"',template:"today is {string}",params:{string0:"2024-12-15"}},{text:`I have added a todo with text "Today's task"`,template:"I have added a todo with text {string}",params:{string0:"Today's task"}},{text:`I have added a todo with text "Tomorrow's task"`,template:"I have added a todo with text {string}",params:{string0:"Tomorrow's task"}},{text:`I have added a todo with text "Yesterday's task"`,template:"I have added a todo with text {string}",params:{string0:"Yesterday's task"}},{text:`todo "Today's task" has due date "2024-12-15"`,template:"todo {string} has due date {string}",params:{string0:"Today's task",string1:"2024-12-15"}},{text:`todo "Tomorrow's task" has due date "2024-12-16"`,template:"todo {string} has due date {string}",params:{string0:"Tomorrow's task",string1:"2024-12-16"}},{text:`todo "Yesterday's task" has due date "2024-12-14"`,template:"todo {string} has due date {string}",params:{string0:"Yesterday's task",string1:"2024-12-14"}}],When:[{text:'I filter by due date "today"',template:"I filter by due date {string}",params:{string0:"today"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:`the filtered list should contain "Today's task"`,template:"the filtered list should contain {string}",params:{string0:"Today's task"}}]},line:26},{scenario:"Filter overdue todos",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'today is "2024-12-15"',template:"today is {string}",params:{string0:"2024-12-15"}},{text:'I have added a todo with text "Overdue task 1"',template:"I have added a todo with text {string}",params:{string0:"Overdue task 1"}},{text:'I have added a todo with text "Current task"',template:"I have added a todo with text {string}",params:{string0:"Current task"}},{text:'I have added a todo with text "Overdue task 2"',template:"I have added a todo with text {string}",params:{string0:"Overdue task 2"}},{text:'todo "Overdue task 1" has due date "2024-12-10"',template:"todo {string} has due date {string}",params:{string0:"Overdue task 1",string1:"2024-12-10"}},{text:'todo "Current task" has due date "2024-12-15"',template:"todo {string} has due date {string}",params:{string0:"Current task",string1:"2024-12-15"}},{text:'todo "Overdue task 2" has due date "2024-12-12"',template:"todo {string} has due date {string}",params:{string0:"Overdue task 2",string1:"2024-12-12"}}],When:[{text:'I filter by due date "overdue"',template:"I filter by due date {string}",params:{string0:"overdue"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "Overdue task 1"',template:"the filtered list should contain {string}",params:{string0:"Overdue task 1"}},{text:'the filtered list should contain "Overdue task 2"',template:"the filtered list should contain {string}",params:{string0:"Overdue task 2"}}]},line:39},{scenario:"Filter todos due this week",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'today is "2024-12-15"',template:"today is {string}",params:{string0:"2024-12-15"}},{text:'I have added a todo with text "This week task"',template:"I have added a todo with text {string}",params:{string0:"This week task"}},{text:'I have added a todo with text "Next week task"',template:"I have added a todo with text {string}",params:{string0:"Next week task"}},{text:'I have added a todo with text "Last week task"',template:"I have added a todo with text {string}",params:{string0:"Last week task"}},{text:'todo "This week task" has due date "2024-12-18"',template:"todo {string} has due date {string}",params:{string0:"This week task",string1:"2024-12-18"}},{text:'todo "Next week task" has due date "2024-12-23"',template:"todo {string} has due date {string}",params:{string0:"Next week task",string1:"2024-12-23"}},{text:'todo "Last week task" has due date "2024-12-08"',template:"todo {string} has due date {string}",params:{string0:"Last week task",string1:"2024-12-08"}}],When:[{text:'I filter by due date "this week"',template:"I filter by due date {string}",params:{string0:"this week"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:'the filtered list should contain "This week task"',template:"the filtered list should contain {string}",params:{string0:"This week task"}}]},line:53},{scenario:"Sort todos by due date (soonest first)",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Due last"',template:"I have added a todo with text {string}",params:{string0:"Due last"}},{text:'I have added a todo with text "Due first"',template:"I have added a todo with text {string}",params:{string0:"Due first"}},{text:'I have added a todo with text "Due middle"',template:"I have added a todo with text {string}",params:{string0:"Due middle"}},{text:'todo "Due last" has due date "2024-12-31"',template:"todo {string} has due date {string}",params:{string0:"Due last",string1:"2024-12-31"}},{text:'todo "Due first" has due date "2024-12-10"',template:"todo {string} has due date {string}",params:{string0:"Due first",string1:"2024-12-10"}},{text:'todo "Due middle" has due date "2024-12-20"',template:"todo {string} has due date {string}",params:{string0:"Due middle",string1:"2024-12-20"}}],When:[{text:"I sort todos by due date ascending",template:"I sort todos by due date ascending"}],Then:[{text:'the first todo should be "Due first"',template:"the first todo should be {string}",params:{string0:"Due first"}},{text:'the second todo should be "Due middle"',template:"the second todo should be {string}",params:{string0:"Due middle"}},{text:'the third todo should be "Due last"',template:"the third todo should be {string}",params:{string0:"Due last"}}]},line:66},{scenario:"Combine due date filter with status filter",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'today is "2024-12-15"',template:"today is {string}",params:{string0:"2024-12-15"}},{text:'I have added a todo with text "Overdue active"',template:"I have added a todo with text {string}",params:{string0:"Overdue active"}},{text:'I have added a todo with text "Overdue completed"',template:"I have added a todo with text {string}",params:{string0:"Overdue completed"}},{text:'I have added a todo with text "Current active"',template:"I have added a todo with text {string}",params:{string0:"Current active"}},{text:'todo "Overdue active" has due date "2024-12-10"',template:"todo {string} has due date {string}",params:{string0:"Overdue active",string1:"2024-12-10"}},{text:'todo "Overdue completed" has due date "2024-12-12"',template:"todo {string} has due date {string}",params:{string0:"Overdue completed",string1:"2024-12-12"}},{text:'todo "Current active" has due date "2024-12-15"',template:"todo {string} has due date {string}",params:{string0:"Current active",string1:"2024-12-15"}},{text:'todo "Overdue completed" is completed',template:"todo {string} is completed",params:{string0:"Overdue completed"}}],When:[{text:'I filter by due date "overdue"',template:"I filter by due date {string}",params:{string0:"overdue"}},{text:'I filter by status "active"',template:"I filter by status {string}",params:{string0:"active"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:'the filtered list should contain "Overdue active"',template:"the filtered list should contain {string}",params:{string0:"Overdue active"}}]},line:79},{scenario:"Show todos with no due date",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Has deadline"',template:"I have added a todo with text {string}",params:{string0:"Has deadline"}},{text:'I have added a todo with text "No deadline 1"',template:"I have added a todo with text {string}",params:{string0:"No deadline 1"}},{text:'I have added a todo with text "No deadline 2"',template:"I have added a todo with text {string}",params:{string0:"No deadline 2"}},{text:'todo "Has deadline" has due date "2024-12-20"',template:"todo {string} has due date {string}",params:{string0:"Has deadline",string1:"2024-12-20"}}],When:[{text:'I filter by due date "none"',template:"I filter by due date {string}",params:{string0:"none"}}],Then:[{text:"the filtered list should contain 2 todos",template:"the filtered list should contain {int} todos",params:{int0:2}},{text:'the filtered list should contain "No deadline 1"',template:"the filtered list should contain {string}",params:{string0:"No deadline 1"}},{text:'the filtered list should contain "No deadline 2"',template:"the filtered list should contain {string}",params:{string0:"No deadline 2"}}]},line:94},{scenario:"Combine priority and due date filters",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'today is "2024-12-15"',template:"today is {string}",params:{string0:"2024-12-15"}},{text:'I have added a todo with text "High priority overdue"',template:"I have added a todo with text {string}",params:{string0:"High priority overdue"}},{text:'I have added a todo with text "Low priority overdue"',template:"I have added a todo with text {string}",params:{string0:"Low priority overdue"}},{text:'I have added a todo with text "High priority current"',template:"I have added a todo with text {string}",params:{string0:"High priority current"}},{text:'todo "High priority overdue" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"High priority overdue",string1:"high"}},{text:'todo "High priority overdue" has due date "2024-12-10"',template:"todo {string} has due date {string}",params:{string0:"High priority overdue",string1:"2024-12-10"}},{text:'todo "Low priority overdue" has priority "low"',template:"todo {string} has priority {string}",params:{string0:"Low priority overdue",string1:"low"}},{text:'todo "Low priority overdue" has due date "2024-12-12"',template:"todo {string} has due date {string}",params:{string0:"Low priority overdue",string1:"2024-12-12"}},{text:'todo "High priority current" has priority "high"',template:"todo {string} has priority {string}",params:{string0:"High priority current",string1:"high"}},{text:'todo "High priority current" has due date "2024-12-15"',template:"todo {string} has due date {string}",params:{string0:"High priority current",string1:"2024-12-15"}}],When:[{text:'I filter by priority "high"',template:"I filter by priority {string}",params:{string0:"high"}},{text:'I filter by due date "overdue"',template:"I filter by due date {string}",params:{string0:"overdue"}}],Then:[{text:"the filtered list should contain 1 todo",template:"the filtered list should contain {int} todo",params:{int0:1}},{text:'the filtered list should contain "High priority overdue"',template:"the filtered list should contain {string}",params:{string0:"High priority overdue"}}]},line:105}]},{file:"/home/mine/dev/projects/2_typescript/nodejs/watcher-dir/watcher-v1/src/lib/modules/self-improving/__specifications__/features/todo-crud.feature",feature:"Todo CRUD Operations",description:"As a user I want to manage my todos So that I can track my tasks",scenarios:[{scenario:"Add a new todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"}],When:[{text:'I add a todo with text "Buy groceries"',template:"I add a todo with text {string}",params:{string0:"Buy groceries"}}],Then:[{text:"the todo list should contain 1 todo",template:"the todo list should contain {int} todo",params:{int0:1}},{text:'the todo should have text "Buy groceries"',template:"the todo should have text {string}",params:{string0:"Buy groceries"}},{text:"the todo should not be completed",template:"the todo should not be completed"},{text:"the active count should be 1",template:"the active count should be {int}",params:{int0:1}}]},line:6},{scenario:"Add multiple todos",steps:{Given:[{text:"a todo facade",template:"a todo facade"}],When:[{text:'I add a todo with text "Task 1"',template:"I add a todo with text {string}",params:{string0:"Task 1"}},{text:'I add a todo with text "Task 2"',template:"I add a todo with text {string}",params:{string0:"Task 2"}},{text:'I add a todo with text "Task 3"',template:"I add a todo with text {string}",params:{string0:"Task 3"}}],Then:[{text:"the todo list should contain 3 todos",template:"the todo list should contain {int} todos",params:{int0:3}},{text:"the active count should be 3",template:"the active count should be {int}",params:{int0:3}},{text:"the completed count should be 0",template:"the completed count should be {int}",params:{int0:0}}]},line:14},{scenario:"Toggle todo to completed",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Complete project"',template:"I have added a todo with text {string}",params:{string0:"Complete project"}}],When:[{text:"I toggle the todo",template:"I toggle the todo"}],Then:[{text:"the todo should be completed",template:"the todo should be completed"},{text:"the active count should be 0",template:"the active count should be {int}",params:{int0:0}},{text:"the completed count should be 1",template:"the completed count should be {int}",params:{int0:1}}]},line:23},{scenario:"Toggle todo back to active",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Review code"',template:"I have added a todo with text {string}",params:{string0:"Review code"}},{text:"the todo is completed",template:"the todo is completed"}],When:[{text:"I toggle the todo",template:"I toggle the todo"}],Then:[{text:"the todo should not be completed",template:"the todo should not be completed"},{text:"the active count should be 1",template:"the active count should be {int}",params:{int0:1}},{text:"the completed count should be 0",template:"the completed count should be {int}",params:{int0:0}}]},line:31},{scenario:"Update todo text",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Old text"',template:"I have added a todo with text {string}",params:{string0:"Old text"}}],When:[{text:'I update the todo text to "New text"',template:"I update the todo text to {string}",params:{string0:"New text"}}],Then:[{text:'the todo should have text "New text"',template:"the todo should have text {string}",params:{string0:"New text"}}]},line:40},{scenario:"Delete a todo",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Delete me"',template:"I have added a todo with text {string}",params:{string0:"Delete me"}}],When:[{text:"I delete the todo",template:"I delete the todo"}],Then:[{text:"the todo list should contain 0 todos",template:"the todo list should contain {int} todos",params:{int0:0}},{text:"the total count should be 0",template:"the total count should be {int}",params:{int0:0}}]},line:46},{scenario:"Clear completed todos",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task 1"',template:"I have added a todo with text {string}",params:{string0:"Task 1"}},{text:'I have added a todo with text "Task 2"',template:"I have added a todo with text {string}",params:{string0:"Task 2"}},{text:'I have added a todo with text "Task 3"',template:"I have added a todo with text {string}",params:{string0:"Task 3"}},{text:'todo "Task 1" is completed',template:"todo {string} is completed",params:{string0:"Task 1"}},{text:'todo "Task 3" is completed',template:"todo {string} is completed",params:{string0:"Task 3"}}],When:[{text:"I clear completed todos",template:"I clear completed todos"}],Then:[{text:"the todo list should contain 1 todo",template:"the todo list should contain {int} todo",params:{int0:1}},{text:"the active count should be 1",template:"the active count should be {int}",params:{int0:1}},{text:"the completed count should be 0",template:"the completed count should be {int}",params:{int0:0}}]},line:53},{scenario:"Clear all todos",steps:{Given:[{text:"a todo facade",template:"a todo facade"},{text:'I have added a todo with text "Task 1"',template:"I have added a todo with text {string}",params:{string0:"Task 1"}},{text:'I have added a todo with text "Task 2"',template:"I have added a todo with text {string}",params:{string0:"Task 2"}}],When:[{text:"I clear all todos",template:"I clear all todos"}],Then:[{text:"the todo list should contain 0 todos",template:"the todo list should contain {int} todos",params:{int0:0}},{text:"the total count should be 0",template:"the total count should be {int}",params:{int0:0}}]},line:65}]}],Qt=Object.freeze(Object.defineProperty({__proto__:null,GherkinData:wt,Given:H,Then:y,When:b},Symbol.toStringTag,{value:"Module"})),We={[H["a todo facade"]]:async s=>{R(s.facade).toBeDefined(),s.facade.clearAll(),s.todoMap.clear(),delete s.lastTodo,await new Promise(t=>setTimeout(t,50))},[H["I have added a todo with text {string}"]]:(s,t)=>{const e=s.facade.addTodo(t.string0);s.lastTodo=e,s.todoMap.set(t.string0,e)},[H["the todo is completed"]]:s=>{if(!s.lastTodo)throw new Error("No todo to complete");s.facade.toggleTodo(s.lastTodo.id)},[H["todo {string} is completed"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);s.facade.toggleTodo(e.id)},[H["I am searching for {string}"]]:(s,t)=>{s.facade.search(t.string0)},[H["I add tag {string} to todo {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);s.facade.addTag(e.id,t.string0)},[H["todo {string} has priority {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);s.facade.setPriority(e.id,t.string1)},[H["todo {string} has due date {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);s.facade.setDueDate(e.id,t.string1)},[H["today is {string}"]]:(s,t)=>{s.facade.setCurrentDate(t.string0)},[b["I add a todo with text {string}"]]:(s,t)=>{const e=s.facade.addTodo(t.string0);s.lastTodo=e,s.todoMap.set(t.string0,e)},[b["I toggle the todo"]]:s=>{if(!s.lastTodo)throw new Error("No todo to toggle");s.facade.toggleTodo(s.lastTodo.id)},[b["I update the todo text to {string}"]]:(s,t)=>{if(!s.lastTodo)throw new Error("No todo to update");s.facade.updateTodo(s.lastTodo.id,t.string0)},[b["I delete the todo"]]:s=>{if(!s.lastTodo)throw new Error("No todo to delete");s.facade.deleteTodo(s.lastTodo.id)},[b["I clear completed todos"]]:s=>{s.facade.clearCompleted()},[b["I clear all todos"]]:s=>{s.facade.clearAll()},[b["I filter by status {string}"]]:async(s,t)=>{s.facade.filterByStatus(t.string0),await new Promise(e=>setTimeout(e,50))},[b["I search for {string}"]]:async(s,t)=>{s.facade.search(t.string0),await new Promise(e=>setTimeout(e,50))},[b["I clear the search"]]:async s=>{s.facade.search(""),await new Promise(t=>setTimeout(t,50))},[b["I filter by tag {string}"]]:async(s,t)=>{s.facade.filterByTag(t.string0),await new Promise(e=>setTimeout(e,50))},[b["I get all tags"]]:s=>{s.lastTagList=s.facade.getAllTags()},[b["I remove tag {string} from todo {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);s.facade.removeTag(e.id,t.string0)},[b["I set priority {string} on todo {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);s.facade.setPriority(e.id,t.string0)},[b["I filter by priority {string}"]]:async(s,t)=>{s.facade.filterByPriority(t.string0),await new Promise(e=>setTimeout(e,50))},[b["I clear priority from todo {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);s.facade.clearPriority(e.id)},[b["I show only high priority todos"]]:async s=>{s.facade.filterByPriority("high"),await new Promise(t=>setTimeout(t,50))},[b["I sort todos by priority descending"]]:s=>{s.sortedTodos=s.facade.sortByPriority(!0)},[b["I set due date {string} on todo {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);s.facade.setDueDate(e.id,t.string0)},[b["I remove due date from todo {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);s.facade.removeDueDate(e.id)},[b["I filter by due date {string}"]]:async(s,t)=>{s.facade.filterByDueDate(t.string0),await new Promise(e=>setTimeout(e,50))},[b["I sort todos by due date ascending"]]:s=>{s.sortedTodos=s.facade.sortByDueDate(!0)},[y["the todo list should contain {int} todo"]]:(s,t)=>{const e=s.facade.getState();R(e.todos.length).toBe(t.int0)},[y["the todo list should contain {int} todos"]]:(s,t)=>{const e=s.facade.getState();R(e.todos.length).toBe(t.int0)},[y["the todo should have text {string}"]]:(s,t)=>{if(!s.lastTodo)throw new Error("No todo to check");const e=s.facade.getTodo(s.lastTodo.id);R(e==null?void 0:e.text).toBe(t.string0)},[y["the todo should not be completed"]]:s=>{if(!s.lastTodo)throw new Error("No todo to check");const t=s.facade.getTodo(s.lastTodo.id);R(t==null?void 0:t.completed).toBe(!1)},[y["the todo should be completed"]]:s=>{if(!s.lastTodo)throw new Error("No todo to check");const t=s.facade.getTodo(s.lastTodo.id);R(t==null?void 0:t.completed).toBe(!0)},[y["the active count should be {int}"]]:(s,t)=>{const e=s.facade.getStats();R(e.active).toBe(t.int0)},[y["the completed count should be {int}"]]:(s,t)=>{const e=s.facade.getStats();R(e.completed).toBe(t.int0)},[y["the total count should be {int}"]]:(s,t)=>{const e=s.facade.getStats();R(e.total).toBe(t.int0)},[y["the filtered list should contain {int} todo"]]:(s,t)=>{const e=s.facade.getFilteredTodos();R(e.length).toBe(t.int0)},[y["the filtered list should contain {int} todos"]]:(s,t)=>{const e=s.facade.getFilteredTodos();R(e.length).toBe(t.int0)},[y["the filtered list should contain {string}"]]:(s,t)=>{const a=s.facade.getFilteredTodos().some(i=>i.text===t.string0);R(a).toBe(!0)},[y["todo {string} should have tag {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=s.facade.getTodo(e.id);if(!a)throw new Error(`Todo "${t.string0}" no longer exists`);const i=a.tags.includes(t.string1);R(i).toBe(!0)},[y["todo {string} should not have tag {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=s.facade.getTodo(e.id);if(!a)throw new Error(`Todo "${t.string0}" no longer exists`);const i=a.tags.includes(t.string1);R(i).toBe(!1)},[y["the tag list should contain {string}"]]:(s,t)=>{if(!s.lastTagList)throw new Error('No tag list available - call "I get all tags" first');const e=s.lastTagList.includes(t.string0);R(e).toBe(!0)},[y["the tag list should have {int} unique tags"]]:(s,t)=>{if(!s.lastTagList)throw new Error('No tag list available - call "I get all tags" first');R(s.lastTagList.length).toBe(t.int0)},[y["todo {string} should have priority {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=s.facade.getTodo(e.id);if(!a)throw new Error(`Todo "${t.string0}" no longer exists`);R(a.priority).toBe(t.string1)},[y["todo {string} should have no priority"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=s.facade.getTodo(e.id);if(!a)throw new Error(`Todo "${t.string0}" no longer exists`);R(a.priority).toBe(void 0)},[y["the first todo should be {string}"]]:(s,t)=>{if(!s.sortedTodos||s.sortedTodos.length===0)throw new Error("No sorted todos available");R(s.sortedTodos[0].text).toBe(t.string0)},[y["the second todo should be {string}"]]:(s,t)=>{if(!s.sortedTodos||s.sortedTodos.length<2)throw new Error("Not enough sorted todos available");R(s.sortedTodos[1].text).toBe(t.string0)},[y["the third todo should be {string}"]]:(s,t)=>{if(!s.sortedTodos||s.sortedTodos.length<3)throw new Error("Not enough sorted todos available");R(s.sortedTodos[2].text).toBe(t.string0)},[y["todo {string} should have due date {string}"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=s.facade.getTodo(e.id);if(!a)throw new Error(`Todo "${t.string0}" no longer exists`);R(a.dueDate).toBe(t.string1)},[y["todo {string} should have no due date"]]:(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=s.facade.getTodo(e.id);if(!a)throw new Error(`Todo "${t.string0}" no longer exists`);R(a.dueDate).toBe(void 0)}};function R(s){return{toBe(t){if(s!==t)throw new Error(`Expected ${JSON.stringify(t)} but got ${JSON.stringify(s)}`)},toBeDefined(){if(s==null)throw new Error("Expected value to be defined")}}}const It=new zt;It.register("todo",{features:["Todo CRUD Operations","Todo Filtering","Todo Tags","Todo Priority","Todo Due Dates"],createContext:s=>({facade:s.todo,todoMap:new Map}),stepDefinitions:We});function Zt({uiFacade:s,selfImprovingFacade:t,controlledTestResults:e,onTestResults:a}){return o.jsx("div",{"data-test":"todo-specifications-view-container",children:o.jsx(Mt,{config:{registry:It,features:[...wt],facades:{todo:s},selfImprovingFacade:t,enableStepByStep:!0},storageKey:"spec-view-todo",controlledTestResults:e,onTestResults:a})})}const Ve=["data-react-inspector","class","style"];function nt(s,t=[]){if(!s)return"(null)";const e=s.cloneNode(!0),a=[...Ve,...t],i=Array.from(e.attributes);for(const r of i)a.some(u=>!!(r.name===u||u.includes("$")&&r.name.startsWith(u.replace("$",""))))&&e.removeAttribute(r.name);return e.outerHTML}const Ge=new Pt("SelfImprovingUIMode",{log:!0,shouldLogConfig:{log:!0,maxLevel:10}});class d{static log(t){Ge.log(t),Z.addSelfImproveLog(t)}static clear(){Z.clearSelfImproveLogs()}static getLogs(){return Z.loadSelfImproveLogs()}}const te=s=>new Promise(t=>setTimeout(t,s));let kt=null;const ze=()=>(kt===null&&(kt=Z.loadUIModeStepDelay()),kt),Ke=()=>{kt=null},v=s=>{const e=ze()/500;return te(Math.round(s*e))},Ye=s=>{s.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},_=s=>{s.classList.add("ui-mode-highlight")},U=s=>{s.classList.remove("ui-mode-highlight")},G=async s=>{const t=new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0});s.dispatchEvent(t),await te(50);const e=new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0});s.dispatchEvent(e);const a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});s.dispatchEvent(a)};class Je{static async highlightFailureItem(t){const{failureIndex:e}=t;t.setStatusMessage(`Step 1: Locating "${t.failure.scenario}"...`);const a=document.querySelector(`[data-test="failure-item-${e}"]`);if(!a){d.log(`  âš ï¸ Could not find failure-item-${e}, skipping...`);return}d.log("  [Step 1] ðŸ“œ Scrolling to failure item..."),Ye(a),await v(500),!t.cancelRequested()&&(t.setStatusMessage("Step 2: Highlighting test failure..."),d.log("  [Step 2] âœ¨ Highlighting failure item..."),_(a),await v(1500),U(a))}static async handleTicketCreation(t){const{failureIndex:e}=t,a=document.querySelector(`[data-test="view-ticket-button-${e}"]`),i=document.querySelector(`[data-test="create-ticket-button-${e}"]`),r=a||i;if(r&&(t.setStatusMessage(`Step 3: ${a?"View existing ticket":"Create new ticket"}...`),d.log(`  [Step 3] ðŸŽ¯ Highlighting ${a?"view":"create"} ticket button...`),_(r),await v(1e3),!t.cancelRequested()&&(t.setStatusMessage("Step 4: Opening ticket panel..."),d.log("  [Step 4] ðŸ‘† Clicking ticket button..."),await G(r),await v(1e3),U(r),i&&!a))){if(t.cancelRequested())return;await v(500);const c=document.querySelector('[data-test="todo-details-create-button"]');if(c){if(t.setStatusMessage("Step 5: Clicking Create Todo button..."),d.log("  [Step 5] ðŸŽ¯ Highlighting Create Todo button..."),_(c),await v(1e3),t.cancelRequested())return;d.log("  [Step 5] ðŸ‘† Clicking Create Todo button..."),await G(c),U(c),await v(1500),await v(1e3)}else d.log("  âš ï¸ Could not find create button, skipping...")}}static async handleClaudeSessionCreation(t){const{failureIndex:e}=t,a=document.querySelector(`[data-test="view-ticket-button-${e}"]`);if(!a){d.log("  âš ï¸ Could not find view ticket button after creation");return}if(t.setStatusMessage("Step 6: Opening ticket to create Claude session..."),d.log("  [Step 6] ðŸ‘† Clicking view ticket button..."),_(a),await v(500),await G(a),U(a),await v(1e3),t.cancelRequested())return;const i=document.querySelector('[data-test="view-ticket-popover-content"]'),r=(i==null?void 0:i.querySelector('[data-test="kanban-card-details-create-session-button"]'))||(i==null?void 0:i.querySelector('[data-test="create-session-button"]'));if(!r){d.log("  âš ï¸ Could not find create session button");return}if(t.setStatusMessage("Step 7: Opening Claude session creator..."),d.log("  [Step 7] ðŸŽ¯ Highlighting create session button..."),_(r),await v(1e3),t.cancelRequested()||(d.log("  [Step 7] ðŸ‘† Clicking create session button..."),await G(r),U(r),await v(1e3),t.cancelRequested()))return;const c=document.querySelector('[data-test="create-session-send-button"]');if(!c){d.log("  âš ï¸ Could not find send session button");return}if(t.setStatusMessage("Step 8: Creating Claude session..."),d.log("  [Step 8] ðŸŽ¯ Highlighting send session button..."),_(c),await v(1e3),t.cancelRequested()||(d.log("  [Step 8] ðŸ‘† Clicking send session button..."),await G(c),U(c),await v(2e3),t.cancelRequested()))return;t.setStatusMessage("Step 9: Waiting for session to open..."),d.log("  [Step 9] â³ Waiting for activity status to become 'opened'...");let u=!1,f=0;const $=1800;for(;!u&&f<$;){if(t.cancelRequested())return;const T=document.querySelector('[data-test="activity-dot"]'),l=T==null?void 0:T.getAttribute("data-activity-status");l==="opened"?(u=!0,d.log("  [Step 9] âœ… Activity status is 'opened'")):(d.log(`  [Step 9] â³ Current status: ${l}, waiting...`),await v(1e3),f++)}if(u||d.log("  [Step 9] âš ï¸ Timeout waiting for activity status 'opened'"),t.cancelRequested())return;t.setStatusMessage("Step 10: Closing popover..."),d.log("  [Step 10] ðŸšª Closing popover...");const E=document.querySelector(".close-button");E?(_(E),await v(500),await G(E),U(E),d.log("  [Step 10] âœ… Popover closed"),await v(1e3)):d.log("  [Step 10] âš ï¸ Could not find close button")}static async handleErrorSubtaskAddition(t){var F,K,M,D,O,J,W,Y,N,L;const{failureIndex:e,failure:a}=t,i=document.querySelector(`[data-test="view-ticket-button-${e}"]`);if(!i)return;const r=i.querySelector('[data-test="activity-dot"]');if(d.log("  [Step 11] ðŸ” Checking for activity-dot..."),d.log(`  [Step 11] ðŸ” viewTicketBtnForError found: ${!!i}`),d.log(`  [Step 11] ðŸ” activityDot found: ${!!r}`),!r){const n=i.querySelector('[data-test="session-activity-indicator"]');if(d.log(`  [Step 11] ðŸ” session-activity-indicator found: ${!!n}`),n){const S=n.querySelector('[data-test="activity-dot"]');d.log(`  [Step 11] ðŸ” activity-dot inside indicator: ${!!S}`)}const I=nt(i);d.log(`  [Step 11] ðŸ” Button HTML: ${I.substring(0,300)}`)}let c=!!r;if(c){if(t.setStatusMessage("Step 11: Adding error to linked ticket..."),d.log("  [Step 11] ðŸŽ¯ Found linked session via activity-dot, adding error as subtask..."),_(i),await v(500),await G(i),U(i),await v(1e3),t.cancelRequested())return}else{if(d.log("  [Step 11] â„¹ï¸ No activity-dot in button, opening ticket to check for session IDs..."),t.setStatusMessage("Step 11: Checking ticket for linked sessions..."),_(i),await v(500),await G(i),U(i),await v(1e3),t.cancelRequested())return;const n=document.querySelector('[data-test="view-ticket-popover-content"]');if(n){const I=n.querySelector('[data-test="todo-details-sessions-label"]');if(d.log(`  [Step 11] ðŸ” todo-details-sessions-label found: ${!!I}`),I){const S=I.textContent||"";d.log(`  [Step 11] ðŸ” Sessions label text: "${S}"`);const Q=/\((\d+)\)/.test(S)&&parseInt(((F=/\((\d+)\)/.exec(S))==null?void 0:F[1])||"0")>0;d.log(`  [Step 11] ðŸ” Has session IDs: ${Q}`),Q&&(c=!0,d.log("  [Step 11] ðŸŽ¯ Found linked session via session IDs in panel"))}}else d.log("  [Step 11] âš ï¸ Could not find popover content")}if(!c){d.log("  [Step 11] â„¹ï¸ No linked session found, skipping subtask addition");const n=document.querySelector('[data-test="view-ticket-popover-content"]');if(n){const I=(K=n.closest(".view-ticket-popover"))==null?void 0:K.querySelector(".close-button");I&&(await G(I),await v(500))}return}t.setStatusMessage("Step 11: Adding error to linked ticket...");const u=document.querySelector(`[data-test="failure-item-error-message-${t.failureIndex}"]`),f=((M=u==null?void 0:u.textContent)==null?void 0:M.trim())||a.error,$=document.querySelector(`[data-test="failure-item-error-stack-content-${t.failureIndex}"]`),E=((D=$==null?void 0:$.textContent)==null?void 0:D.trim())||a.errorStack||"";d.log(`  [Step 11] ðŸ“‹ Current error from DOM: "${f.substring(0,100)}..."`),d.log(`  [Step 11] ðŸ“‹ Stack trace available: ${E.length>0?"yes":"no"}`);const T=document.querySelector('[data-test="view-ticket-popover-content"]');if(!T){d.log("  [Step 11] âš ï¸ Could not find popover content");return}d.log("  [Step 11] ðŸ“– Checking for duplicate error...");const l=T.querySelector('[data-test="todo-details-description-field"]'),x=(l==null?void 0:l.value)||"",h=T.querySelectorAll('[data-test^="todo-details-subtask-title-"]'),m=Array.from(h).map(n=>{var I;return((I=n.textContent)==null?void 0:I.trim())||""}),g=x.includes(f)||m.some(n=>n.includes(f));d.log(`  [Step 11] ${g?"âš ï¸":"âœ…"} Error ${g?"already exists":"is new"}`);const j=T.querySelector('[data-test="todo-details-subtask-input-container"]'),k=j==null?void 0:j.querySelector("textarea"),P=T.querySelector('[data-test="todo-details-subtask-add-button"]');if(d.log(`  [Step 11] ðŸ” subtaskInputContainer found: ${!!j}`),d.log(`  [Step 11] ðŸ” subtaskInput (textarea) found: ${!!k}`),d.log(`  [Step 11] ðŸ” addSubtaskBtn found: ${!!P}`),!k||!P){d.log("  [Step 11] âš ï¸ Could not find subtask input or add button");const n=T.querySelector('[data-test="todo-details-subtasks-field"]');if(d.log(`  [Step 11] ðŸ” subtasks-field found: ${!!n}`),n){const I=nt(n);d.log(`  [Step 11] ðŸ” subtasks-field HTML: ${I.substring(0,300)}`),n.scrollIntoView({behavior:"smooth",block:"center"}),await v(1e3);const S=T.querySelector('[data-test="todo-details-subtask-input-container"]'),Q=S==null?void 0:S.querySelector("textarea"),ht=T.querySelector('[data-test="todo-details-subtask-add-button"]');if(d.log(`  [Step 11] ðŸ” After scroll - subtaskInput found: ${!!Q}`),d.log(`  [Step 11] ðŸ” After scroll - addSubtaskBtn found: ${!!ht}`),!Q||!ht){d.log("  [Step 11] âš ï¸ Still could not find elements after scrolling, skipping subtask addition");return}const at=Q,dt=ht,Ct=E?`The error still persists: ${f}

Stack trace:
${E}`:`The error still persists: ${f}`;d.log(`  [Step 11] âž• Adding subtask: "${Ct.substring(0,50)}..."`),_(at),await v(500);const qt=(O=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:O.set;qt?qt.call(at,Ct):at.value=Ct;const oe=new Event("input",{bubbles:!0});if(at.dispatchEvent(oe),d.log(`  [Step 11] ðŸ“ Filled textarea, value is now: "${at.value.substring(0,50)}..."`),await v(800),t.cancelRequested())return;U(at),d.log(`  [Step 11] ðŸ” About to highlight and click add button: ${!!dt}`),d.log(`  [Step 11] ðŸ” Button disabled: ${dt.hasAttribute("disabled")}, aria-disabled: ${dt.getAttribute("aria-disabled")}`),_(dt),await v(500),d.log("  [Step 11] ðŸ–±ï¸  Clicking add subtask button..."),await G(dt),U(dt),d.log("  [Step 11] âœ… Add button clicked"),await v(1e3);const xt=T.querySelectorAll('[data-test^="todo-details-subtask-item-"]');d.log(`  [Step 11] ðŸ” Subtask count after click: ${xt.length}`);let Ot=!1;if(xt.forEach((gt,lt)=>{const ct=gt.textContent||"";d.log(`  [Step 11] ðŸ” Subtask ${lt}: "${ct.substring(0,50)}..."`),ct.includes(f)&&(Ot=!0)}),!Ot)d.log("  [Step 11] âš ï¸ WARNING: Subtask was NOT created after clicking button!"),d.log(`  [Step 11] ðŸ” Textarea value: "${at.value}"`),d.log(`  [Step 11] ðŸ” Button HTML: ${nt(dt)}`);else{d.log("  [Step 11] âœ… Subtask verified: Successfully created");const gt=xt[xt.length-1];if(gt){const lt=(J=gt.getAttribute("data-test"))==null?void 0:J.replace("todo-details-subtask-item-","");if(d.log(`  [Step 11] ðŸ“§ Found new subtask ID: ${lt}`),d.log("  [Step 11] ðŸ“œ Scrolling subtask into view..."),gt.scrollIntoView({behavior:"smooth",block:"center"}),await v(800),t.cancelRequested())return;if(lt){const ct=T.querySelector(`[data-test="todo-details-subtask-send-${lt}"]`);if(ct){if(d.log(`  [Step 11] ðŸš€ Clicking send button for subtask ${lt}...`),_(ct),await v(500),await G(ct),U(ct),d.log("  [Step 11] âœ… Send button clicked"),await v(1e3),t.cancelRequested())return;t.setStatusMessage("Step 11: Waiting for Claude to finish subtask..."),d.log("  [Step 11] â³ Waiting for activity status to become 'opened'...");let Et=!1,$t=0;const ie=1800;for(;!Et&&$t<ie;){if(t.cancelRequested())return;const Dt=document.querySelector('[data-test="activity-dot"]'),_t=Dt==null?void 0:Dt.getAttribute("data-activity-status");_t==="opened"?(Et=!0,d.log("  [Step 11] âœ… Activity status is 'opened' - Claude finished")):($t%10===0&&d.log(`  [Step 11] â³ Current status: ${_t}, waiting...`),await v(1e3),$t++)}Et||d.log("  [Step 11] âš ï¸ Timeout waiting for Claude to finish subtask")}else d.log(`  [Step 11] âš ï¸ Could not find send button for subtask ${lt}`)}}}if(t.cancelRequested())return;const vt=(W=T.closest(".view-ticket-popover"))==null?void 0:W.querySelector(".close-button");vt?(d.log("  [Step 11] ðŸšª Closing popover..."),_(vt),await v(500),await G(vt),U(vt),await v(1e3)):d.log("  [Step 11] âš ï¸ Could not find close button");return}return}const z=E?`The error still persists: ${f}

Stack trace:
${E}`:`The error still persists: ${f}`;d.log(`  [Step 11] âž• Adding subtask: "${z.substring(0,50)}..."`),_(k),await v(500);const X=(Y=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value"))==null?void 0:Y.set;X?X.call(k,z):k.value=z;const et=new Event("input",{bubbles:!0});if(k.dispatchEvent(et),d.log(`  [Step 11] ðŸ“ Filled textarea, value is now: "${k.value.substring(0,50)}..."`),await v(800),t.cancelRequested())return;U(k),d.log(`  [Step 11] ðŸ” About to highlight and click add button: ${!!P}`),d.log(`  [Step 11] ðŸ” Button disabled: ${P.hasAttribute("disabled")}, aria-disabled: ${P.getAttribute("aria-disabled")}`),_(P),await v(500),d.log("  [Step 11] ðŸ–±ï¸  Clicking add subtask button..."),await G(P),U(P),d.log("  [Step 11] âœ… Add button clicked"),await v(1e3);const C=T.querySelectorAll('[data-test^="todo-details-subtask-item-"]');d.log(`  [Step 11] ðŸ” Subtask count after click: ${C.length}`);let B=!1;if(C.forEach((n,I)=>{const S=n.textContent||"";d.log(`  [Step 11] ðŸ” Subtask ${I}: "${S.substring(0,50)}..."`),S.includes(f)&&(B=!0)}),!B)d.log("  [Step 11] âš ï¸ WARNING: Subtask was NOT created after clicking button!"),d.log(`  [Step 11] ðŸ” Textarea value: "${k.value}"`),d.log(`  [Step 11] ðŸ” Button HTML: ${nt(P)}`);else{d.log("  [Step 11] âœ… Subtask verified: Successfully created");const n=C[C.length-1];if(n){const I=(N=n.getAttribute("data-test"))==null?void 0:N.replace("todo-details-subtask-item-","");if(d.log(`  [Step 11] ðŸ“§ Found new subtask ID: ${I}`),d.log("  [Step 11] ðŸ“œ Scrolling subtask into view..."),n.scrollIntoView({behavior:"smooth",block:"center"}),await v(800),t.cancelRequested())return;if(I){const S=T.querySelector(`[data-test="todo-details-subtask-send-${I}"]`);S?(d.log(`  [Step 11] ðŸš€ Clicking send button for subtask ${I}...`),_(S),await v(500),await G(S),U(S),d.log("  [Step 11] âœ… Send button clicked"),await v(1e3)):d.log(`  [Step 11] âš ï¸ Could not find send button for subtask ${I}`)}}}if(t.cancelRequested())return;const A=(L=T.closest(".view-ticket-popover"))==null?void 0:L.querySelector(".close-button");A?(d.log("  [Step 11] ðŸšª Closing popover..."),_(A),await v(500),await G(A),U(A),await v(1e3)):d.log("  [Step 11] âš ï¸ Could not find close button")}static async rerunScenario(t){const{failureIndex:e}=t;t.setStatusMessage("Step 12: Re-running scenario..."),d.log("  [Step 12] ðŸ”„ Clicking Run button to re-run scenario...");const a=document.querySelector(`[data-test="run-scenario-button-${e}"]`);a?(_(a),await v(500),await G(a),U(a),d.log("  [Step 12] âœ… Run button clicked"),await v(2e3)):d.log("  [Step 12] âš ï¸ Could not find run button")}static async viewResult(t){t.setStatusMessage("Step 13: Viewing result..."),d.log("  [Step 13] ðŸ‘€ Viewing result..."),await v(2e3)}static async processFailure(t){d.log(""),d.log("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"),d.log(`ðŸ“‹ Processing Failure ${t.failureIndex+1}: ${t.failure.scenario}`),d.log("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"),await this.highlightFailureItem(t),!t.cancelRequested()&&(await this.handleTicketCreation(t),!t.cancelRequested()&&(await this.handleClaudeSessionCreation(t),!t.cancelRequested()&&(await this.handleErrorSubtaskAddition(t),!t.cancelRequested()&&(await this.rerunScenario(t),!t.cancelRequested()&&(await this.viewResult(t),d.log(`  âœ… Completed processing failure ${t.failureIndex+1}`))))))}}function Xe({todos:s,filter:t,stats:e,allTags:a=[],onAddTodo:i,onToggleTodo:r,onDeleteTodo:c,onUpdateTodo:u,onFilterChange:f,onClearCompleted:$,onClearAll:E,onAddTag:T,onRemoveTag:l,onSetPriority:x,onSortChange:h,currentSort:m="none",onSearch:g}){const[j,k]=p.useState(""),[P,z]=p.useState({}),[X,et]=p.useState(null),[C,B]=p.useState(""),A=()=>{j.trim()&&(i(j),k(""))},F=n=>{n.key==="Enter"&&A()},K=n=>{var S;const I=(S=P[n])==null?void 0:S.trim();I&&T&&(T(n,I),z(Q=>({...Q,[n]:""})))},M=(n,I)=>{n.key==="Enter"&&K(I)},D=(n,I)=>{l&&l(n,I)},O=(n,I)=>{x&&x(n,I===""?void 0:I)},J=(n,I)=>{u&&(et(n),B(I))},W=()=>{X&&C.trim()&&u&&(u(X,C.trim()),et(null),B(""))},Y=()=>{et(null),B("")},N=n=>{n.key==="Enter"?W():n.key==="Escape"&&Y()},L=n=>{switch(n){case"high":return"text-red-600 dark:text-red-400";case"medium":return"text-yellow-600 dark:text-yellow-400";case"low":return"text-blue-600 dark:text-blue-400";default:return"text-muted-foreground"}};return o.jsxs("div",{className:"todo-list bg-card border border-border rounded-lg h-full flex flex-col","data-test":"todo-list",children:[o.jsxs("div",{className:"todo-header p-4 border-b border-border","data-test":"todo-header",children:[o.jsx("h3",{className:"text-lg font-bold text-card-foreground mb-3","data-test":"todo-title",children:"âœ“ Todo List"}),o.jsxs("div",{className:"flex gap-2","data-test":"todo-input-group",children:[o.jsx(yt,{type:"text",placeholder:"What needs to be done?",value:j,onChange:n=>k(n.target.value),onKeyPress:F,className:"flex-1","data-test":"todo-input"}),o.jsx(q,{onClick:A,disabled:!j.trim(),"data-test":"todo-add-button",children:"Add"})]}),g&&o.jsxs("div",{className:"flex gap-2 mt-2","data-test":"todo-search-group",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Ne,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(yt,{type:"text",placeholder:"Search todos...",value:t.searchText||"",onChange:n=>g(n.target.value),className:"pl-8","data-test":"todo-search-input"})]}),t.searchText&&o.jsx(q,{variant:"ghost",size:"sm",onClick:()=>g(""),className:"px-2","data-test":"todo-search-clear",children:o.jsx(pt,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"stats-bar p-3 bg-muted border-b border-border flex items-center justify-between text-sm","data-test":"todo-stats-bar",children:[o.jsxs("div",{className:"stats-counts flex gap-4","data-test":"todo-stats-counts",children:[o.jsxs("span",{className:"text-muted-foreground","data-test":"todo-stats-total",children:[o.jsx("strong",{children:e.total})," total"]}),o.jsxs("span",{className:"text-blue-600 dark:text-blue-400","data-test":"todo-stats-active",children:[o.jsx("strong",{children:e.active})," active"]}),o.jsxs("span",{className:"text-green-600 dark:text-green-400","data-test":"todo-stats-completed",children:[o.jsx("strong",{children:e.completed})," completed"]})]}),o.jsxs("div",{className:"flex gap-2",children:[e.completed>0&&o.jsx(q,{size:"sm",variant:"ghost",onClick:$,className:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300","data-test":"todo-clear-completed-button",children:"Clear Completed"}),E&&e.total>0&&o.jsx(q,{size:"sm",variant:"ghost",onClick:E,className:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300","data-test":"todo-clear-all-button",children:"Clear All"})]})]}),o.jsxs("div",{className:"filter-tabs p-3 border-b border-border flex gap-2 flex-wrap","data-test":"todo-filter-tabs",children:[o.jsx(q,{size:"sm",variant:t.status==="all"?"default":"ghost",onClick:()=>f({status:"all"}),className:"text-xs","data-test":"todo-filter-all",children:"All"}),o.jsx(q,{size:"sm",variant:t.status==="active"?"default":"ghost",onClick:()=>f({status:"active"}),className:"text-xs","data-test":"todo-filter-active",children:"Active"}),o.jsx(q,{size:"sm",variant:t.status==="completed"?"default":"ghost",onClick:()=>f({status:"completed"}),className:"text-xs","data-test":"todo-filter-completed",children:"Completed"}),a.length>0&&o.jsxs("div",{className:"flex items-center gap-1 ml-2 border-l border-border pl-2","data-test":"todo-tag-filter-section",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:"Tag:"}),o.jsxs("select",{value:t.tag||"",onChange:n=>f({...t,tag:n.target.value||void 0}),className:"text-xs h-7 px-2 bg-background border border-border rounded","data-test":"todo-tag-filter-select",children:[o.jsx("option",{value:"",children:"All tags"}),a.map(n=>o.jsx("option",{value:n,"data-test":`todo-tag-filter-option-${n}`,children:n},n))]}),t.tag&&o.jsx(q,{size:"sm",variant:"ghost",onClick:()=>f({...t,tag:void 0}),className:"h-6 w-6 p-0","data-test":"todo-tag-filter-clear",children:o.jsx(pt,{className:"h-3 w-3"})})]}),o.jsxs("div",{className:"flex items-center gap-1 ml-2 border-l border-border pl-2","data-test":"todo-priority-filter-section",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:"Priority:"}),o.jsxs("select",{value:t.priority||"",onChange:n=>f({...t,priority:n.target.value||void 0}),className:"text-xs h-7 px-2 bg-background border border-border rounded","data-test":"todo-priority-filter-select",children:[o.jsx("option",{value:"",children:"All priorities"}),o.jsx("option",{value:"high","data-test":"todo-priority-filter-option-high",children:"High"}),o.jsx("option",{value:"medium","data-test":"todo-priority-filter-option-medium",children:"Medium"}),o.jsx("option",{value:"low","data-test":"todo-priority-filter-option-low",children:"Low"})]}),t.priority&&o.jsx(q,{size:"sm",variant:"ghost",onClick:()=>f({...t,priority:void 0}),className:"h-6 w-6 p-0","data-test":"todo-priority-filter-clear",children:o.jsx(pt,{className:"h-3 w-3"})})]}),h&&o.jsxs("div",{className:"flex items-center gap-1 ml-2 border-l border-border pl-2","data-test":"todo-sort-section",children:[o.jsx("span",{className:"text-xs text-muted-foreground",children:"Sort:"}),o.jsxs("select",{value:m,onChange:n=>h(n.target.value),className:"text-xs h-7 px-2 bg-background border border-border rounded","data-test":"todo-sort-select",children:[o.jsx("option",{value:"none","data-test":"todo-sort-option-none",children:"None"}),o.jsx("option",{value:"priority-desc","data-test":"todo-sort-option-priority-desc",children:"Priority (Highâ†’Low)"}),o.jsx("option",{value:"priority-asc","data-test":"todo-sort-option-priority-asc",children:"Priority (Lowâ†’High)"}),o.jsx("option",{value:"duedate-asc","data-test":"todo-sort-option-duedate-asc",children:"Due Date (Soonest)"}),o.jsx("option",{value:"duedate-desc","data-test":"todo-sort-option-duedate-desc",children:"Due Date (Latest)"})]}),m!=="none"&&o.jsx(q,{size:"sm",variant:"ghost",onClick:()=>h("none"),className:"h-6 w-6 p-0","data-test":"todo-sort-clear",children:o.jsx(pt,{className:"h-3 w-3"})})]})]}),o.jsx("div",{className:"todo-items flex-1 overflow-y-auto p-3 space-y-2","data-test":"todo-items-container",children:s.length===0?o.jsxs("div",{className:"empty-state text-center py-8 text-muted-foreground text-sm","data-test":"todo-empty-state",children:[t.status==="all"&&"No todos yet. Add one above!",t.status==="active"&&"No active todos.",t.status==="completed"&&"No completed todos."]}):s.map(n=>{var I;return o.jsxs("div",{className:`todo-item p-3 border rounded-lg flex items-center gap-3 transition-colors ${n.completed?"bg-green-50 dark:bg-green-950/30 border-green-200 dark:border-green-800":"bg-card border-border hover:border-primary/50"}`,"data-test":`todo-item-${n.id}`,children:[o.jsx("input",{type:"checkbox",checked:n.completed,onChange:()=>r(n.id),className:"w-4 h-4 cursor-pointer","data-test":`todo-checkbox-${n.id}`}),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[X===n.id?o.jsxs("div",{className:"flex gap-1","data-test":`todo-edit-group-${n.id}`,children:[o.jsx(yt,{type:"text",value:C,onChange:S=>B(S.target.value),onKeyDown:N,onBlur:W,autoFocus:!0,className:"text-sm h-7","data-test":`todo-edit-input-${n.id}`}),o.jsx(q,{size:"sm",variant:"ghost",onClick:W,className:"h-7 px-2 text-xs","data-test":`todo-edit-save-${n.id}`,children:"Save"}),o.jsx(q,{size:"sm",variant:"ghost",onClick:Y,className:"h-7 px-2 text-xs","data-test":`todo-edit-cancel-${n.id}`,children:"Cancel"})]}):o.jsx("span",{className:`text-sm ${n.completed?"line-through text-muted-foreground":"text-card-foreground"} ${u?"cursor-pointer hover:bg-muted/50 px-1 -mx-1 rounded":""}`,onClick:()=>J(n.id,n.text),"data-test":`todo-text-${n.id}`,children:n.text}),o.jsxs("div",{className:"todo-tags-section flex flex-col gap-1","data-test":`todo-tags-section-${n.id}`,children:[n.tags&&n.tags.length>0&&o.jsx("div",{className:"todo-tags flex flex-wrap gap-1","data-test":`todo-tags-${n.id}`,children:n.tags.map(S=>o.jsxs(Jt,{variant:"outline",className:"text-xs px-1.5 py-0 flex items-center gap-1 group","data-test":`todo-tag-${n.id}-${S}`,children:[o.jsx("span",{children:S}),l&&o.jsx("button",{onClick:()=>D(n.id,S),className:"opacity-0 group-hover:opacity-100 transition-opacity hover:text-red-600 dark:hover:text-red-400","data-test":`todo-tag-remove-${n.id}-${S}`,children:o.jsx(pt,{className:"h-2.5 w-2.5"})})]},S))}),T&&o.jsxs("div",{className:"todo-tag-input flex gap-1","data-test":`todo-tag-input-group-${n.id}`,children:[o.jsx(yt,{type:"text",placeholder:"Add tag...",value:P[n.id]||"",onChange:S=>z(Q=>({...Q,[n.id]:S.target.value})),onKeyPress:S=>M(S,n.id),className:"text-xs h-6 px-2","data-test":`todo-tag-input-${n.id}`}),o.jsx(q,{size:"sm",variant:"ghost",onClick:()=>K(n.id),disabled:!((I=P[n.id])!=null&&I.trim()),className:"h-6 w-6 p-0","data-test":`todo-tag-add-button-${n.id}`,children:o.jsx(Be,{className:"h-3 w-3"})})]})]})]}),x&&o.jsxs("select",{value:n.priority||"",onChange:S=>O(n.id,S.target.value),className:`text-xs h-7 px-2 bg-background border border-border rounded ${L(n.priority)}`,"data-test":`todo-priority-select-${n.id}`,children:[o.jsx("option",{value:"","data-test":`todo-priority-option-${n.id}-none`,children:"No priority"}),o.jsx("option",{value:"high","data-test":`todo-priority-option-${n.id}-high`,children:"High"}),o.jsx("option",{value:"medium","data-test":`todo-priority-option-${n.id}-medium`,children:"Medium"}),o.jsx("option",{value:"low","data-test":`todo-priority-option-${n.id}-low`,children:"Low"})]}),o.jsx(q,{size:"sm",variant:"ghost",onClick:()=>c(n.id),className:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300","data-test":`todo-delete-button-${n.id}`,children:"Delete"})]},n.id)})})]})}function ee({todoState:s,todoFacade:t}){const[e,a]=p.useState("none"),i=p.useMemo(()=>e==="none"?s.todos:e==="priority-desc"?t.sortByPriority(!0):e==="priority-asc"?t.sortByPriority(!1):e==="duedate-asc"?t.sortByDueDate(!0):e==="duedate-desc"?t.sortByDueDate(!1):s.todos,[s.todos,e,t]);return o.jsx("div",{className:"space-y-4","data-test":"todo-app-section-container",children:o.jsx(Xe,{todos:i,filter:s.filter,stats:s.stats,allTags:t.getAllTags(),onAddTodo:r=>t.addTodo(r),onToggleTodo:r=>t.toggleTodo(r),onDeleteTodo:r=>t.deleteTodo(r),onUpdateTodo:(r,c)=>t.updateTodo(r,c),onFilterChange:r=>t.setFilter(r),onClearCompleted:()=>t.clearCompleted(),onClearAll:()=>t.clearAll(),onAddTag:(r,c)=>t.addTag(r,c),onRemoveTag:(r,c)=>t.removeTag(r,c),onSetPriority:(r,c)=>{c?t.setPriority(r,c):t.clearPriority(r)},onSortChange:a,currentSort:e,onSearch:r=>t.search(r)})})}function Qe({todo:s,onUpdate:t,variant:e="ghost",size:a="icon",className:i="view-ticket-button",title:r="View Ticket","data-test":c}){var m;const[u,f]=p.useState(!1),[$,E]=p.useState(null),T=g=>{const j=g.currentTarget.getBoundingClientRect();E({x:j.left,y:j.top}),f(!0)},l=()=>{f(!1),E(null)},x=()=>{t&&t()},h=((m=s.customProps)==null?void 0:m.sessionIds)??[];return o.jsxs(o.Fragment,{children:[o.jsx(q,{variant:e,size:a,onClick:T,title:r,className:i,"data-test":c,children:o.jsxs("div",{className:"flex items-center gap-1.5","data-test":"view-ticket-button-content",children:[o.jsx(Ae,{className:"h-5 w-5","data-test":"view-ticket-icon"}),h.length>0&&o.jsx(fe,{sessionIds:h,showCount:h.length>1,"data-test":"view-ticket-session-activity"})]})}),o.jsx(Yt,{isVisible:u,onClose:l,title:s.title,shouldCloseManually:!0,resizable:!0,initialSize:{width:900,height:600},triggerPosition:$??void 0,className:"view-ticket-popover","data-test":"view-ticket-popover",children:o.jsx("div",{"data-test":"view-ticket-popover-content",className:"popover-content flex flex-col h-full overflow-hidden p-4",children:o.jsx(we,{todo:s,isOpen:u,onClose:l,onUpdate:x})})})]})}const Ze="src/lib/modules/self-improving/__specifications__/features/step-repository/feature.index.md",ts="src/lib/modules/self-improving/__docs__/architecture/bdd-testing-architecture.md",es=["node_modules","TestRunner.ts"],ss={"http://localhost:5173/":""},as={freezer:{className:"bg-cyan-100 text-cyan-800 border-cyan-200",label:"Freezer"},backlog:{className:"bg-gray-100 text-gray-800 border-gray-200",label:"Backlog"},selected:{className:"bg-yellow-100 text-yellow-800 border-yellow-200",label:"Selected"},doing:{className:"bg-blue-100 text-blue-800 border-blue-200",label:"Doing"},done:{className:"bg-green-100 text-green-800 border-green-200",label:"Done"},archive:{className:"bg-slate-100 text-slate-800 border-slate-200",label:"Archive"}};function se({testFailures:s,onClearFailures:t,onRunScenario:e}){const[a,i]=p.useState(new Map),r=p.useCallback(async()=>{try{await ut.init();const l=await ut.getAll(),x=new Map;for(const h of l)if(h.title.startsWith("[BDD] ")){const m=h.title.slice(6);x.set(m,h)}i(x)}catch(l){console.error("Failed to load linked tickets:",l)}},[]);p.useEffect(()=>{r()},[r,s]);const c=p.useCallback(()=>{r()},[r]),u=l=>{let x=l;for(const[h,m]of Object.entries(ss))x=x.replaceAll(h,m);return x},f=l=>{const x=l.split(`
`).filter(h=>!es.some(m=>h.includes(m))).join(`
`);return u(x)},$=l=>{const x=`[BDD] ${l.scenario}`,h=[`**Feature:** ${l.feature}`,`**Scenario:** ${l.scenario}`,l.failedStep?`**Failed Step:** ${l.stepType} ${l.failedStep}`:"",`**Error:** ${l.error}`,l.errorStack?`
**Stack Trace:**
\`\`\`
${f(l.errorStack)}
\`\`\``:""].filter(Boolean).join(`
`);return{title:x,description:h,category:"BDD Test Failure",tags:["bdd","test-failure",l.feature.toLowerCase().replace(/\s+/g,"-")]}},E=()=>{const l="[Feature] Add new BDD scenarios",x=`## Task
Add new feature scenarios to the BDD test suite.

## Reference Files
- **Feature Index**: \`@${Ze}\`
- **BDD Architecture**: \`@${ts}\`

## Current Features (5 total, 40 scenarios)
1. Todo CRUD Operations (8 scenarios)
2. Todo Filtering (7 scenarios)
3. Todo Tags (5 scenarios)
4. Todo Priority (10 scenarios)
5. Todo Due Dates (10 scenarios)

## Workflow
1. Create \`.feature\` file with Gherkin scenarios
2. Run \`npx tsx src/lib/testing/gherkin/cli.ts "src/**/*.feature"\`
3. Implement step definitions in \`todoSteps.ts\`
4. Register feature name in \`todoRegistry.ts\`
5. Test in browser at \`/demo/self-improving\`

## Ideas for New Features
- Todo subtasks/checklists
- Todo recurring/repeating
- Todo time tracking
- Todo attachments/notes
- Todo reminders/notifications
- Bulk operations (select multiple)
- Undo/redo operations
- Todo templates`;return{title:l,description:x,category:"Feature Request",tags:["bdd","feature","todo"]}},T=(l,x)=>{const h=[];if(h.push(`# BDD Test Failure - Debug Request
`),h.push(`**Feature:** ${l.feature}`),h.push(`**Scenario:** ${l.scenario}
`),l.failedStep&&h.push(`**Failed Step:** ${l.stepType} ${l.failedStep}
`),h.push(`**Error:** ${l.error}
`),x.includeStackTrace&&l.errorStack){const m=f(l.errorStack);m.trim()&&(h.push("**Stack Trace:**"),h.push("```"),h.push(m),h.push("```\n"))}return l.facadeState&&(h.push("**Facade State at Failure:**"),h.push("```json"),h.push(JSON.stringify(l.facadeState,null,2)),h.push("```\n")),h.push("## Task"),h.push("Please investigate this BDD test failure and:"),h.push("1. Identify the root cause of the failure"),h.push("2. Check the step definition implementation"),h.push("3. Verify the facade logic is correct"),h.push("4. Fix the issue and ensure the test passes"),h.push("5. Run the test to verify the fix"),h.join(`
`)};return o.jsx(xe,{storageKey:"test-results-config",initialConfig:{includeStackTrace:!0},"data-test":"todo-results-panel-config-panel",children:(l,x,h)=>o.jsxs("div",{className:"results-panel bg-card border border-border rounded-lg p-4","data-test":"todo-results-panel-main",children:[o.jsxs("div",{className:"results-header-section flex items-center justify-between mb-4","data-test":"todo-results-panel-header",children:[o.jsx("h3",{className:"text-lg font-semibold","data-test":"todo-results-panel-title",children:"ðŸ“Š BDD Test Execution Results"}),o.jsxs("div",{className:"header-actions flex items-center gap-2","data-test":"todo-results-panel-header-actions",children:[o.jsx(h,{title:"Test Results Configuration",buttonClassName:"config-button",variant:"ghost",size:"icon","data-test":"todo-results-panel-config-button",children:o.jsxs("div",{className:"config-panel-content space-y-3",onClick:m=>m.stopPropagation(),"data-test":"todo-results-panel-config-content",children:[o.jsxs("div",{className:"config-option flex items-center space-x-2","data-test":"todo-results-panel-config-option",children:[o.jsx(ve,{id:"include-stack-trace",checked:l.includeStackTrace,onCheckedChange:m=>x({...l,includeStackTrace:m===!0}),"data-test":"todo-results-panel-stack-trace-checkbox"}),o.jsx(ye,{htmlFor:"include-stack-trace",className:"text-sm font-medium leading-none cursor-pointer","data-test":"todo-results-panel-stack-trace-label",children:"Include stack trace"})]}),o.jsx("p",{className:"text-xs text-muted-foreground","data-test":"todo-results-panel-config-description",children:"When enabled, stack traces will be included in Claude debugging messages."})]})}),s.length>0&&o.jsx(q,{variant:"outline",size:"sm",onClick:t,className:"clear-failures-button text-xs","data-test":"todo-results-panel-clear-all-button",children:"Clear All"})]})]}),s.length===0?o.jsxs("div",{className:"empty-state text-center py-12","data-test":"todo-results-panel-empty-state",children:[o.jsx("div",{className:"text-5xl mb-4","data-test":"todo-results-panel-empty-icon",children:"âœ…"}),o.jsx("div",{className:"text-lg font-semibold text-green-600 dark:text-green-400 mb-2","data-test":"todo-results-panel-empty-title",children:"All Tests Passing"}),o.jsx("div",{className:"text-sm text-muted-foreground mb-6","data-test":"todo-results-panel-empty-description",children:"No failures detected. Run tests to see results here."}),o.jsxs("div",{className:"add-feature-section border-t border-border pt-6","data-test":"todo-results-panel-add-feature-section",children:[o.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-3","data-test":"todo-results-panel-add-feature-label",children:"Ready to expand the test suite?"}),o.jsx(Ht,{variant:"outline",size:"default",className:"add-feature-button inline-flex items-center gap-2",title:"Create ticket to add new BDD features",initialValues:E(),onTicketCreated:c,"data-test":"todo-results-panel-add-feature-button"}),o.jsx("div",{className:"text-xs text-muted-foreground mt-3","data-test":"todo-results-panel-add-feature-hint",children:"Creates a ticket with feature.index.md reference and BDD workflow"})]})]}):o.jsxs("div",{className:"test-failures-content","data-test":"todo-results-panel-failures-content",children:[o.jsxs("div",{className:"failures-header mb-4 pb-3 border-b border-border","data-test":"todo-results-panel-failures-header",children:[o.jsxs("div",{className:"text-destructive font-semibold","data-test":"todo-results-panel-failures-count",children:["âš ï¸ ",s.length," Test",s.length>1?"s":""," Failed"]}),o.jsx("div",{className:"text-xs text-muted-foreground mt-1","data-test":"todo-results-panel-failures-note",children:"Failures shown in scenario order"})]}),o.jsx("div",{className:"failures-list space-y-3 max-h-[600px] overflow-y-auto","data-test":"todo-results-panel-failures-list",children:s.map((m,g)=>{const j=a.get(m.scenario),k=j?as[j.status]:null;return o.jsxs("div",{"data-test":`failure-item-${g}`,"data-failure-id":m.id,className:"failure-item bg-destructive/5 border border-destructive/20 rounded-lg p-4 hover:bg-destructive/10 transition-colors",children:[o.jsxs("div",{className:"failure-header mb-3 flex items-start justify-between gap-3","data-test":`failure-item-header-${g}`,children:[o.jsxs("div",{className:"failure-info flex-1","data-test":`failure-item-info-${g}`,children:[o.jsxs("div",{className:"scenario-name text-sm font-semibold text-foreground mb-1 flex items-center gap-2","data-test":`failure-item-scenario-${g}`,children:[o.jsxs("span",{"data-test":`failure-item-scenario-name-${g}`,children:["Scenario: ",m.scenario]}),j&&k&&o.jsx(Jt,{variant:"outline",className:`ticket-status-badge text-xs ${k.className}`,"data-test":`failure-item-status-badge-${g}`,children:k.label})]}),o.jsxs("div",{className:"feature-name text-xs text-muted-foreground","data-test":`failure-item-feature-${g}`,children:["Feature: ",m.feature]})]}),o.jsxs("div",{className:"failure-actions flex items-center gap-1 flex-shrink-0","data-test":`failure-actions-${g}`,children:[e&&o.jsx(q,{variant:"outline",size:"sm",className:"run-scenario-button",title:"Re-run this scenario",onClick:async()=>{await e(m)},"data-test":`run-scenario-button-${g}`,children:o.jsx(Xt,{className:"h-3 w-3","data-test":`run-scenario-icon-${g}`})}),j?o.jsx(Qe,{todo:j,variant:"outline",size:"sm",className:"view-ticket-button",title:"View linked ticket",onUpdate:c,"data-test":`view-ticket-button-${g}`}):o.jsx(Ht,{variant:"outline",size:"sm",className:"create-ticket-button",title:"Create ticket from failure",initialValues:$(m),onTicketCreated:c,"data-test":`create-ticket-button-${g}`}),o.jsx(be,{variant:"outline",size:"sm",className:"send-to-claude-button",icon:o.jsx(Fe,{className:"h-3 w-3"}),buttonTitle:"Send failure to Claude for debugging",initialMessage:T(m,l),useModal:!0,"data-test":`send-to-claude-button-${g}`})]})]}),m.failedStep&&o.jsxs("div",{className:"failed-step bg-background/50 rounded p-2 mb-3","data-test":`failure-item-failed-step-${g}`,children:[o.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1","data-test":`failure-item-failed-step-label-${g}`,children:"Failed Step:"}),o.jsxs("div",{className:"text-sm font-mono","data-test":`failure-item-failed-step-content-${g}`,children:[o.jsx("span",{className:"text-primary font-semibold","data-test":`failure-item-step-type-${g}`,children:m.stepType})," ",o.jsx("span",{"data-test":`failure-item-step-text-${g}`,children:m.failedStep})]})]}),o.jsxs("div",{className:"error-section mb-3","data-test":`failure-item-error-section-${g}`,children:[o.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-1","data-test":`failure-item-error-label-${g}`,children:"Error:"}),o.jsx("div",{className:"error-message bg-destructive/10 border border-destructive/20 rounded p-3 text-sm font-mono text-destructive","data-test":`failure-item-error-message-${g}`,children:m.error})]}),m.errorStack&&(()=>{const P=f(m.errorStack);return P.trim()?o.jsxs("details",{className:"error-stack-section mb-3","data-test":`failure-item-error-stack-${g}`,children:[o.jsx("summary",{className:"text-xs font-semibold text-muted-foreground cursor-pointer hover:text-foreground","data-test":`failure-item-error-stack-summary-${g}`,children:"Stack Trace"}),o.jsx("pre",{className:"mt-2 bg-muted rounded p-2 text-xs font-mono overflow-x-auto","data-test":`failure-item-error-stack-content-${g}`,children:P})]}):null})(),o.jsxs("div",{className:"failure-footer flex items-center justify-between text-xs text-muted-foreground pt-2 border-t border-border","data-test":`failure-item-footer-${g}`,children:[o.jsxs("span",{"data-test":`failure-item-timestamp-${g}`,children:["Failed at ",new Date(m.timestamp).toLocaleTimeString()]}),m.stepIndex!==void 0&&o.jsxs("span",{"data-test":`failure-item-step-index-${g}`,children:["Step ",m.stepIndex+1]})]})]},m.id)})})]})]})})}function os({todoState:s,todoFacade:t,testFailures:e,selfImprovingFacade:a,onClearFailures:i,testRunner:r,onRemoveFailure:c,bddTestResults:u,onBddTestResults:f}){return o.jsxs("div",{className:"bdd-layout h-full flex gap-6","data-test":"bdd-tab-container",children:[o.jsx("div",{className:"specs-container flex-1 overflow-y-auto","data-test":"bdd-specs-container",children:o.jsx(Zt,{uiFacade:t||void 0,selfImprovingFacade:a,controlledTestResults:u,onTestResults:f})}),o.jsx("div",{className:"results-container flex-1 overflow-y-auto","data-test":"bdd-results-container",children:o.jsx(se,{testFailures:e,onClearFailures:i,onRunScenario:r?async $=>{const{GherkinData:E}=await ft(async()=>{const{GherkinData:l}=await Promise.resolve().then(()=>Qt);return{GherkinData:l}},void 0),T=E.find(l=>l.feature===$.feature);if(T){const l=T.scenarios.find(x=>x.scenario===$.scenario);l&&(await r.runScenario($.feature,l)).status==="pass"&&c&&c($)}}:void 0})})]})}function is({kanbanTodos:s}){return o.jsxs("div",{className:"kanban-list-container h-full p-4 md:p-6 overflow-y-auto","data-test":"kanban-container",children:[o.jsx("h2",{className:"kanban-title text-2xl font-bold mb-4","data-test":"kanban-title",children:"Kanban Tickets"}),s.length===0?o.jsx("div",{className:"empty-state text-center py-8 text-muted-foreground","data-test":"kanban-empty-state",children:"No kanban tickets yet. Test failures will appear here."}):o.jsx("div",{className:"kanban-todos-list space-y-3","data-test":"kanban-todos-list",children:s.map(t=>o.jsxs("div",{className:"kanban-todo-card bg-card border border-border rounded-lg p-4 hover:shadow-md transition-shadow","data-test":`kanban-todo-${t.id.value}`,children:[o.jsxs("div",{className:"todo-header flex items-start justify-between gap-3 mb-2","data-test":`kanban-todo-header-${t.id.value}`,children:[o.jsx("h3",{className:"todo-title text-lg font-semibold","data-test":`kanban-todo-title-${t.id.value}`,children:t.title}),o.jsx("span",{className:"todo-status text-xs px-2 py-1 rounded bg-muted","data-test":`kanban-todo-status-${t.id.value}`,children:t.status})]}),t.description&&o.jsx("div",{className:"todo-description text-sm text-muted-foreground mb-2 line-clamp-3","data-test":`kanban-todo-description-${t.id.value}`,children:t.description}),o.jsxs("div",{className:"todo-meta flex items-center gap-4 text-xs text-muted-foreground","data-test":`kanban-todo-meta-${t.id.value}`,children:[o.jsxs("span",{className:"todo-priority","data-test":`kanban-todo-priority-${t.id.value}`,children:["Priority: ",t.priority]}),o.jsx("span",{className:"todo-created","data-test":`kanban-todo-created-${t.id.value}`,children:new Date(t.createdAt.value).toLocaleString()}),t.tags.length>0&&o.jsx("div",{className:"todo-tags flex gap-1","data-test":`kanban-todo-tags-${t.id.value}`,children:t.tags.map(e=>o.jsx("span",{className:"tag px-2 py-0.5 rounded-full bg-primary/10 text-primary","data-test":`kanban-todo-tag-${t.id.value}-${e}`,children:e},e))})]})]},t.id.value))})]})}class rs extends Error{constructor(t,e){super(t),this.selector=e,this.name="E2EAssertionError"}}class Rt{constructor(t,e){V(this,"isNegated",!1);this.element=t,this.selector=e}get not(){const t=new Rt(this.element,this.selector);return t.isNegated=!this.isNegated,t}async toBeVisible(t=5e3){await this.waitForCondition(()=>Array.isArray(this.element)?this.element.length>0&&this.element.some(e=>this.isVisible(e)):this.element!==null&&this.isVisible(this.element),t,this.isNegated?"Expected element to be hidden":"Expected element to be visible")}async toBeHidden(t=5e3){await this.waitForCondition(()=>Array.isArray(this.element)?this.element.length===0||this.element.every(e=>!this.isVisible(e)):this.element===null||!this.isVisible(this.element),t,this.isNegated?"Expected element to be visible":"Expected element to be hidden")}async toBeEnabled(t=5e3){await this.waitForCondition(()=>{const e=this.getSingleElement();return e?!(e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true"):!1},t,this.isNegated?"Expected element to be disabled":"Expected element to be enabled")}async toBeDisabled(t=5e3){await this.waitForCondition(()=>{const e=this.getSingleElement();return e?e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true":!1},t,this.isNegated?"Expected element to be enabled":"Expected element to be disabled")}async toHaveText(t,e=5e3){await this.waitForCondition(()=>{var r;const a=this.getSingleElement();if(!a)return!1;const i=((r=a.textContent)==null?void 0:r.trim())||"";return typeof t=="string"?i===t:t.test(i)},e,this.isNegated?`Expected element not to have text "${t}"`:`Expected element to have text "${t}"`)}async toContainText(t,e=5e3){await this.waitForCondition(()=>{var r;const a=this.getSingleElement();return a?(((r=a.textContent)==null?void 0:r.trim())||"").includes(t):!1},e,this.isNegated?`Expected element not to contain text "${t}"`:`Expected element to contain text "${t}"`)}async toHaveValue(t,e=5e3){await this.waitForCondition(()=>{const a=this.getSingleElement();return a?(a.value||"")===t:!1},e,this.isNegated?`Expected element not to have value "${t}"`:`Expected element to have value "${t}"`)}async toHaveAttribute(t,e,a=5e3){await this.waitForCondition(()=>{const i=this.getSingleElement();if(!i)return!1;if(e===void 0)return i.hasAttribute(t);const r=i.getAttribute(t);return r===null?!1:typeof e=="string"?r===e:e.test(r)},a,this.isNegated?`Expected element not to have attribute "${t}"${e!==void 0?` with value "${e}"`:""}`:`Expected element to have attribute "${t}"${e!==void 0?` with value "${e}"`:""}`)}async toHaveClass(t,e=5e3){await this.waitForCondition(()=>{const a=this.getSingleElement();return a?a.classList.contains(t):!1},e,this.isNegated?`Expected element not to have class "${t}"`:`Expected element to have class "${t}"`)}async toHaveCount(t,e=5e3){await this.waitForCondition(()=>Array.isArray(this.element)?this.element.length===t:(this.element===null?0:1)===t,e,this.isNegated?`Expected not to have ${t} elements`:`Expected to have ${t} elements`)}async toBeFocused(t=5e3){await this.waitForCondition(()=>{const e=this.getSingleElement();return e?document.activeElement===e:!1},t,this.isNegated?"Expected element not to be focused":"Expected element to be focused")}async toBeChecked(t=5e3){await this.waitForCondition(()=>{const e=this.getSingleElement();return e?e.checked===!0:!1},t,this.isNegated?"Expected element not to be checked":"Expected element to be checked")}getSingleElement(){return Array.isArray(this.element)?this.element[0]||null:this.element}isVisible(t){const e=window.getComputedStyle(t);return e.display!=="none"&&e.visibility!=="hidden"&&e.opacity!=="0"&&t.offsetParent!==null}async waitForCondition(t,e,a){try{await le(()=>{const i=t();return this.isNegated?!i:i},e,100)}catch{throw new rs(`${a} (selector: ${this.selector})`,this.selector)}}}function ns(s,t){return new Rt(s,t)}class St{constructor(t,e=document,a=5e3){V(this,"element",null);V(this,"elements",[]);V(this,"isMultiple",!1);this.selector=t,this.context=e,this.timeoutMs=a}async waitFor(){return this.element=await ce(this.selector,this.timeoutMs,this.context),this.isMultiple=!1,this}get(){const t=this.context.querySelector(this.selector);if(!t)throw new Error(`Element not found: ${this.selector}`);return this.element=t,this.isMultiple=!1,this}getAll(){const t=Array.from(this.context.querySelectorAll(this.selector));return this.elements=t,this.isMultiple=!0,this}nth(t){this.isMultiple||this.getAll();const e=this.elements[t];if(!e)throw new Error(`Element at index ${t} not found: ${this.selector}`);return this.element=e,this.isMultiple=!1,this}first(){return this.nth(0)}last(){return this.isMultiple||this.getAll(),this.nth(this.elements.length-1)}async click(t){await this.ensureSingleElement();const e=Ut(this.element,"blue","ðŸ–±ï¸ Clicking");return await rt(500),await ue(this.element,t),await Tt(),e(),this}async type(t,e){await this.ensureSingleElement();const a=Ut(this.element,"green",`âŒ¨ï¸ Typing: "${t}"`);await rt(500);const i=this.element;return await he(i,t,e),await Tt(),a(),this}async clear(){await this.ensureSingleElement();const t=this.element;return await ge(t),await Tt(),this}async fill(t){return await this.clear(),await this.type(t),this}async scrollIntoView(t){return await this.ensureSingleElement(),await pe(this.element,t),this}async focus(){return await this.ensureSingleElement(),this.element.focus(),await rt(50),this}async blur(){return await this.ensureSingleElement(),this.element.blur(),await rt(50),this}async textContent(){var t;return await this.ensureSingleElement(),((t=this.element.textContent)==null?void 0:t.trim())||""}async innerText(){var t;return await this.ensureSingleElement(),((t=this.element.innerText)==null?void 0:t.trim())||""}async getAttribute(t){return await this.ensureSingleElement(),this.element.getAttribute(t)}async value(){return await this.ensureSingleElement(),this.element.value||""}async isVisible(){await this.ensureSingleElement();const t=window.getComputedStyle(this.element);return t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&this.element.offsetParent!==null}async isEnabled(){return await this.ensureSingleElement(),!(this.element.hasAttribute("disabled")||this.element.getAttribute("aria-disabled")==="true")}async isChecked(){return await this.ensureSingleElement(),this.element.checked===!0}async count(){return this.isMultiple||this.getAll(),this.elements.length}locator(t){const e=this.element||this.context;return new St(t,e,this.timeoutMs)}getElement(){return this.element}getElements(){return this.isMultiple?this.elements:this.element?[this.element]:[]}expect(){return ns(this.isMultiple?this.elements:this.element,this.selector)}async ensureSingleElement(){this.element||await this.waitFor()}}function ds(s,t){return new St(`[data-test="${s}"]`,t)}function ls(s,t){return new St(s,t)}class cs{getByTestId(t){return ds(t)}query(t){return ls(t)}async wait(t){return rt(t)}async waitForUpdate(t){return Tt(t)}async scrollToTop(){window.scrollTo({top:0,behavior:"smooth"}),await rt(200)}async scrollToBottom(){window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),await rt(200)}getCurrentUrl(){return window.location.href}async reload(){window.location.reload(),await rt(1e3)}async screenshot(t){console.log(`ðŸ“¸ Screenshot: ${t}`)}debug(t,e){console.log(`[E2E Debug] ${t}`,e||"")}assert(t,e){if(!t)throw new Error(`Assertion failed: ${e}`)}}class us extends cs{todoInput(){return this.getByTestId("todo-input")}addButton(){return this.getByTestId("todo-add-button")}todoItem(t){return this.getByTestId(`todo-item-${t}`)}todoCheckbox(t){return this.getByTestId(`todo-checkbox-${t}`)}todoText(t){return this.getByTestId(`todo-text-${t}`)}todoEditInput(t){return this.getByTestId(`todo-edit-input-${t}`)}todoEditSaveButton(t){return this.getByTestId(`todo-edit-save-${t}`)}todoDeleteButton(t){return this.getByTestId(`todo-delete-button-${t}`)}todoTags(t){return this.getByTestId(`todo-tags-${t}`)}todoTag(t,e){return this.getByTestId(`todo-tag-${t}-${e}`)}todoTagInput(t){return this.getByTestId(`todo-tag-input-${t}`)}todoTagAddButton(t){return this.getByTestId(`todo-tag-add-button-${t}`)}todoTagRemoveButton(t,e){return this.getByTestId(`todo-tag-remove-${t}-${e}`)}todoPrioritySelect(t){return this.getByTestId(`todo-priority-select-${t}`)}filterButton(t){return this.getByTestId(`todo-filter-${t}`)}clearCompletedButton(){return this.getByTestId("todo-clear-completed-button")}clearAllButton(){return this.getByTestId("todo-clear-all-button")}stats(t){return this.getByTestId(`todo-stats-${t}`)}allTodoItems(){return this.query('[data-test^="todo-item-"]').getAll()}async getTodoTextAtPosition(t){var c;const a=this.allTodoItems().getAll().getElements();if(t<0||t>=a.length)return null;const r=a[t].querySelector('[data-test^="todo-text-"]');return((c=r==null?void 0:r.textContent)==null?void 0:c.trim())||null}emptyState(){return this.getByTestId("todo-empty-state")}searchInput(){return this.getByTestId("todo-search-input")}searchClearButton(){return this.getByTestId("todo-search-clear")}async waitForDomUpdate(t){await this.waitForUpdate(t)}async addTodo(t){var l,x;const e=await this.allTodoItems().count(),a=this.todoInput().get().getElement();await this.todoInput().fill(t),await this.waitForUpdate(100);const i=this.addButton().get(),r=await i.isEnabled(),c=i.getElement();if(!r){const{highlightElement:h}=await ft(async()=>{const{highlightElement:k}=await import("./SpecView-zG6o8hbi.js").then(P=>P.E);return{highlightElement:k}},__vite__mapDeps([0,1,2,3,4,5,6,7])),m=h(a,"yellow",`ðŸ“ Input value: "${a==null?void 0:a.value}"`),g=h(c,"red","âŒ Button is DISABLED");await this.wait(3e3),m(),g();const j=["Add button is disabled.",`Input value: "${a==null?void 0:a.value}"`,`Input trimmed: "${(l=a==null?void 0:a.value)==null?void 0:l.trim()}"`,`Input length: ${(x=a==null?void 0:a.value)==null?void 0:x.length}`,`Text parameter: "${t}"`,`Input element: ${nt(a)}`,`Button element: ${nt(c)}`].join(`
`);throw new Error(j)}await this.addButton().click(),await this.waitForUpdate(100);const u=await this.allTodoItems().count();if(u!==e+1){const{highlightElement:h}=await ft(async()=>{const{highlightElement:g}=await import("./SpecView-zG6o8hbi.js").then(j=>j.E);return{highlightElement:g}},__vite__mapDeps([0,1,2,3,4,5,6,7]));throw this.allTodoItems().getAll().getElements().forEach((g,j)=>{h(g,"orange",`Todo #${j+1}`)}),await this.wait(2e3),new Error(`Todo was not added successfully. Expected ${e+1} todos but found ${u}`)}const $=this.allTodoItems().getAll().getElements()[u-1];return(($==null?void 0:$.getAttribute("data-test"))||"").replace("todo-item-","")}async toggleTodo(t){await this.todoCheckbox(t).click(),await this.waitForUpdate()}async updateTodo(t,e){await this.todoText(t).click(),await this.waitForUpdate(100),await this.todoEditInput(t).fill(e),await this.waitForUpdate(100),await this.todoEditSaveButton(t).click(),await this.waitForUpdate()}async deleteTodo(t){await this.todoDeleteButton(t).click(),await this.waitForUpdate()}async filterByStatus(t){await this.filterButton(t).click(),await this.waitForUpdate()}async search(t){await this.searchInput().fill(t),await this.waitForUpdate()}async clearSearch(){try{const t=this.searchClearButton().get();await t.isVisible()&&(await t.click(),await this.waitForUpdate())}catch{await this.searchInput().fill(""),await this.waitForUpdate()}}tagFilterSelect(){return this.getByTestId("todo-tag-filter-select")}async filterByTag(t){const e=this.tagFilterSelect().get().getElement();if(!e)throw new Error("Tag filter select not found. Make sure there are tags in the todo list.");const a=Array.from(e.options);if(!a.find(r=>r.value===t)){const r=a.map(c=>c.value).filter(c=>c!=="");throw new Error(`Tag "${t}" not found in filter. Available tags: ${r.join(", ")}`)}e.value=t,e.dispatchEvent(new Event("change",{bubbles:!0})),await this.waitForUpdate()}async clearCompleted(){await this.clearCompletedButton().click(),await this.waitForUpdate()}async clearAll(){await this.clearAllButton().click(),await this.waitForUpdate()}priorityFilterSelect(){return this.getByTestId("todo-priority-filter-select")}async filterByPriority(t){const e=this.priorityFilterSelect().get().getElement();if(!e)throw new Error("Priority filter select not found.");e.value=t,e.dispatchEvent(new Event("change",{bubbles:!0})),await this.waitForUpdate()}async findTodoByText(t){var i;const a=this.allTodoItems().getAll().getElements();for(const r of a){const c=r.querySelector('[data-test^="todo-text-"]');if(c&&((i=c.textContent)==null?void 0:i.trim())===t)return(r.getAttribute("data-test")||"").replace("todo-item-","")}return null}async todoHasTag(t,e){try{return await this.todoTag(t,e).get().isVisible()}catch{return!1}}async getTodoTags(t){var e;try{if(!await this.todoTags(t).get().isVisible())return[];const r=this.query(`[data-test^="todo-tag-${t}-"]`).getAll().getElements(),c=[];for(const u of r){const f=(e=u.textContent)==null?void 0:e.trim();f&&c.push(f)}return c}catch{return[]}}async getAllTags(){try{const t=this.tagFilterSelect().get().getElement();return t?Array.from(t.options).map(i=>i.value).filter(i=>i!==""):[]}catch{return[]}}async getTodoCount(t){const i=(await this.stats(t).innerText()).match(/(\d+)/);return i?parseInt(i[1],10):0}async isTodoCompleted(t){if(!document.querySelector(`[data-test="todo-item-${t}"]`))throw new Error(`Todo item not found in DOM: ${t}. It may have been deleted.`);return await this.todoCheckbox(t).get().isChecked()}async getTodoText(t){return await this.todoText(t).get().innerText()}async waitForTodoWithText(t,e=5e3){const a=Date.now();for(;Date.now()-a<e;){const i=await this.findTodoByText(t);if(i)return i;await this.wait(100)}throw new Error(`Todo with text "${t}" not found after ${e}ms`)}async addTagToTodo(t,e){const a=this.todoTagInput(t).get().getElement();await this.todoTagInput(t).fill(e),await this.waitForUpdate(100);const i=this.todoTagAddButton(t).get(),r=await i.isEnabled(),c=i.getElement();if(!r){const{highlightElement:u}=await ft(async()=>{const{highlightElement:T}=await import("./SpecView-zG6o8hbi.js").then(l=>l.E);return{highlightElement:T}},__vite__mapDeps([0,1,2,3,4,5,6,7])),f=u(a,"yellow",`ðŸ“ Input value: "${a==null?void 0:a.value}"`),$=u(c,"red","âŒ Tag Add Button is DISABLED");await this.wait(3e3),f(),$();const E=["Tag add button is disabled.",`Input value: "${a==null?void 0:a.value}"`,`Input element: ${nt(a)}`,`Button element: ${nt(c)}`,`TodoId: ${t}`,`Tag name: ${e}`].join(`
`);throw new Error(E)}await this.todoTagAddButton(t).click(),await this.waitForUpdate()}async removeTagFromTodo(t,e){await this.todoTag(t,e).get().scrollIntoView(),await this.todoTagRemoveButton(t,e).click(),await this.waitForUpdate()}async setPriority(t,e){const a=this.todoPrioritySelect(t).get().getElement();if(!a)throw new Error(`Priority select not found for todo ${t}`);a.value=e,a.dispatchEvent(new Event("change",{bubbles:!0})),await this.waitForUpdate()}async clearPriority(t){const e=this.todoPrioritySelect(t).get().getElement();if(!e)throw new Error(`Priority select not found for todo ${t}`);e.value="",e.dispatchEvent(new Event("change",{bubbles:!0})),await this.waitForUpdate()}sortSelect(){return this.getByTestId("todo-sort-select")}async sortByPriority(t=!0){const e=this.sortSelect().get().getElement();if(!e)throw new Error("Sort select not found. Make sure onSortChange prop is provided to TodoList.");const a=t?"priority-desc":"priority-asc";e.value=a,e.dispatchEvent(new Event("change",{bubbles:!0})),await this.waitForUpdate()}async sortByDueDate(t=!0){throw new Error("Due date sorting UI not yet implemented. The TodoList sort select only supports priority sorting. This scenario should be tested via unit tests until UI is implemented.")}async clearSort(){const t=this.sortSelect().get().getElement();if(!t)throw new Error("Sort select not found.");t.value="none",t.dispatchEvent(new Event("change",{bubbles:!0})),await this.waitForUpdate()}async getTodoPriority(t){try{const e=this.todoPrioritySelect(t).get().getElement();return(e==null?void 0:e.value)||null}catch{return null}}async clickViewTicketButton(t){await this.getByTestId(`view-ticket-button-${t}`).click(),await this.waitForUpdate(500)}async hasActivityDot(){try{return await this.getByTestId("activity-dot").get().isVisible()}catch{return!1}}async getDescriptionText(){try{const t=this.getByTestId("todo-details-description-field").get(),e=t.getElement();return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement?e.value:await t.innerText()}catch{return""}}async getSubtaskTitles(){var t;try{const e=this.query('[data-test^="todo-details-subtask-item-"]').getAll().getElements(),a=[];for(const i of e){const r=i.querySelector('[data-test^="todo-details-subtask-title-"]');if(r){const c=(t=r.textContent)==null?void 0:t.trim();c&&a.push(c)}}return a}catch{return[]}}async addSubtask(t){await this.getByTestId("todo-details-subtask-input").fill(t),await this.getByTestId("todo-details-subtask-add-button").click(),await this.waitForUpdate(300)}async closeTodoPanel(){const t=this.query(".close-button").get();await t.isVisible()&&(await t.click(),await this.waitForUpdate(300))}}function hs(){return{page:new us,todoMap:new Map}}const gs={[H["a todo facade"]]:async s=>{if(tt.getActive().clearAll(),s.todoMap.clear(),!document.querySelector('[data-test="todo-list"]'))throw new Error("Todo list not found in DOM")},[H["I have added a todo with text {string}"]]:async(s,t)=>{const e=await s.page.addTodo(t.string0);s.todoMap.set(t.string0,e)},[H["the todo is completed"]]:async s=>{const t=Array.from(s.todoMap.entries());if(t.length===0)throw new Error("No todo to complete");const[e,a]=t[t.length-1];await s.page.toggleTodo(a)},[H["todo {string} is completed"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);await s.page.toggleTodo(e)},[H["I am searching for {string}"]]:async(s,t)=>{await s.page.search(t.string0)},[H["todo {string} has priority {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);await s.page.setPriority(e,t.string1)},[H["today is {string}"]]:async(s,t)=>{throw new Error(`Date mocking ("today is ${t.string0}") is not applicable for E2E tests. E2E tests interact with the actual UI which uses system time. Use unit tests (todoSteps.ts) for date-relative filtering scenarios.`)},[H["todo {string} has due date {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);tt.getActive().setDueDate(e,t.string1),await s.page.waitForDomUpdate()},[b["I add a todo with text {string}"]]:async(s,t)=>{const e=await s.page.addTodo(t.string0);s.todoMap.set(t.string0,e)},[b["I add tag {string} to todo {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);await s.page.addTagToTodo(e,t.string0)},[b["I toggle the todo"]]:async s=>{const t=Array.from(s.todoMap.entries());if(t.length===0)throw new Error("No todo to toggle");const[e,a]=t[t.length-1];await s.page.toggleTodo(a)},[b["I update the todo text to {string}"]]:async(s,t)=>{const e=Array.from(s.todoMap.entries());if(e.length===0)throw new Error("No todo to update");const[a,i]=e[e.length-1];await s.page.updateTodo(i,t.string0),s.todoMap.delete(a),s.todoMap.set(t.string0,i)},[b["I delete the todo"]]:async s=>{const t=Array.from(s.todoMap.entries());if(t.length===0)throw new Error("No todo to delete");const[e,a]=t[t.length-1];await s.page.deleteTodo(a),s.todoMap.delete(e)},[b["I clear completed todos"]]:async s=>{const t=[];for(const[e,a]of s.todoMap.entries())await s.page.isTodoCompleted(a)&&t.push(e);await s.page.clearCompleted();for(const e of t)s.todoMap.delete(e)},[b["I clear all todos"]]:async s=>{await s.page.clearAll(),s.todoMap.clear()},[b["I filter by status {string}"]]:async(s,t)=>{await s.page.filterByStatus(t.string0)},[b["I search for {string}"]]:async(s,t)=>{await s.page.search(t.string0)},[b["I clear the search"]]:async s=>{await s.page.clearSearch()},[b["I filter by tag {string}"]]:async(s,t)=>{await s.page.filterByTag(t.string0)},[b["I get all tags"]]:async s=>{s.lastTagList=await s.page.getAllTags()},[b["I remove tag {string} from todo {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);await s.page.removeTagFromTodo(e,t.string0)},[b["I set priority {string} on todo {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);await s.page.setPriority(e,t.string0)},[b["I filter by priority {string}"]]:async(s,t)=>{await s.page.filterByPriority(t.string0)},[b["I clear priority from todo {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);await s.page.clearPriority(e)},[b["I show only high priority todos"]]:async s=>{await s.page.filterByPriority("high")},[b["I sort todos by priority descending"]]:async s=>{await s.page.sortByPriority(!0)},[b["I set due date {string} on todo {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string1);if(!e)throw new Error(`Todo "${t.string1}" not found`);tt.getActive().setDueDate(e,t.string0),await s.page.waitForDomUpdate()},[b["I remove due date from todo {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);tt.getActive().removeDueDate(e),await s.page.waitForDomUpdate()},[b["I filter by due date {string}"]]:async(s,t)=>{tt.getActive().filterByDueDate(t.string0),await s.page.waitForDomUpdate()},[b["I sort todos by due date ascending"]]:async s=>{await s.page.sortByDueDate(!0)},[y["the todo list should contain {int} todo"]]:async(s,t)=>{const e=await s.page.getTodoCount("total");if(e!==t.int0)throw new Error(`Expected ${t.int0} todo(s) but found ${e}`)},[y["the todo list should contain {int} todos"]]:async(s,t)=>{const e=await s.page.getTodoCount("total");if(e!==t.int0)throw new Error(`Expected ${t.int0} todos but found ${e}`)},[y["the todo should have text {string}"]]:async(s,t)=>{const e=Array.from(s.todoMap.entries());if(e.length===0)throw new Error("No todo to check");const[a,i]=e[e.length-1],r=await s.page.getTodoText(i);if(r!==t.string0)throw new Error(`Expected text "${t.string0}" but got "${r}"`)},[y["the todo should not be completed"]]:async s=>{const t=Array.from(s.todoMap.entries());if(t.length===0)throw new Error("No todo to check");const[e,a]=t[t.length-1];if(await s.page.isTodoCompleted(a))throw new Error("Expected todo not to be completed")},[y["the todo should be completed"]]:async s=>{const t=Array.from(s.todoMap.entries());if(t.length===0)throw new Error("No todo to check");const[e,a]=t[t.length-1];if(!await s.page.isTodoCompleted(a))throw new Error("Expected todo to be completed")},[y["the active count should be {int}"]]:async(s,t)=>{const e=await s.page.getTodoCount("active");if(e!==t.int0)throw new Error(`Expected ${t.int0} active todo(s) but found ${e}`)},[y["the completed count should be {int}"]]:async(s,t)=>{const e=await s.page.getTodoCount("completed");if(e!==t.int0)throw new Error(`Expected ${t.int0} completed todo(s) but found ${e}`)},[y["the total count should be {int}"]]:async(s,t)=>{const e=await s.page.getTodoCount("total");if(e!==t.int0)throw new Error(`Expected ${t.int0} total todo(s) but found ${e}`)},[y["the filtered list should contain {int} todo"]]:async(s,t)=>{const e=await s.page.allTodoItems().count();if(e!==t.int0)throw new Error(`Expected ${t.int0} visible todo(s) but found ${e}`)},[y["the filtered list should contain {int} todos"]]:async(s,t)=>{const e=await s.page.allTodoItems().count();if(e!==t.int0)throw new Error(`Expected ${t.int0} visible todos but found ${e}`)},[y["the filtered list should contain {string}"]]:async(s,t)=>{if(!await s.page.findTodoByText(t.string0))throw new Error(`Expected to find todo with text "${t.string0}"`)},[y["todo {string} should have tag {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);if(!await s.page.todoHasTag(e,t.string1))throw new Error(`Expected todo "${t.string0}" to have tag "${t.string1}"`)},[y["todo {string} should not have tag {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);if(await s.page.todoHasTag(e,t.string1))throw new Error(`Expected todo "${t.string0}" not to have tag "${t.string1}"`)},[y["the tag list should contain {string}"]]:async(s,t)=>{if(!s.lastTagList)throw new Error('No tag list available - call "I get all tags" first');if(!s.lastTagList.includes(t.string0))throw new Error(`Expected tag list to contain "${t.string0}"`)},[y["the tag list should have {int} unique tags"]]:async(s,t)=>{if(!s.lastTagList)throw new Error('No tag list available - call "I get all tags" first');if(s.lastTagList.length!==t.int0)throw new Error(`Expected ${t.int0} unique tags but found ${s.lastTagList.length}`)},[y["todo {string} should have priority {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=await s.page.getTodoPriority(e);if(a!==t.string1)throw new Error(`Expected priority "${t.string1}" but got "${a}"`)},[y["todo {string} should have no priority"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const a=await s.page.getTodoPriority(e);if(a&&a!=="")throw new Error(`Expected no priority but got "${a}"`)},[y["the first todo should be {string}"]]:async(s,t)=>{const e=t.string0,a=await s.page.getTodoTextAtPosition(0);if(a!==e)throw new Error(`Expected first todo to be "${e}" but got "${a}"`)},[y["the second todo should be {string}"]]:async(s,t)=>{const e=t.string0,a=await s.page.getTodoTextAtPosition(1);if(a!==e)throw new Error(`Expected second todo to be "${e}" but got "${a}"`)},[y["the third todo should be {string}"]]:async(s,t)=>{const e=t.string0,a=await s.page.getTodoTextAtPosition(2);if(a!==e)throw new Error(`Expected third todo to be "${e}" but got "${a}"`)},[y["todo {string} should have due date {string}"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const i=tt.getActive().getDueDate(e);if(i!==t.string1)throw new Error(`Expected due date "${t.string1}" but got "${i}"`)},[y["todo {string} should have no due date"]]:async(s,t)=>{const e=s.todoMap.get(t.string0);if(!e)throw new Error(`Todo "${t.string0}" not found`);const i=tt.getActive().getDueDate(e);if(i)throw new Error(`Expected no due date but got "${i}"`)}},Lt=new zt;Lt.register("todo-e2e",{features:["Todo CRUD Operations","Todo Filtering","Todo Tags","Todo Priority","Todo Due Dates"],createContext:()=>hs(),stepDefinitions:gs});function ae({storageKey:s="e2e-spec-view",onTestResults:t,controlledTestResults:e,selfImprovingFacade:a}){const i=Ft(),r=p.useCallback(f=>{i("/demo/self-improving/e2e/results")},[i]),c=p.useMemo(()=>{try{return{todo:tt.getActive()}}catch{return{}}},[]),u=p.useMemo(()=>({registry:Lt,features:wt,facades:c,selfImprovingFacade:a,enableStepByStep:!0}),[c,a]);return o.jsx(Mt,{config:u,storageKey:s,onTestResults:t,onGoToError:r,controlledTestResults:e})}function ps({todoState:s,todoFacade:t,testFailures:e,selfImprovingFacade:a,onClearFailures:i,onRemoveFailure:r,defaultTab:c="tests"}){const u=Ft(),f=p.useRef(null);p.useEffect(()=>{const l=Z.loadE2ESpeed();me(l);const x=()=>{try{return{todo:tt.getActive()}}catch{return{}}};f.current=new Kt(Lt,x(),a)},[a]);const[$,E]=p.useState(new Map),T=l=>{u(l==="results"?"/demo/self-improving/e2e/results":"/demo/self-improving/e2e")};return o.jsxs("div",{className:"e2e-layout h-full flex flex-col lg:flex-row gap-6","data-test":"e2e-tab-container",children:[o.jsx("div",{className:"todo-app-container flex-1 lg:flex-[0.4] flex flex-col min-w-0 overflow-y-auto","data-test":"e2e-todo-app-container",children:s&&t&&o.jsx(ee,{todoState:s,todoFacade:t})}),o.jsx("div",{className:"test-panel-container flex-1 lg:flex-[0.6] flex flex-col min-w-0","data-test":"e2e-test-panel-container",children:o.jsxs(Bt,{value:c,onValueChange:T,className:"flex-1 flex flex-col min-h-0","data-test":"e2e-panel-tabs",children:[o.jsxs(At,{className:"grid w-full grid-cols-2 mb-4","data-test":"e2e-panel-tabs-list",children:[o.jsx(ot,{value:"tests","data-test":"e2e-panel-tests-tab",children:"E2E Tests"}),o.jsxs(ot,{value:"results","data-test":"e2e-panel-results-tab",children:["Results (",e.length,")"]})]}),o.jsx(it,{value:"tests",className:"flex-1 min-h-0 mt-0 overflow-y-auto","data-test":"e2e-panel-tests-content",children:o.jsx(ae,{storageKey:"self-improving-e2e",onTestResults:E,controlledTestResults:$,selfImprovingFacade:a})}),o.jsx(it,{value:"results",className:"flex-1 min-h-0 mt-0 overflow-y-auto","data-test":"e2e-panel-results-content",children:o.jsx(se,{testFailures:e,onClearFailures:i,onRunScenario:async l=>{const x=f.current;if(!x)return;const{GherkinData:h}=await ft(async()=>{const{GherkinData:g}=await Promise.resolve().then(()=>Qt);return{GherkinData:g}},void 0),m=h.find(g=>g.feature===l.feature);if(m){const g=m.scenarios.find(j=>j.scenario===l.scenario);if(g){const j=await x.runScenario(l.feature,g);E(k=>{const P=new Map(k);return P.set(`${l.feature}::${l.scenario}`,j),P}),j.status==="pass"&&r&&r(l)}}}})})]})})]})}const w=new Pt("SelfImprove",{log:!0,shouldLogConfig:{log:!0,maxLevel:10}}),ms=s=>`[BDD] ${s}`,jt=(s,t)=>{const e=[];if(e.push(`# BDD Test Failure - Debug Request (Run #${t})
`),e.push(`**Feature:** ${s.feature}`),e.push(`**Scenario:** ${s.scenario}
`),s.failedStep&&e.push(`**Failed Step:** ${s.stepType} ${s.failedStep}
`),e.push(`**Error:** ${s.error}
`),s.errorStack){const a=s.errorStack.split(`
`).filter(i=>!i.includes("node_modules")).join(`
`);a.trim()&&(e.push("**Stack Trace:**"),e.push("```"),e.push(a),e.push("```\n"))}return e.push("## Task"),e.push("Please investigate this BDD test failure and:"),e.push("1. Identify the root cause of the failure"),e.push("2. Check the step definition implementation"),e.push("3. Verify the facade logic is correct"),e.push("4. Fix the issue and ensure the test passes"),e.push("5. Run the test to verify the fix"),e.join(`
`)};function Gt({testFailures:s,testRunner:t,features:e,projectPath:a,dryRun:i=!1,onTicketCreated:r,onTestsReRun:c}){const[u,f]=p.useState(!1),[$,E]=p.useState(null),[T,l]=p.useState({current:0,total:0,phase:"idle"}),[x,h]=p.useState(null),m=p.useRef(!1),g=p.useCallback(async C=>{await ut.init();const B=await ut.getAll(),A=ms(C);return B.find(F=>F.title===A)??null},[]),j=p.useCallback(async C=>{await Wt.createTestFailureTicket(C),r==null||r(),await new Promise(A=>setTimeout(A,100));const B=await g(C.scenario);if(!B)throw new Error(`Failed to create ticket for scenario: ${C.scenario}`);return B},[g,r]),k=p.useCallback(async(C,B,A)=>{var K;const F=((K=C.customProps)==null?void 0:K.sessionIds)??[];if(F.length>0){const M=F[0],D=jt(B,A);return await Vt.sendMessage({sessionId:M,message:D,options:{permissionMode:"acceptEdits"}}),M}else{const M=jt(B,A),D=await Vt.createSession({message:M,cwd:a,projectId:a,options:{permissionMode:"acceptEdits"}});if(!D.success||!D.sessionId)throw new Error(D.error??"Failed to create Claude session");return await Wt.claude.linkSessionToTodo(C.id,D.sessionId,{mode:"append"}),D.sessionId}},[a]),P=p.useCallback(async(C,B,A,F)=>{const K=A?`Run #${B}: PASS`:`Run #${B}: FAIL - ${(F==null?void 0:F.slice(0,100))??"Unknown error"}`;await Te.addSubtask(C.id,{title:K})},[]),z=p.useCallback(async C=>{if(!t)return{passed:!1,error:"TestRunner not available"};const B=e.find(F=>F.feature===C.feature);if(!B)return{passed:!1,error:`Feature not found: ${C.feature}`};const A=B.scenarios.find(F=>F.scenario===C.scenario);if(!A)return{passed:!1,error:`Scenario not found: ${C.scenario}`};try{const F=await t.runScenario(C.feature,A);return{passed:F.status==="pass",error:F.error}}catch(F){return{passed:!1,error:F instanceof Error?F.message:String(F)}}},[t,e]),X=p.useCallback(async()=>{var B,A,F,K;if(u)return;if(s.length===0){h("No test failures to process");return}i&&(w.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),w.log("ðŸ” SELF-IMPROVE DRY RUN - Starting"),w.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),w.log(`ðŸ“Š Total failures to process: ${s.length}`),w.log(`ðŸ“ Project path: ${a??"default"}`),w.log("")),f(!0),h(null),m.current=!1;const C=s.length;l({current:0,total:C,phase:"checking"});try{for(let M=0;M<s.length;M++){if(m.current){i&&w.log("â›” Cancelled by user");break}const D=s[M];E(D.scenario),l({current:M+1,total:C,phase:"checking"}),i&&(w.log("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"),w.log(`ðŸ“‹ Failure ${M+1}/${C}`),w.log("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"),w.log(`  Feature:  ${D.feature}`),w.log(`  Scenario: ${D.scenario}`),w.log(`  Error:    ${D.error.slice(0,100)}${D.error.length>100?"...":""}`),D.failedStep&&w.log(`  Failed Step: ${D.stepType} ${D.failedStep}`),w.log("")),i&&w.log("  [Step 1] ðŸ”Ž Checking for existing ticket...");let O=await g(D.scenario),J=1;if(O?(J=(((B=O.subtasks)==null?void 0:B.length)??0)+1,i&&(w.log(`    â†’ Found existing ticket: ${O.id}`),w.log(`    â†’ Ticket title: ${O.title}`),w.log(`    â†’ Existing subtasks: ${((A=O.subtasks)==null?void 0:A.length)??0}`),w.log(`    â†’ This would be Run #${J}`),w.log(""))):(l({current:M+1,total:C,phase:"creating-ticket"}),i?(w.log(`    â†’ No existing ticket found for "${D.scenario}"`),w.log(`    â†’ Would create ticket: "[BDD] ${D.scenario}"`),w.log("")):O=await j(D)),m.current)break;l({current:M+1,total:C,phase:"re-running"}),i&&(w.log("  [Step 2] ðŸ”„ Re-running scenario..."),w.log(`    â†’ Would run: ${D.feature} > ${D.scenario}`));const W=i?{passed:!1,error:D.error}:await z(D);if(i&&(w.log("    â†’ (Dry run: skipping actual test execution)"),w.log("    â†’ Using original error for simulation"),w.log("")),i){w.log("  [Step 3] ðŸ“ Recording run result...");const Y=W.passed?`Run #${J}: PASS`:`Run #${J}: FAIL - ${((F=W.error)==null?void 0:F.slice(0,50))??"Unknown error"}...`;w.log(`    â†’ Would add subtask: "${Y}"`),w.log("")}else await P(O,J,W.passed,W.error);if(W.passed){i&&(w.log("  âœ… Test would pass! Moving to next failure..."),w.log(""));continue}if(m.current)break;if(l({current:M+1,total:C,phase:"sending-to-claude"}),i){w.log("  [Step 4] ðŸ¤– Sending to Claude...");const Y=((K=O==null?void 0:O.customProps)==null?void 0:K.sessionIds)??[];Y.length>0?(w.log(`    â†’ Would reuse existing session: ${Y[0]}`),w.log("    â†’ Would send follow-up message")):(w.log("    â†’ Would create new Claude session"),w.log("    â†’ Permission mode: acceptEdits")),w.log("    â†’ Message preview:"),jt({...D,error:W.error??D.error},J).split(`
`).slice(0,8).forEach(L=>{w.log(`      ${L}`)}),w.log("      ...(truncated)"),w.log(""),w.log("  [Step 5] â³ Would wait for Claude response (5s delay)"),w.log("")}else await k(O,{...D,error:W.error??D.error},J),l({current:M+1,total:C,phase:"waiting-response"}),await new Promise(Y=>setTimeout(Y,5e3));c==null||c()}i&&(w.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),w.log("âœ… DRY RUN COMPLETE"),w.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),w.log(`Processed ${s.length} failure(s)`),w.log("No changes were made to tickets or Claude sessions."),w.log(""))}catch(M){h(M instanceof Error?M.message:String(M)),i&&w.log("âŒ DRY RUN ERROR:",M instanceof Error?M.message:String(M))}finally{f(!1),E(null),l({current:0,total:0,phase:"idle"})}},[u,s,i,a,g,j,z,P,k,c]),et=p.useCallback(()=>{m.current=!0},[]);return{isRunning:u,currentScenario:$,progress:T,error:x,start:X,cancel:et}}const st=new Pt("UIMode",{log:!0,shouldLogConfig:{log:!0,maxLevel:10}}),Nt=s=>new Promise(t=>setTimeout(t,s)),bt=()=>{document.querySelectorAll(".ui-mode-highlight").forEach(s=>{s.classList.remove("ui-mode-highlight")})};function fs({testFailures:s,onComplete:t}){const[e,a]=p.useState(!1),[i,r]=p.useState({current:0,total:0,phase:"idle",message:""}),[c,u]=p.useState(null),f=p.useRef(!1),$=p.useCallback(async()=>{if(e)return;if(s.length===0){u("No test failures to process"),await Nt(2e3),u(null);return}st.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),st.log("ðŸŽ¬ UI MODE - Starting Visual Walkthrough"),st.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),st.log(`ðŸ“Š Total failures to process: ${s.length}`),Ke(),a(!0),f.current=!1,bt();const T=s.length;r({current:0,total:T,phase:"idle",message:"Starting..."});try{for(let l=0;l<s.length;l++){if(f.current){st.log("â›” UI Mode cancelled by user");break}const x=s[l];r({current:l+1,total:T,phase:"scrolling",message:`Processing failure ${l+1}...`}),await Je.processFailure({failure:x,failureIndex:l,setStatusMessage:u,cancelRequested:()=>f.current}),bt()}st.log(""),st.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),st.log("âœ… UI MODE COMPLETE"),st.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),u("UI Mode walkthrough complete!"),await Nt(2e3),t==null||t()}catch(l){st.log(`âŒ UI MODE ERROR: ${l instanceof Error?l.message:String(l)}`),u(`Error: ${l instanceof Error?l.message:String(l)}`),await Nt(3e3)}finally{bt(),a(!1),u(null),r({current:0,total:0,phase:"idle",message:""})}},[e,s,t]),E=p.useCallback(()=>{f.current=!0,bt()},[]);return{isRunning:e,progress:i,statusMessage:c,start:$,cancel:E}}function ws(s){if(s.length===0)return[];const t=[];let e=null;for(const a of s)e&&e.message===a.message?(e.count++,e.lastTimestamp=a.timestamp):(e&&t.push(e),e={firstTimestamp:a.timestamp,lastTimestamp:a.timestamp,message:a.message,count:1});return e&&t.push(e),t}function Es({logger:s}){const t=Ft(),e=de(),[a,i]=p.useState(null),[r,c]=p.useState([]),[u,f]=p.useState(()=>Z.loadTestFailures()),[$,E]=p.useState(()=>Z.loadBDDTestResults()),[T,l]=p.useState(!1),[x,h]=p.useState(()=>d.getLogs()),m=p.useMemo(()=>ws(x),[x]),[g,j]=p.useState(()=>Z.loadUIModeStepDelay()),k=p.useRef(null),P=p.useRef(null),z=p.useRef(null),X=p.useRef(null);p.useEffect(()=>{k.current&&(X.current=new Kt(It,{todo:k.current},z.current??void 0))},[a]);const et=p.useMemo(()=>[...wt],[]),C=Gt({testFailures:u,testRunner:X.current,features:et,dryRun:!1,onTicketCreated:()=>{},onTestsReRun:()=>{}}),B=Gt({testFailures:u,testRunner:X.current,features:et,dryRun:!0,onTicketCreated:()=>{},onTestsReRun:()=>{}}),A=fs({testFailures:u,onComplete:()=>{}}),F=C.isRunning||B.isRunning||A.isRunning,K=()=>e.pathname.endsWith("/bdd")?"bdd":e.pathname.endsWith("/kanban")?"kanban":e.pathname.includes("/e2e")?"e2e":"all",M=()=>e.pathname.endsWith("/e2e/results")?"results":"tests",D=K(),O=M(),J=N=>{t(N==="all"?"/demo/self-improving":`/demo/self-improving/${N}`)};p.useEffect(()=>{Z.saveTestFailures(u)},[u]),p.useEffect(()=>{Z.saveBDDTestResults($)},[$]),p.useEffect(()=>{z.current=new Ue;const N=z.current.onTestFailure(L=>{f(n=>{const I=n.filter(S=>!(S.feature===L.feature&&S.scenario===L.scenario));return[L,...I]})});return()=>{N()}},[]);const W=()=>{f([]),Z.clearTestFailures()},Y=N=>{f(L=>L.filter(n=>!(n.feature===N.feature&&n.scenario===N.scenario)))};return p.useEffect(()=>{k.current=new Oe;const N=k.current.onChange(L=>{i(L)});return i(k.current.getState()),tt.register(k.current),s==null||s.info("Todo BDD demo initialized"),()=>{var L;N(),(L=k.current)==null||L.dispose(),tt.unregister()}},[s]),p.useEffect(()=>{P.current=new ke;const N=async()=>{await ut.init();const I=(await ut.getAll()).sort((S,Q)=>{const ht=new Date(S.createdAt.value).getTime();return new Date(Q.createdAt.value).getTime()-ht});c(I)};N();const L=setInterval(N,2e3);return()=>{clearInterval(L)}},[]),o.jsxs("div",{className:"self-improving-demo-page flex-1 flex flex-col h-full bg-background text-foreground","data-test":"self-improving-demo-page-main",children:[A.statusMessage&&o.jsx("div",{className:"ui-mode-status","data-test":"ui-mode-status-message",children:A.statusMessage}),o.jsxs(Bt,{value:D,onValueChange:J,className:"tabs-container flex-1 flex flex-col h-full","data-test":"self-improving-main-tabs",children:[o.jsx("div",{className:"page-header px-4 md:px-6 py-2 flex-shrink-0 border-b border-border","data-test":"self-improving-page-header",children:o.jsxs("div",{className:"header-section flex items-center justify-between gap-3","data-test":"header-section",children:[o.jsxs(At,{className:"tabs-list","data-test":"header-tabs-list",children:[o.jsx(ot,{value:"all","data-test":"header-tab-all",children:"All"}),o.jsx(ot,{value:"bdd","data-test":"header-tab-bdd",children:"BDD"}),o.jsx(ot,{value:"kanban","data-test":"header-tab-kanban",children:"Kanban"}),o.jsx(ot,{value:"e2e","data-test":"header-tab-e2e",children:"E2E"})]}),F?o.jsxs(q,{variant:"destructive",size:"sm",onClick:()=>{C.cancel(),B.cancel(),A.cancel()},className:"self-improve-button",title:`Cancel (${C.progress.current||B.progress.current||A.progress.current}/${C.progress.total||B.progress.total||A.progress.total})`,"data-test":"header-cancel-button",children:[o.jsx(Me,{className:"h-4 w-4 mr-2","data-test":"header-cancel-icon"}),"Cancel"]}):o.jsxs(o.Fragment,{children:[o.jsx(Ie,{onClick:C.start,label:"Self Improve",icon:Xt,variant:"default",size:"sm",className:"self-improve-button",disabled:u.length===0,options:[{label:"Dry Run",onClick:B.start},{label:"Show Logs",onClick:()=>{h(d.getLogs()),l(!0)}}],"data-test":"header-self-improve-split-button"}),o.jsx(Se,{label:o.jsxs(o.Fragment,{children:[o.jsx(Pe,{className:"h-4 w-4 mr-1"}),"UI Mode"]}),onAction:A.start,variant:"outline",size:"sm",disabled:u.length===0,tooltipText:`UI Mode (${g}ms) - Hold to configure speed`,popoverContent:o.jsxs("div",{className:"space-y-2","data-test":"ui-mode-speed-config",children:[o.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Step Delay (ms)"}),o.jsx("div",{className:"flex gap-1",children:[100,200,500,1e3].map(N=>o.jsx(q,{variant:g===N?"default":"outline",size:"sm",onClick:()=>{j(N),Z.saveUIModeStepDelay(N)},"data-test":`ui-mode-speed-${N}`,children:N},N))})]}),"data-test":"header-ui-mode-button"})]}),k.current&&o.jsx(He,{config:{registry:It,features:[...wt],facades:{todo:k.current},enableStepByStep:!0},label:"BDD Tests",variant:"outline",size:"sm",popoverTitle:"ðŸ“‹ Todo BDD Test Specifications",initialSize:{width:600,height:700},storageKey:"self-improving-todo-specs","data-test":"header-bdd-specs-button"})]})}),o.jsxs(it,{value:"all",className:"tab-content-all flex-1 flex flex-col lg:flex-row gap-6 min-h-0 mt-0 data-[state=inactive]:hidden","data-test":"self-improving-tab-all",children:[o.jsx("div",{className:"todo-app-section flex-1 flex flex-col min-w-0 overflow-y-auto","data-test":"self-improving-todo-app-section",children:a&&k.current&&o.jsx(ee,{todoState:a,todoFacade:k.current})}),o.jsx("div",{className:"specs-section flex-1 flex flex-col min-w-0","data-test":"self-improving-specs-section",children:o.jsxs(Bt,{defaultValue:"bdd",className:"flex-1 flex flex-col min-h-0","data-test":"all-view-specs-tabs",children:[o.jsxs(At,{className:"grid w-full grid-cols-2 mb-4","data-test":"all-view-specs-tabs-list",children:[o.jsx(ot,{value:"bdd","data-test":"all-view-bdd-tab",children:"BDD Tests"}),o.jsx(ot,{value:"e2e","data-test":"all-view-e2e-tab",children:"E2E Tests"})]}),o.jsx(it,{value:"bdd",className:"flex-1 min-h-0 mt-0 data-[state=inactive]:hidden overflow-y-auto","data-test":"all-view-bdd-content",children:o.jsx(Zt,{uiFacade:k.current||void 0,controlledTestResults:$,onTestResults:E})}),o.jsx(it,{value:"e2e",className:"flex-1 min-h-0 mt-0 data-[state=inactive]:hidden overflow-y-auto","data-test":"all-view-e2e-content",children:o.jsx(ae,{storageKey:"self-improving-all-view-e2e"})})]})})]}),o.jsx(it,{value:"bdd",className:"tab-content-bdd flex-1 min-h-0 mt-0 data-[state=inactive]:hidden","data-test":"self-improving-tab-bdd",children:a&&k.current&&o.jsx(os,{todoState:a,todoFacade:k.current,testFailures:u,selfImprovingFacade:z.current||void 0,onClearFailures:W,testRunner:X.current,onRemoveFailure:Y,bddTestResults:$,onBddTestResults:E})}),o.jsx(it,{value:"kanban",className:"tab-content-kanban flex-1 min-h-0 mt-0 data-[state=inactive]:hidden","data-test":"self-improving-tab-kanban",children:o.jsx(is,{kanbanTodos:r})}),o.jsx(it,{value:"e2e",className:"tab-content-e2e flex-1 min-h-0 mt-0 data-[state=inactive]:hidden","data-test":"self-improving-tab-e2e",children:a&&k.current&&o.jsx(ps,{todoState:a,todoFacade:k.current,testFailures:u,selfImprovingFacade:z.current||void 0,onClearFailures:W,onRemoveFailure:Y,defaultTab:O})})]}),o.jsx(Ce,{open:T,onOpenChange:l,children:o.jsxs(Ee,{className:"max-w-2xl max-h-[80vh] flex flex-col","data-test":"logs-dialog",children:[o.jsx($e,{className:"flex-shrink-0",children:o.jsxs(De,{className:"flex items-center gap-2","data-test":"logs-dialog-title",children:[o.jsx(Re,{className:"h-5 w-5"}),"Self-Improve Logs"]})}),o.jsx("div",{className:"flex-1 overflow-y-auto min-h-0","data-test":"logs-dialog-content",children:m.length===0?o.jsx("p",{className:"text-muted-foreground text-sm","data-test":"logs-empty-message",children:"No logs recorded yet. Run Self Improve to capture logs."}):o.jsx("div",{className:"space-y-1 font-mono text-xs","data-test":"logs-list",children:m.map((N,L)=>o.jsxs("div",{className:"p-2 rounded bg-muted/50","data-test":`log-entry-${L}`,children:[o.jsxs("span",{className:"text-muted-foreground",children:["[",new Date(N.firstTimestamp).toLocaleTimeString(),"]"]})," ",N.message,N.count>1&&o.jsxs("span",{className:"ml-2 text-amber-500 font-medium",children:["(x",N.count,")"]})]},`${N.firstTimestamp}-${L}`))})}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t flex-shrink-0","data-test":"logs-dialog-actions",children:[o.jsxs(q,{variant:"outline",size:"sm",onClick:()=>{d.clear(),h([])},disabled:x.length===0,"data-test":"logs-clear-button",children:[o.jsx(Le,{className:"h-4 w-4 mr-2"}),"Clear Logs"]}),o.jsx(q,{variant:"default",size:"sm",onClick:()=>l(!1),"data-test":"logs-close-button",children:"Close"})]})]})})]})}export{Es as SelfImprovingDemoPage};
