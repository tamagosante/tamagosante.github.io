import{r as e,j as a}from"./react-vendor-CrhW4DYn.js";import{w as N,I as T,A as k}from"./index-CgyRe94A.js";import{T as y}from"./textarea-DhMMW6X3.js";import{y as R,h as $}from"./icons-6Gjq1X59.js";const A=e.forwardRef(({value:i,onChange:n,placeholder:d="Type your message...",disabled:p=!1,multiline:r=!1,className:u="",onKeyPress:c},l)=>{const[s,g]=e.useState(!1),[h,m]=e.useState(0),[f,b]=e.useState(0),[C,o]=e.useState(!1),S=e.useCallback(t=>{(t.transcriptionStatus==="pending"||t.transcriptionStatus==="processing")&&o(!0)},[]),x=e.useCallback(t=>{if(t.transcription){const I=i.trim()?" ":"";n(i+I+t.transcription),o(!1)}else t.transcriptionStatus==="failed"&&o(!1)},[i,n]),w=e.useCallback(t=>{g(t)},[]),j=e.useCallback(()=>{s?b(t=>t+1):m(t=>t+1)},[s]),v=r?y:N;return a.jsxs("div",{className:`input-with-audio-container relative ${u}`,"data-test":"input-with-audio-container",children:[a.jsx(v,{ref:l,value:i,onChange:t=>n(t.target.value),onKeyPress:c,placeholder:d,disabled:p,className:`input-with-audio ${r?"pr-12 pb-10":"pr-20"}`,"data-test":"input-with-audio-input"}),C&&a.jsx("div",{className:`transcription-spinner absolute ${r?"right-11 bottom-3":"right-11 top-1/2 -translate-y-1/2"}`,"data-test":"input-with-audio-transcribing-spinner",children:a.jsx(R,{className:"w-4 h-4 animate-spin text-muted-foreground"})}),a.jsx("button",{onClick:j,className:`voice-input-button-inline absolute ${r?"right-2 bottom-2":"right-2 top-1/2 -translate-y-1/2"} p-1.5 rounded-md transition-colors ${s?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"hover:bg-accent"}`,title:s?"Stop recording":"Start voice input",type:"button","data-test":"input-with-audio-record-button",children:a.jsx($,{className:`voice-input-icon ${T.sm} ${s?"animate-pulse":""}`})}),a.jsx("div",{className:"audio-panel-wrapper hidden","data-test":"input-with-audio-audio-panel-wrapper",children:a.jsx(k,{sessionName:"input-with-audio",enableAutoPersist:!1,loadPersistedChunks:!1,autoStart:!1,startTrigger:h,stopTrigger:f,onChunkCreated:S,onChunkUpdated:x,onRecordingStateChange:w})})]})});A.displayName="InputWithAudio";export{A as I};
