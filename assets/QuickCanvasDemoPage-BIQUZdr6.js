import{r as o,j as s}from"./react-vendor-Byz07MLO.js";import{a as u}from"./index-BbgB-sev.js";import{B as D}from"./Breadcrumbs-CbFAFVWz.js";import{M as L}from"./MobileLogViewer-BZAVJcj3.js";import{e as I,D as T,T as z,E}from"./icons-Detj0uxE.js";import"./utils-DjFvUtuq.js";import"./radix-ui-B6r6BEmy.js";import"./ui-utils-BxIQ3qGg.js";function V({logger:B}){const x=[{label:"Home",href:"/"},{label:"Demo",href:"/demo"},{label:"Quick Canvas"}],c=o.useRef(null),[h,m]=o.useState([]),[v,d]=o.useState(!1),[f,g]=o.useState(!1),l=o.useRef(null),a=o.useRef(null),i=o.useRef(null);o.useEffect(()=>{const e=c.current;if(!e)return;const t=e.getContext("2d");if(t){t.clearRect(0,0,e.width,e.height);for(const n of h)w(t,n)}},[h]);const w=(e,t)=>{if(t.points.length<2)return;e.beginPath(),e.strokeStyle=t.color,e.lineCap="round",e.lineJoin="round",e.lineWidth=t.width;const n=t.points;e.moveTo(n[0].x,n[0].y);for(let r=1;r<n.length-1;r++){const S=(n[r].x+n[r+1].x)/2,R=(n[r].y+n[r+1].y)/2;e.quadraticCurveTo(n[r].x,n[r].y,S,R)}if(n.length>1){const r=n[n.length-1];e.lineTo(r.x,r.y)}e.stroke()},b=(e,t,n,r)=>{e.beginPath(),e.strokeStyle="#000000",e.lineCap="round",e.lineJoin="round",e.lineWidth=r*(.5+n.pressure*.5),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.stroke()},p=e=>{const t=c.current;if(!t)return{x:0,y:0,pressure:.5};const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top,pressure:e.pressure||.5}},C=o.useCallback(e=>{if(e.preventDefault(),l.current!==null)return;l.current=e.pointerId,d(!0);const t=p(e);a.current={points:[t],color:"#000000",width:3},i.current=t},[]),j=o.useCallback(e=>{if(l.current!==e.pointerId||!a.current||!i.current)return;const t=c.current,n=t==null?void 0:t.getContext("2d");if(!n)return;const r=p(e);b(n,i.current,r,a.current.width),a.current.points.push(r),i.current=r},[]),k=o.useCallback(e=>{if(l.current!==e.pointerId)return;const t=a.current;t&&t.points.length>1&&m(n=>[...n,t]),a.current=null,i.current=null,d(!1),l.current=null},[]),y=o.useCallback(e=>{if(l.current!==e.pointerId)return;const t=a.current;t&&t.points.length>1&&m(n=>[...n,t]),a.current=null,i.current=null,d(!1),l.current=null},[]),P=o.useCallback(e=>{a.current=null,i.current=null,d(!1),l.current=null},[]),N=()=>{const e=c.current,t=e==null?void 0:e.getContext("2d");t&&e&&t.clearRect(0,0,e.width,e.height),m([]),a.current=null,i.current=null};return s.jsxs("div",{"data-test":"quick-canvas-demo-page",className:"quick-canvas-demo-page flex-1 flex flex-col h-full",children:[s.jsxs("div",{"data-test":"page-header",className:"page-header p-6 pb-0 flex-shrink-0",children:[s.jsx("div",{"data-test":"breadcrumb-section",className:"breadcrumb-section mb-4",children:s.jsx(D,{items:x})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Quick Canvas"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Simple canvas drawing test with mobile logging. Draw with finger or Apple Pencil."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(u,{"data-test":"copy-logs-button",variant:"outline",size:"sm",children:[s.jsx(I,{className:"h-4 w-4 mr-2"}),"Copy Logs"]}),s.jsxs(u,{"data-test":"download-logs-button",variant:"outline",size:"sm",children:[s.jsx(T,{className:"h-4 w-4 mr-2"}),"Download"]}),s.jsx(u,{"data-test":"clear-logs-button",variant:"outline",size:"sm",children:"Clear Logs"}),s.jsxs(u,{"data-test":"clear-canvas-button",variant:"outline",size:"sm",onClick:N,children:[s.jsx(z,{className:"h-4 w-4 mr-2"}),"Clear Canvas"]}),s.jsxs(u,{"data-test":"show-logs-button",variant:"outline",size:"sm",onClick:()=>g(!f),children:[s.jsx(E,{className:"h-4 w-4 mr-2"}),f?"Hide Logs":"Show Logs"]})]})]})]}),s.jsxs("div",{"data-test":"page-content",className:"page-content flex-1 p-6 overflow-y-auto min-h-0",children:[s.jsx("div",{"data-test":"canvas-container",className:"border rounded-lg bg-white overflow-hidden",style:{touchAction:"none"},children:s.jsx("canvas",{ref:c,"data-test":"drawing-canvas",width:800,height:600,className:"w-full h-auto",style:{touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},onPointerDown:C,onPointerMove:j,onPointerUp:k,onPointerLeave:y,onPointerCancel:P})}),s.jsxs("div",{"data-test":"stroke-info",className:"mt-4 text-sm text-gray-500",children:["Strokes: ",h.length," | Drawing: ",v?"Yes":"No"]}),f&&s.jsx(L,{defaultVisible:!0,autoRefresh:!0,onClose:()=>g(!1)})]})]})}export{V as QuickCanvasDemoPage};
