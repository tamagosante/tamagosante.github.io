import{r as n,j as e}from"./react-vendor-Byz07MLO.js";import{B as X}from"./Breadcrumbs-CbFAFVWz.js";import{y as m,C as v,b as N,c as b,e as w,L as o,I as S,a as i,d as G,av as J,B as Q,aj as W,l as Y,V as Z,T as z}from"./index-BbgB-sev.js";import{S as A,T as B,al as _,a2 as ee,am as te,an as se,ab as ae,X as re,C as le,e as ne}from"./icons-Detj0uxE.js";import"./radix-ui-B6r6BEmy.js";import"./utils-DjFvUtuq.js";import"./ui-utils-BxIQ3qGg.js";function ce(){const[l,c]=n.useState(()=>{var t,a;return((a=(t=m.get("app"))==null?void 0:t.replacer)==null?void 0:a.rules)??[]}),[p,C]=n.useState(""),[u,k]=n.useState({}),[F,h]=n.useState({}),[x,j]=n.useState(()=>{var t,a;return((a=(t=m.get("app"))==null?void 0:t.replacer)==null?void 0:a.presets)??[]}),[g,T]=n.useState(""),y=n.useRef(null);n.useEffect(()=>{var s,r,d,I;const t=((r=(s=m.get("app"))==null?void 0:s.replacer)==null?void 0:r.rules)??[];t.length>0&&c(t);const a=((I=(d=m.get("app"))==null?void 0:d.replacer)==null?void 0:I.presets)??[];a.length>0&&j(a)},[]),n.useEffect(()=>{m.update("app",{replacer:{rules:l,presets:x}})},[l,x]);const L=(t,a)=>{if(!t)return{isValid:!0};try{const s=a?"g":"gi";return{isValid:!0,regex:new RegExp(t,s)}}catch(s){return{isValid:!1,error:s instanceof Error?s.message:"Invalid regex"}}},O=()=>{const t={id:Date.now().toString(),pattern:"",replacement:"",caseSensitive:!0,enabled:!0};c(a=>[...a,t])},V=t=>{c(a=>a.filter(s=>s.id!==t)),k(a=>{const s={...a};return delete s[t],s})},f=(t,a,s)=>{c(r=>r.map(d=>d.id===t?{...d,[a]:s}:d))},$=t=>{const a=l.find(r=>r.id===t);if(!a)return;const s={id:Date.now().toString(),pattern:a.pattern,replacement:a.replacement,caseSensitive:a.caseSensitive,enabled:a.enabled};c(r=>[...r,s])},H=t=>{c(a=>a.map(s=>s.id===t?{...s,pattern:s.replacement,replacement:s.pattern}:s))},P=()=>{if(!g.trim())return;const t={id:Date.now().toString(),name:g.trim(),rules:l,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};j(a=>[...a,t]),T("")},K=t=>{const a=x.find(s=>s.id===t);a&&c(a.rules)},q=t=>{j(a=>a.filter(s=>s.id!==t))},M=t=>{j(a=>a.map(s=>s.id===t?{...s,rules:l,updatedAt:new Date().toISOString()}:s))},R=n.useMemo(()=>{let t=p;const a={};for(const s of l){if(!s.enabled||!s.pattern)continue;const r=L(s.pattern,s.caseSensitive);if(!r.isValid){a[s.id]=r.error||"Invalid regex";continue}r.regex&&(t=t.replace(r.regex,s.replacement))}return k(a),t},[p,l]),U=async(t,a)=>{try{await navigator.clipboard.writeText(t),h(s=>({...s,[a]:"copied"})),setTimeout(()=>{h(s=>({...s,[a]:"idle"}))},2e3)}catch(s){console.error("Failed to copy:",s),h(r=>({...r,[a]:"error"})),setTimeout(()=>{h(r=>({...r,[a]:"idle"}))},2e3)}},D=({content:t,copyKey:a})=>{const s=F[a]||"idle";return e.jsx(i,{variant:"outline",size:"sm",onClick:()=>U(t,a),disabled:!t,className:"gap-2","data-test":"copy-button",children:s==="copied"?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4 text-green-500"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4"}),"Copy"]})})},E=({onClear:t,disabled:a})=>e.jsxs(i,{variant:"outline",size:"sm",onClick:t,disabled:a,className:"gap-2 hover:bg-destructive hover:text-destructive-foreground hover:border-destructive","data-test":"clear-button",children:[e.jsx(re,{className:"h-4 w-4"}),"Clear"]});return e.jsx("div",{className:"p-6 w-full","data-test":"replacer",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(v,{"data-test":"replacer-presets-card",children:[e.jsx(N,{className:"pb-3",children:e.jsx(b,{className:"text-lg","data-test":"replacer-presets-title",children:"Presets"})}),e.jsxs(w,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"preset-name-input",className:"text-xs font-medium",children:"Save Current Rules as Preset"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{id:"preset-name-input",value:g,onChange:t=>T(t.target.value),placeholder:"Enter preset name...",className:"flex-1 h-8",onKeyPress:t=>{t.key==="Enter"&&P()},"data-test":"preset-name-input"}),e.jsxs(i,{onClick:P,disabled:!g.trim(),size:"sm",className:"gap-2","data-test":"save-preset-button",children:[e.jsx(A,{className:"h-4 w-4"}),"Save"]})]})]}),x.length>0&&e.jsxs("div",{className:"space-y-2 border-t pt-3",children:[e.jsx(o,{className:"text-xs font-medium block",children:"Loaded Presets"}),e.jsx("div",{className:"space-y-1 max-h-[200px] overflow-y-auto",children:x.map(t=>e.jsxs("div",{className:"flex items-center gap-1 bg-muted/50 border rounded px-2 py-1 text-xs","data-test":"preset-item",children:[e.jsx("button",{onClick:()=>K(t.id),className:"flex-1 text-left hover:underline cursor-pointer truncate",title:"Load this preset","data-test":"load-preset-button",children:t.name}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>M(t.id),className:"h-5 w-5 flex-shrink-0",title:"Update preset with current rules","data-test":"update-preset-button",children:e.jsx(A,{className:"h-3 w-3"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>q(t.id),className:"h-5 w-5 flex-shrink-0",title:"Delete this preset","data-test":"delete-preset-button",children:e.jsx(B,{className:"h-3 w-3"})})]},t.id))})]})]})]}),e.jsxs(v,{"data-test":"replacer-rules-card",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:[e.jsxs("div",{children:[e.jsxs(b,{className:"text-lg flex items-center gap-2","data-test":"replacer-rules-title",children:[e.jsx(_,{className:"h-4 w-4"}),"Replacement Rules"]}),e.jsx(G,{"data-test":"replacer-rules-description",children:"Define patterns and replacements. Rules are applied sequentially."})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:O,"data-test":"add-rule-button",className:"flex-shrink-0",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Add Rule"]})]}),e.jsx(w,{children:e.jsx(J,{className:"h-[600px] rounded-md border","data-test":"rules-scroll-area",children:e.jsx("div",{className:"p-4 space-y-3",children:l.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground","data-test":"rules-empty-state",children:e.jsx("p",{className:"text-sm",children:'No rules yet. Click "Add Rule" to create one.'})}):l.map((t,a)=>e.jsxs("div",{className:"border rounded-lg p-3 space-y-2","data-test":"rule-item",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(Q,{variant:"outline","data-test":"rule-badge",children:["Rule ",a+1]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{checked:t.enabled,onCheckedChange:s=>f(t.id,"enabled",s===!0),"data-test":"rule-enabled-checkbox"}),e.jsx(o,{className:"text-xs cursor-pointer",children:"Enabled"})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{checked:t.caseSensitive,onCheckedChange:s=>f(t.id,"caseSensitive",s),"data-test":"case-sensitive-switch"}),e.jsx(o,{className:"text-xs cursor-pointer whitespace-nowrap",children:"Case sensitive"})]}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>H(t.id),className:"h-7 w-7",title:"Swap pattern and replacement","data-test":"reverse-rule-button",children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>$(t.id),className:"h-7 w-7",title:"Duplicate this rule","data-test":"duplicate-rule-button",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>V(t.id),className:"h-7 w-7",title:"Delete this rule","data-test":"remove-rule-button",children:e.jsx(B,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:`pattern-${t.id}`,className:"text-xs",children:"Pattern"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{id:`pattern-${t.id}`,value:t.pattern,onChange:s=>f(t.id,"pattern",s.target.value),placeholder:"Regex...",className:Z("font-mono text-sm",u[t.id]&&"border-destructive"),"data-test":"pattern-input"}),u[t.id]&&e.jsx(ae,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-4 w-4 text-destructive"})]}),u[t.id]&&e.jsx("p",{className:"text-xs text-destructive","data-test":"pattern-error",children:u[t.id]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:`replacement-${t.id}`,className:"text-xs",children:"Replacement"}),e.jsx(S,{id:`replacement-${t.id}`,value:t.replacement,onChange:s=>f(t.id,"replacement",s.target.value),placeholder:"Text...",className:"font-mono text-sm","data-test":"replacement-input"})]})]})]},t.id))})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(v,{"data-test":"replacer-input-card",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-lg","data-test":"replacer-input-title",children:"Input Text"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{onClear:()=>{var t;C(""),(t=y.current)==null||t.focus()},disabled:!p}),e.jsx(D,{content:p,copyKey:"replacer-input"})]})]}),e.jsx(w,{children:e.jsx(z,{ref:y,value:p,onChange:t=>C(t.target.value),placeholder:"Enter or paste text to process...",className:"h-[280px] font-mono text-sm","data-test":"replacer-input-textarea"})})]}),e.jsxs(v,{"data-test":"replacer-output-card",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(b,{className:"text-lg","data-test":"replacer-output-title",children:"Output Text"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{onClear:()=>{var t;C(""),(t=y.current)==null||t.focus()},disabled:!R}),e.jsx(D,{content:R,copyKey:"replacer-output"})]})]}),e.jsx(w,{children:e.jsx(z,{value:R,readOnly:!0,className:"h-[280px] font-mono text-sm bg-muted","data-test":"replacer-output-textarea"})})]})]})]})})}function he({logger:l}){const c=[{label:"Home",href:"/"},{label:"Demo",href:"/demo"},{label:"Replacer"}];return e.jsxs("div",{className:"replacer-demo-page flex-1 flex flex-col h-full","data-test":"replacer-demo-page",children:[e.jsx("div",{className:"page-header p-6 pb-0 flex-shrink-0","data-test":"page-header",children:e.jsx(X,{items:c})}),e.jsx("div",{className:"page-content flex-1 overflow-y-auto min-h-0","data-test":"page-content",children:e.jsx(ce,{})})]})}export{he as ReplacerDemoPage};
