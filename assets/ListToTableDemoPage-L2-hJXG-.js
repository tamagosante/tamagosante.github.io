import{r as m,j as a}from"./react-vendor-Byz07MLO.js";import{B as W}from"./Breadcrumbs-BjZV4SIv.js";import{z as H,a as G,E as Y}from"./index-hTFRJyrx.js";import{u as V,a as q,U as Q,b as X,c as Z,d as ee,T as te}from"./UiDataTableColumnFilter-BC1nYNbF.js";import{g as ae,a as se,R as ne}from"./icons-yhbeTEay.js";import"./radix-ui-9f16WUVy.js";import"./utils-G1l1U0hd.js";import"./ui-utils-BxIQ3qGg.js";import"./SFSService-BFwsjKwD.js";const re="http://localhost:3030/api/tft-champion-image";function oe(r){return`${re}?name=${encodeURIComponent(r)}`}function I(r){var c;const s=r.split(`
`),n=[],e=[];for(const u of s){if(u.trim()==="")continue;const p=((c=u.match(/^(\s*)/))==null?void 0:c[1])||"",x=(p.match(/\t/g)||[]).length,b=p.replace(/\t/g,"").length,y=x+Math.floor(b/2);let l=u.trim();if(!l)continue;let h="string";for(l.endsWith("[]")?(h="array",l=l.slice(0,-2)):l.endsWith("{}")?(h="object",l=l.slice(0,-2)):l.endsWith("{1}")?(h="parentSelector",l=l.slice(0,-3)):l.endsWith("#")?(h="number",l=l.slice(0,-1)):l.endsWith("?")&&(h="boolean",l=l.slice(0,-1));e.length>0&&e[e.length-1].depth>=y;)e.pop();const C=[...e.map(S=>S.name),l],F=e.slice(1).some(S=>S.type==="array");n.push({name:l,depth:y,type:h,path:C,hasNestedArray:F}),(h==="array"||h==="object"||h==="parentSelector")&&e.push({depth:y,name:l,type:h})}return n}function j(r){return r.filter(s=>s.type==="string"||s.type==="number"||s.type==="boolean")}function ie(r,s){let n=r;for(const e of s){if(n==null||Array.isArray(n)&&(n=n[0],n==null))return;if(typeof n=="object")n=n[e];else return}return n}function le(r,s){if(!s||typeof s!="object")return[];const n=r.find(u=>u.type==="array"&&u.depth===0);if(!n)return Array.isArray(s)?s:[s];const e=s[n.name];if(!Array.isArray(e))return[];const c=j(r).filter(u=>u.path.length>1&&u.path[0]===n.name);return e.map(u=>{const p={};for(const x of c){const b=x.path.slice(1),y=ie(u,b),l=b.join(".");p[l]=y}return p})}function ce(r,s){return{id:r,accessorFn:n=>n[r],header:s,cell:({getValue:n})=>{const e=n();return a.jsx("span",{className:"min-h-[1.25rem] block break-words",children:String(e??"")})}}}function de(r,s){const n={name:"root",children:new Map};for(const e of r){const c=s?e.path.slice(1):e.path,u=c.join(".");let p=n;for(let x=0;x<c.length;x++){const b=c[x],y=x===c.length-1;p.children.has(b)||p.children.set(b,{name:b,columnKey:y?u:void 0,children:new Map}),p=p.children.get(b),y&&(p.columnKey=u)}}return n}function M(r){const s=[];for(const[,n]of r.children)if(n.columnKey&&n.children.size===0)s.push(ce(n.columnKey,n.name));else if(n.children.size>0){const e=M(n);e.length>0&&s.push({id:n.name,header:n.name,columns:e})}return s}function ue(r){const s=r.find(c=>c.type==="array"&&c.depth===0),n=j(r).filter(c=>s?c.path.length>1&&c.path[0]===s.name:!0),e=de(n,(s==null?void 0:s.name)??null);return M(e)}function z(r){return r==="number"?"number":r==="boolean"?"boolean":"string"}function me(r){const s=r.find(e=>e.type==="array"&&e.depth===0);return j(r).filter(e=>s?e.path.length>1&&e.path[0]===s.name:!0).map(e=>({id:(s?e.path.slice(1):e.path).join("."),label:e.name,type:z(e.type)}))}function pe(r){const s=r.find(e=>e.type==="array"&&e.depth===0);return j(r).filter(e=>s?e.path.length>1&&e.path[0]===s.name:!0).map(e=>({field:(s?e.path.slice(1):e.path).join("."),label:e.name,type:z(e.type)}))}const L=`champions[]
  name
  cost
  traits
  type
  unlockCondition
  ability{}
    name
    manaCost
    description
    activation[]
      kind
      type
      value
      calculation
      valuePerLevel`,O=`{
  "champions": [
    {
      "name": "Anivia",
      "cost": "1",
      "traits": "Freljord Invoker",
      "type": "Magic Caster",
      "unlockCondition": "",
      "ability": {
        "name": "Frostbite",
        "manaCost": "0/40",
        "description": "Fire an ice shard at target that deals 325/455/650 () magic damage. If they are Chilled, the damage Critically Strikes.",
        "activation": [
          {
            "kind": "Damage:",
            "type": "Ability power",
            "value": "455 ()",
            "calculation": "",
            "valuePerLevel": "[325/455/650]"
          }
        ]
      }
    }
  ]
}
`,k="list-to-table-schema",A="list-to-table-json";function je({logger:r}){const[s,n]=m.useState(()=>localStorage.getItem(k)??L),[e,c]=m.useState(()=>localStorage.getItem(A)??O),[u,p]=m.useState(null),[x,b]=m.useState([]),[y,l]=m.useState([]),[h,C]=m.useState([]),[F,S]=m.useState([]),[N,E]=m.useState(!1),o=V({data:x}),i=q({data:o.computed.processedData,groupableFields:F}),[T,D]=m.useState({}),K=m.useCallback(t=>{const d=h.find(f=>f.id===t);return(d==null?void 0:d.type)??"string"},[h]),R=m.useCallback((t,d)=>{const f=o.state.filters.find(g=>g.field===t);f&&o.actions.removeFilter(f.id),o.actions.addFilter({...d,field:t}),D(g=>({...g,[t]:d}))},[o.actions,o.state.filters]),U=m.useCallback(t=>{const d=o.state.filters.find(f=>f.field===t);d&&o.actions.removeFilter(d.id),D(f=>{const g={...f};return delete g[t],g})},[o.actions,o.state.filters]),$=m.useCallback(t=>t in T,[T]);m.useEffect(()=>{localStorage.setItem(k,s)},[s]),m.useEffect(()=>{localStorage.setItem(A,e)},[e]);const _=[{label:"Home",href:"/"},{label:"Demo",href:"/demo"},{label:"List to Table"}],P=m.useCallback(()=>{p(null);try{const t=I(s);if(t.length===0){p("Schema is empty or invalid");return}let d;try{d=JSON.parse(e)}catch{p("Invalid JSON format");return}const f=ue(t),g=le(t,d),v=me(t),w=pe(t);l(f),b(g),C(v),S(w),r==null||r.debug(`Generated table: fields=${t.length}, columns=${f.length}, rows=${g.length}`)}catch(t){p(t instanceof Error?t.message:"Unknown error")}},[s,e,r]),J=m.useCallback(()=>{n(L),c(O),b([]),l([]),C([]),S([]),p(null),localStorage.removeItem(k),localStorage.removeItem(A)},[]);m.useEffect(()=>{P()},[]);const B=m.useMemo(()=>{try{return I(s)}catch{return[]}},[s]);return a.jsxs("div",{className:"list-to-table-demo-page flex-1 flex flex-col h-full","data-test":"list-to-table-demo-page",children:[a.jsx("div",{className:"page-header p-6 pb-0 flex-shrink-0","data-test":"page-header",children:a.jsx("div",{className:"breadcrumb-section mb-4","data-test":"breadcrumb-section",children:a.jsx(W,{items:_})})}),a.jsxs("div",{className:"page-content flex-1 p-6 overflow-y-auto min-h-0","data-test":"page-content",children:[a.jsxs(H,{open:N,onOpenChange:E,className:"mb-6","data-test":"input-collapsible",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4 px-3 py-2 rounded-md bg-muted/50 cursor-pointer hover:bg-muted transition-colors",onClick:()=>E(!N),"data-test":"actions-section",children:[a.jsx(ae,{className:`w-5 h-5 transition-transform ${N?"rotate-180":""}`,"data-test":"toggle-input-icon"}),a.jsxs(G,{onClick:t=>{t.stopPropagation(),P()},"data-test":"generate-button",children:[a.jsx(se,{className:"w-4 h-4 mr-2"}),"Generate Table"]}),a.jsxs(G,{variant:"outline",onClick:t=>{t.stopPropagation(),J()},"data-test":"reset-button",children:[a.jsx(ne,{className:"w-4 h-4 mr-2"}),"Reset"]}),a.jsxs("span",{className:"text-sm text-muted-foreground","data-test":"field-count",children:[B.length," fields"]})]}),a.jsx(Y,{children:a.jsxs("div",{className:"grid grid-cols-2 gap-6","data-test":"input-grid",children:[a.jsxs("div",{className:"flex flex-col","data-test":"schema-section",children:[a.jsx("label",{className:"text-sm font-medium mb-2","data-test":"schema-label",children:"Schema"}),a.jsx("textarea",{value:s,onChange:t=>n(t.target.value),placeholder:"Enter indented list schema...",className:"flex-1 min-h-[200px] p-3 font-mono text-sm border rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-blue-500","data-test":"schema-input"})]}),a.jsxs("div",{className:"flex flex-col","data-test":"json-section",children:[a.jsx("label",{className:"text-sm font-medium mb-2","data-test":"json-label",children:"JSON Data"}),a.jsx("textarea",{value:e,onChange:t=>c(t.target.value),placeholder:"Enter JSON data...",className:"flex-1 min-h-[200px] p-3 font-mono text-sm border rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-blue-500","data-test":"json-input"})]})]})})]}),u&&a.jsx("div",{className:"p-4 mb-6 bg-red-50 border border-red-200 rounded-md text-red-700","data-test":"error-message",children:u}),x.length>0&&y.length>0&&a.jsxs("div",{className:"border rounded-lg p-4","data-test":"table-section",children:[a.jsx("div",{className:"mb-4","data-test":"filter-section",children:a.jsx(Q,{columns:h,filters:o.state.filters,searchTerm:o.state.searchTerm,caseSensitive:o.state.caseSensitive,exactMatch:o.state.exactMatch,onSearchChange:o.actions.setSearchTerm,onCaseSensitiveChange:o.actions.setCaseSensitive,onExactMatchChange:o.actions.setExactMatch,onAddFilter:o.actions.addFilter,onRemoveFilter:o.actions.removeFilter,onClearFilters:o.actions.clearFilters})}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4","data-test":"table-toolbar",children:[a.jsx(X,{groupableFields:i.computed.groupableFields,selectedField:i.state.groupConfig.primaryField,secondaryFields:i.state.groupConfig.secondaryFields,onFieldSelect:i.actions.setGroupBy,onAddSecondary:i.actions.addGroupLevel,onRemoveSecondary:t=>i.actions.removeGroupLevel(t+1)}),a.jsx(Z,{enabled:i.state.sliceConfig.enabled,currentSlice:i.state.sliceConfig.currentSlice,totalSlices:i.computed.totalSlices,sliceSize:i.state.sliceConfig.sliceSize,sliceSizeOptions:i.state.sliceConfig.sliceSizeOptions,onToggle:i.actions.toggleSlicing,onSliceSizeChange:i.actions.setSliceSize,onNextSlice:i.actions.nextSlice,onPreviousSlice:i.actions.previousSlice,hasNext:i.computed.hasNextSlice,hasPrevious:i.computed.hasPreviousSlice,sliceDisplay:i.computed.sliceDisplay})]}),a.jsxs("div",{className:"mb-4 text-sm text-muted-foreground","data-test":"table-row-count",children:[o.computed.filteredCount," ",o.computed.filteredCount===1?"row":"rows",i.tableProps.isGrouped&&` in ${i.computed.totalGroups} groups`]}),a.jsx("div",{className:"rounded-md border overflow-x-auto","data-test":"table-container",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-muted",children:a.jsxs("tr",{"data-test":"header-row",children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider w-16","data-test":"column-header-image",children:"Image"}),h.map(t=>{var g,v;const d=((g=o.state.sort)==null?void 0:g.field)===t.id,f=d?(v=o.state.sort)==null?void 0:v.direction:null;return a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium uppercase tracking-wider cursor-pointer select-none hover:bg-muted/80","data-test":`column-header-${t.id}`,onClick:()=>o.actions.toggleSort(t.id),children:a.jsxs("div",{className:"flex items-center gap-1",children:[t.label,d&&a.jsx("span",{"data-test":`sort-indicator-${t.id}`,children:f==="asc"?"▲":"▼"}),a.jsx(ee,{columnId:t.id,columnLabel:t.label,columnType:K(t.id),currentFilter:T[t.id],onApplyFilter:w=>R(t.id,w),onClearFilter:()=>U(t.id),isActive:$(t.id)})]})},t.id)})]})}),i.tableProps.isGrouped?a.jsx(te,{rows:i.tableProps.data,columns:y,onToggleGroup:i.actions.toggleGroup}):a.jsx("tbody",{"data-test":"table-body",className:"bg-white divide-y divide-gray-200",children:(()=>{const t=i.state.sliceConfig.enabled?i.tableProps.data.map(d=>d.data):o.computed.processedData;return t.length>0?t.map((d,f)=>{const g=String(d.name??"");return a.jsxs("tr",{"data-test":`data-row-${f}`,className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-2 py-1","data-test":`image-cell-${f}`,children:g&&a.jsx("img",{src:oe(g),alt:g,className:"w-12 h-12 object-contain",onError:v=>{v.target.style.display="none"}})}),h.map(v=>a.jsx("td",{className:"px-4 py-3 text-sm",children:String(d[v.id]??"")},v.id))]},f)}):a.jsx("tr",{children:a.jsx("td",{colSpan:h.length+1,className:"px-4 py-8 text-center text-sm text-muted-foreground","data-test":"no-results-message",children:"No results found"})})})()})]})})]})]})]})}export{je as ListToTableDemoPage};
