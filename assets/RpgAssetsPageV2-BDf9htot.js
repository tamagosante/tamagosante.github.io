import{r as C,j as e,d as ae,R as g}from"./react-vendor-Byz07MLO.js";import{a as A,ac as se}from"./index-eHP58yiE.js";import{H as F,E as L,a as j,b as N}from"./EnemyCircle-Bn6ZwsVI.js";import{d as re,a as ne,E as v,b as R,c as _,e as oe,f as ce}from"./EasyFormV2-Bnzz3jgo.js";import{aa as le,b3 as ie,e as de}from"./icons-vtiX7BHn.js";import"./utils-DJ2ViQ2u.js";import"./radix-ui-v9Pxfv0s.js";import"./ui-utils-BxIQ3qGg.js";function O({design:t,size:r=60,selected:p,onClick:u}){const l=C.useRef(null);return C.useEffect(()=>{const i=l.current;if(!i)return;const o=i.getContext("2d");if(!o)return;o.clearRect(0,0,r,r);const d=r/2,m=r/2-4;re(o,t.id,d,d,m)},[t.id,r]),e.jsx("div",{"data-test":`hero-canvas-${t.id}`,onClick:u,className:`cursor-pointer transition-transform hover:scale-110 ${p?"ring-2 ring-offset-2 ring-blue-400 rounded-full":""}`,children:e.jsx("canvas",{ref:l,width:r,height:r,className:"block"})})}function $({design:t,size:r=60,selected:p,onClick:u,isFlashing:l=!1,isAggroed:i=!1}){const o=C.useRef(null);return C.useEffect(()=>{const d=o.current;if(!d)return;const m=d.getContext("2d");if(!m)return;m.clearRect(0,0,r,r);const b=r/2,s=r/2-4;ne(m,t.id,b,b,s,l,i)},[t.id,r,l,i]),e.jsx("div",{"data-test":`enemy-canvas-${t.id}`,onClick:u,className:`cursor-pointer transition-transform hover:scale-110 ${p?"ring-2 ring-offset-2 ring-red-400 rounded-full":""}`,children:e.jsx("canvas",{ref:o,width:r,height:r,className:"block"})})}const me={sourceHero:F.WARRIOR,targetEnemy:L.GOBLIN_ANGRY,effectType:"hook_punch",canvasWidth:200,canvasHeight:100,sourceX:45,sourceY:70,targetX:160,targetY:30,heroSize:50,heroOffsetX:0,heroOffsetY:25,enemySize:45,enemyOffsetX:155,enemyOffsetY:27,fistSize:10,baseColor:"#f97316",accentColor:"#ea580c",arcStartAngle:85,arcEndAngle:30,arcCenterX:100,arcCenterY:30,arcRotation:-20,showArcGuide:!0,lockArcPosition:!0,arcRadius:70,impactRays:8,trailWidth:8,animationSpeed:100},fe=j.map(t=>({value:t.id,label:t.name})),xe=N.map(t=>({value:t.id,label:t.name})),he=ce.map(t=>({value:t.id,label:`${t.icon} ${t.name}`})),pe={sections:[{id:"entities",label:"Entities",fields:[{name:"sourceHero",label:"Source Hero",type:"select",options:fe},{name:"targetEnemy",label:"Target Enemy",type:"select",options:xe},{name:"effectType",label:"Effect",type:"select",options:he}]},{id:"colors",label:"Effect Colors",fields:[{name:"baseColor",label:"Base Color",type:"color",row:"colors"},{name:"accentColor",label:"Accent Color",type:"color",row:"colors"}]},{id:"arc",label:"Arc Configuration",fields:[{name:"showArcGuide",label:"Always Show Arc",type:"checkbox",row:"arc-toggles"},{name:"lockArcPosition",label:"Lock Arc (move dots on circle)",type:"checkbox",row:"arc-toggles"},{name:"arcRadius",label:"Arc Radius",type:"slider",min:20,max:120,step:5,format:t=>`${t}px`},{name:"arcStartAngle",label:"Start Angle",type:"slider",min:0,max:180,step:5,format:t=>`${t}°`,row:"arc-angles"},{name:"arcEndAngle",label:"End Angle",type:"slider",min:0,max:180,step:5,format:t=>`${t}°`,row:"arc-angles"},{name:"arcCenterX",label:"Center X",type:"slider",min:0,max:200,step:1,format:t=>`${t}px`,row:"arc-center"},{name:"arcCenterY",label:"Center Y",type:"slider",min:0,max:150,step:1,format:t=>`${t}px`,row:"arc-center"},{name:"arcRotation",label:"Rotation",type:"slider",min:-180,max:180,step:5,format:t=>`${t}°`},{name:"trailWidth",label:"Trail Width",type:"slider",min:2,max:20,step:1,format:t=>`${t}px`}]},{id:"impact",label:"Impact Effect",fields:[{name:"impactRays",label:"Impact Rays",type:"slider",min:4,max:16,step:1,format:t=>`${t}`,row:"impact"},{name:"fistSize",label:"Fist Size",type:"slider",min:5,max:30,step:1,format:t=>`${t}px`,row:"impact"}]},{id:"timing",label:"Animation",fields:[{name:"animationSpeed",label:"Speed",type:"slider",min:50,max:200,step:10,format:t=>`${t}%`}]},{id:"canvas",label:"Canvas Size",fields:[{name:"canvasWidth",label:"Width",type:"slider",min:100,max:400,step:10,format:t=>`${t}px`,row:"canvas-size"},{name:"canvasHeight",label:"Height",type:"slider",min:60,max:200,step:10,format:t=>`${t}px`,row:"canvas-size"}]},{id:"source",label:"Source Position (Effect Start)",fields:[{name:"sourceX",label:"X",type:"slider",min:0,max:300,step:1,format:t=>`${t}px`,row:"source-pos"},{name:"sourceY",label:"Y",type:"slider",min:0,max:150,step:1,format:t=>`${t}px`,row:"source-pos"}]},{id:"target",label:"Target Position (Effect End)",fields:[{name:"targetX",label:"X",type:"slider",min:0,max:300,step:1,format:t=>`${t}px`,row:"target-pos"},{name:"targetY",label:"Y",type:"slider",min:0,max:150,step:1,format:t=>`${t}px`,row:"target-pos"}]},{id:"hero",label:"Hero Display",fields:[{name:"heroSize",label:"Size",type:"slider",min:20,max:80,step:1,format:t=>`${t}px`},{name:"heroOffsetX",label:"Offset X",type:"slider",min:0,max:100,step:1,format:t=>`${t}px`,row:"hero-offset"},{name:"heroOffsetY",label:"Offset Y",type:"slider",min:0,max:100,step:1,format:t=>`${t}px`,row:"hero-offset"}]},{id:"enemy",label:"Enemy Display",fields:[{name:"enemySize",label:"Size",type:"slider",min:20,max:80,step:1,format:t=>`${t}px`},{name:"enemyOffsetX",label:"Offset X",type:"slider",min:0,max:200,step:1,format:t=>`${t}px`,row:"enemy-offset"},{name:"enemyOffsetY",label:"Offset Y",type:"slider",min:0,max:100,step:1,format:t=>`${t}px`,row:"enemy-offset"}]}]};function Ee({className:t=""}){const r=ae(),[p,u]=g.useState(F.WARRIOR),[l,i]=g.useState(L.GOBLIN_ANGRY),[o,d]=g.useState("attack"),[m,b]=g.useState(!1),[s,k]=g.useState(me),f=j.find(a=>a.id===p),x=N.find(a=>a.id===l),Y=[...v.status,...v.physical,...v.projectile],h=Y.find(a=>a.id===o),V=["status","physical","projectile"],X=j.find(a=>a.id===s.sourceHero),z=N.find(a=>a.id===s.targetEnemy),U=Y.find(a=>a.id===s.effectType),q=()=>{const a=JSON.stringify(s,null,2);navigator.clipboard.writeText(a),console.log(`Animation Builder Config copied:
`,a)},J=a=>{d(a),k(c=>({...c,effectType:a}))},K=(a,c)=>{k(n=>{if(a==="lockArcPosition"&&c===!0&&!n.lockArcPosition){const H=Math.PI*(n.arcStartAngle/100),Q=Math.PI*(n.arcEndAngle/100),P=Math.cos(H),Z=Math.sin(H),ee=Math.cos(Q),w=n.targetX-n.sourceX,E=n.targetY-n.sourceY,S=Math.atan2(E,w),te=ee-P,y=Math.sqrt(w*w+E*E)/te,T=-P*y,B=-Z*y,I=Math.cos(S),M=Math.sin(S),D=n.sourceX+T*I-B*M,G=n.sourceY+T*M+B*I,W=Math.round(S*180/Math.PI);return console.log("[LOCKING] Capturing current arc position:",{centerX:D,centerY:G,radius:y,angleDegrees:W}),{...n,lockArcPosition:!0,arcCenterX:Math.round(D),arcCenterY:Math.round(G),arcRadius:Math.round(y),arcRotation:W}}return{...n,[a]:c}})};return e.jsxs("div",{"data-test":"rpg-assets-page-v2",className:`h-screen bg-gray-100 p-2 flex flex-col ${t}`,children:[e.jsxs("div",{"data-test":"header",className:"flex items-center gap-2 mb-2 flex-shrink-0",children:[e.jsxs(A,{"data-test":"back-button",variant:"outline",size:"sm",onClick:()=>void r("/demo/rpg-game"),className:"flex items-center gap-1 h-7 px-2",children:[e.jsx(le,{size:14}),e.jsx("span",{"data-test":"back-button-label",className:"text-xs",children:"Back"})]}),e.jsx("h1",{"data-test":"page-title",className:"text-lg font-bold text-gray-800",children:"Game Assets V2"}),e.jsx("span",{"data-test":"canvas-badge",className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:"Canvas-based effects"}),e.jsxs(A,{"data-test":"animation-builder-button",variant:"outline",size:"sm",onClick:()=>b(!0),className:"flex items-center gap-1 h-7 px-2 ml-auto",children:[e.jsx(ie,{size:14}),e.jsx("span",{"data-test":"animation-builder-label",className:"text-xs",children:"Animation Builder"})]})]}),e.jsxs("div",{"data-test":"content-grid",className:"flex-1 grid grid-cols-4 gap-2 min-h-0",children:[e.jsxs("section",{"data-test":"hero-assets",className:"bg-white rounded p-2 shadow flex flex-col min-h-0 overflow-auto",children:[e.jsx("h2",{"data-test":"hero-section-title",className:"text-sm font-semibold text-blue-700 mb-2",children:"Hero Classes"}),e.jsx("div",{"data-test":"hero-selection-section",className:"mb-3",children:e.jsx("div",{"data-test":"hero-selection-grid",className:"grid grid-cols-3 gap-2 justify-items-center",children:j.map(a=>e.jsx(O,{design:a,size:45,selected:p===a.id,onClick:()=>u(a.id)},a.id))})}),e.jsxs("div",{"data-test":"selected-hero-details",className:"bg-blue-50 border border-blue-200 rounded p-2 flex-1",children:[e.jsxs("div",{"data-test":"hero-info",className:"flex items-center gap-2 mb-2",children:[e.jsx(O,{design:f,size:40}),e.jsxs("div",{children:[e.jsx("div",{"data-test":"hero-name",className:"font-semibold text-sm",children:f.name}),e.jsx("div",{"data-test":"hero-description",className:"text-xs text-gray-500",children:f.description})]})]}),e.jsxs("div",{"data-test":"hero-colors",className:"text-xs space-y-1",children:[e.jsxs("div",{"data-test":"hero-base-color",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Base:"}),e.jsx("div",{"data-test":"hero-base-color-swatch",className:"w-4 h-4 rounded border",style:{backgroundColor:f.baseColor}}),e.jsx("span",{"data-test":"hero-base-color-value",className:"font-mono text-gray-600",children:f.baseColor})]}),e.jsxs("div",{"data-test":"hero-accent-color",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Accent:"}),e.jsx("div",{"data-test":"hero-accent-color-swatch",className:"w-4 h-4 rounded border",style:{backgroundColor:f.accentColor}}),e.jsx("span",{"data-test":"hero-accent-color-value",className:"font-mono text-gray-600",children:f.accentColor})]})]})]})]}),e.jsxs("section",{"data-test":"enemy-assets",className:"bg-white rounded p-2 shadow flex flex-col min-h-0 overflow-auto",children:[e.jsx("h2",{"data-test":"enemy-section-title",className:"text-sm font-semibold text-red-700 mb-2",children:"Enemies"}),e.jsx("div",{"data-test":"enemy-selection-section",className:"mb-3",children:e.jsx("div",{"data-test":"enemy-selection-grid",className:"grid grid-cols-3 gap-2 justify-items-center",children:N.map(a=>e.jsx($,{design:a,size:45,selected:l===a.id,onClick:()=>i(a.id)},a.id))})}),e.jsxs("div",{"data-test":"selected-enemy-details",className:"bg-red-50 border border-red-200 rounded p-2 flex-1",children:[e.jsxs("div",{"data-test":"enemy-info",className:"flex items-center gap-2 mb-2",children:[e.jsx($,{design:x,size:40}),e.jsxs("div",{children:[e.jsx("div",{"data-test":"enemy-name",className:"font-semibold text-sm",children:x.name}),e.jsx("div",{"data-test":"enemy-description",className:"text-xs text-gray-500",children:x.description})]})]}),e.jsxs("div",{"data-test":"enemy-colors",className:"text-xs space-y-1",children:[e.jsxs("div",{"data-test":"enemy-base-color",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Base:"}),e.jsx("div",{"data-test":"enemy-base-color-swatch",className:"w-4 h-4 rounded border",style:{backgroundColor:x.baseColor}}),e.jsx("span",{"data-test":"enemy-base-color-value",className:"font-mono text-gray-600",children:x.baseColor})]}),e.jsxs("div",{"data-test":"enemy-accent-color",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Accent:"}),e.jsx("div",{"data-test":"enemy-accent-color-swatch",className:"w-4 h-4 rounded border",style:{backgroundColor:x.accentColor}}),e.jsx("span",{"data-test":"enemy-accent-color-value",className:"font-mono text-gray-600",children:x.accentColor})]})]})]})]}),e.jsxs("section",{"data-test":"full-preview",className:"bg-white rounded p-2 shadow flex flex-col min-h-0",children:[e.jsx("h2",{"data-test":"full-preview-title",className:"text-sm font-semibold text-emerald-700 mb-2",children:"Full Preview"}),e.jsxs("div",{"data-test":"combat-scene",className:"flex-1 bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded p-3 flex flex-col items-center justify-center gap-2",children:[e.jsxs("div",{"data-test":"combat-matchup",className:"text-xs text-emerald-600 font-medium",children:[X.name," vs ",z.name]}),e.jsxs("div",{"data-test":"combat-preview-container",className:"relative bg-white/50 rounded border border-emerald-100",style:{width:s.canvasWidth,height:s.canvasHeight},children:[e.jsx("div",{"data-test":"preview-hero",className:"absolute",style:{left:s.heroOffsetX,top:s.heroOffsetY},children:e.jsx(O,{design:X,size:s.heroSize})}),e.jsx("div",{"data-test":"preview-effect",className:"absolute inset-0",children:e.jsx(R,{design:U,width:s.canvasWidth,height:s.canvasHeight,sourcePos:{x:s.sourceX,y:s.sourceY},targetPos:{x:s.targetX,y:s.targetY},overrides:{baseColor:s.baseColor,accentColor:s.accentColor,arcStartAngle:s.arcStartAngle,arcEndAngle:s.arcEndAngle,arcCenterX:s.arcCenterX,arcCenterY:s.arcCenterY,arcRotation:s.arcRotation,showArcGuide:s.showArcGuide,showArcTrail:!0,lockArcPosition:s.lockArcPosition,arcRadius:s.arcRadius,impactRays:s.impactRays,trailWidth:s.trailWidth,fistSize:s.fistSize,animationSpeed:s.animationSpeed}})}),e.jsx("div",{"data-test":"preview-enemy",className:"absolute",style:{left:s.enemyOffsetX,top:s.enemyOffsetY},children:e.jsx($,{design:z,size:s.enemySize})})]}),e.jsx("div",{"data-test":"replay-hint",className:"text-xs text-gray-500 text-center",children:"Click to replay"})]})]}),e.jsxs("section",{"data-test":"effects-assets",className:"bg-white rounded p-2 shadow flex flex-col min-h-0 overflow-auto",children:[e.jsx("h2",{"data-test":"effects-section-title",className:"text-sm font-semibold text-purple-700 mb-2",children:"Effects (Canvas)"}),e.jsx("div",{"data-test":"effects-categories",className:"space-y-2 mb-2",children:V.map(a=>e.jsxs("div",{"data-test":`effect-category-${a}`,children:[e.jsx("div",{"data-test":`effect-category-${a}-label`,className:`text-xs font-medium ${_[a].color} mb-1`,children:_[a].label}),e.jsx("div",{"data-test":`effect-category-${a}-grid`,className:"grid grid-cols-3 gap-1 justify-items-center",children:v[a].map(c=>e.jsx(R,{design:c,size:40,selected:o===c.id,onClick:()=>J(c.id)},c.id))})]},a))}),e.jsx("p",{"data-test":"effects-hint",className:"text-xs text-gray-400 text-center mb-2",children:"Click to play"}),e.jsxs("div",{"data-test":"selected-effect-details",className:"bg-purple-50 border border-purple-200 rounded p-2 flex-1",children:[e.jsxs("div",{"data-test":"effect-info",className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{design:h,size:50}),e.jsxs("div",{children:[e.jsx("div",{"data-test":"effect-name",className:"font-semibold text-sm",children:h.name}),e.jsx("div",{"data-test":"effect-description",className:"text-xs text-gray-500",children:h.description})]})]}),e.jsxs("div",{"data-test":"effect-colors",className:"text-xs space-y-1",children:[e.jsxs("div",{"data-test":"effect-base-color",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Base:"}),e.jsx("div",{"data-test":"effect-base-color-swatch",className:"w-4 h-4 rounded border",style:{backgroundColor:h.baseColor}}),e.jsx("span",{"data-test":"effect-base-color-value",className:"font-mono text-gray-600",children:h.baseColor})]}),e.jsxs("div",{"data-test":"effect-accent-color",className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Accent:"}),e.jsx("div",{"data-test":"effect-accent-color-swatch",className:"w-4 h-4 rounded border",style:{backgroundColor:h.accentColor}}),e.jsx("span",{"data-test":"effect-accent-color-value",className:"font-mono text-gray-600",children:h.accentColor})]})]})]})]})]}),e.jsx(se,{isVisible:m,onClose:()=>b(!1),title:"Animation Builder",initialPosition:"center",shouldCloseManually:!0,resizable:!0,initialSize:{width:320,height:500},headerActions:e.jsx(A,{"data-test":"copy-config-button",variant:"ghost",size:"smIcon",onClick:q,className:"h-2 w-2 p-0",title:"Copy config to clipboard",children:e.jsx(de,{size:10})}),children:e.jsx("div",{"data-test":"animation-builder-form-container",className:"p-3 overflow-auto",children:e.jsx(oe,{schema:pe,values:s,onChange:K})})})]})}export{Ee as RpgAssetsPageV2};
